<script src="index.es_files/header-attrs-2.6/header-attrs.js"></script>
<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<div id="TOC">
<ul>
<li><a href="#presentación-del-problema"><span class="toc-section-number">1</span> Presentación del Problema</a>
<ul>
<li><a href="#descripción-del-dataset"><span class="toc-section-number">1.1</span> Descripción del Dataset</a></li>
</ul></li>
<li><a href="#carga-de-librerías-y-configuraciones"><span class="toc-section-number">2</span> Carga de Librerías y Configuraciones</a></li>
<li><a href="#carga-descripción-y-resumen-del-dataset"><span class="toc-section-number">3</span> Carga, Descripción y Resumen del Dataset</a></li>
<li><a href="#análisis-gráfico"><span class="toc-section-number">4</span> Análisis Gráfico</a>
<ul>
<li><a href="#variable-objetivo"><span class="toc-section-number">4.1</span> Variable Objetivo</a></li>
<li><a href="#variables-numéricas"><span class="toc-section-number">4.2</span> Variables Numéricas</a></li>
<li><a href="#variables-categóricas"><span class="toc-section-number">4.3</span> Variables Categóricas</a></li>
</ul></li>
<li><a href="#división-train-y-test"><span class="toc-section-number">5</span> División Train y Test</a></li>
<li><a href="#data-cleaning-feature-engineering"><span class="toc-section-number">6</span> Data Cleaning / Feature Engineering</a>
<ul>
<li><a href="#valores-desconocidos-ausentes"><span class="toc-section-number">6.1</span> Valores Desconocidos / Ausentes</a></li>
<li><a href="#registros-duplicados"><span class="toc-section-number">6.2</span> Registros Duplicados</a></li>
<li><a href="#función-cleanerimputer"><span class="toc-section-number">6.3</span> Función Cleaner/Imputer</a></li>
</ul></li>
<li><a href="#métrica-de-evaluación"><span class="toc-section-number">7</span> Métrica de Evaluación</a></li>
<li><a href="#preprocesado"><span class="toc-section-number">8</span> Preprocesado</a></li>
<li><a href="#modelado"><span class="toc-section-number">9</span> Modelado</a></li>
<li><a href="#set-de-datos-de-evaluación-final"><span class="toc-section-number">10</span> Set de Datos de Evaluación Final</a></li>
<li><a href="#conclusiones"><span class="toc-section-number">11</span> Conclusiones</a></li>
<li><a href="#bibliografía"><span class="toc-section-number">12</span> Bibliografía</a></li>
</ul>
</div>

<div style="text-align: justify">

<p> </p>
<div id="presentación-del-problema" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Presentación del Problema</h1>
<p>El problema propuesto como trabajo final del curso consistía en analizar datos reales de campañas de marketing llevadas a cabo por un banco en periodos pasados destinadas a la venta de un producto bancario, específicamente de plazos fijos. Dentro de estos datos teníamos información personal de los clientes y datos socioeconómicos del momento en que se realizó la campaña. El objetivo consistía en crear un modelo de machine learning que dada las características de un cliente pueda predecir si este compraba o no el producto y de esta manera poder comunicarse para ofrecérselo o bien no gastar recursos en intentarlo. Era un clásico problema de clasificación binaria de aprendizaje supervisado ya que dentro de los datos estaba presente la variable objetivo (compra/no compra). Pero para hacerlo orientado a un problema empresarial se incorporó una matriz de costo/beneficio en el que se especificaba el costo monetario por llamar a un cliente y el beneficio obtenido por vender el producto. Así el mejor modelo predictivo era el que maximizaba el beneficio esperado de una nueva campaña de marketing representado por un grupo de datos que se habían dejado aparte y sobre el cual se evaluaban las soluciones propuestas de todos los equipos pero no se sabía hasta el final ya que ninguno de los equipos tenía acceso a este grupo de datos.</p>
<p> </p>
<div id="descripción-del-dataset" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Descripción del Dataset</h2>
<p>Los datos correspondían a contactos con clientes realizados entre mayo de 2008 y junio de 2013 totalizando 35.010 registros. Este era el dataset utilizado para entrenar y testear el modelo predictivo. Otro dataset con 6178 registros se utilizaría luego de la entrega final para evaluar el mejor modelo propuesto.</p>
<p>Ambos dataset tenían la misma estructura, los atributos con los que contaban se muestran a continuación.</p>
<p><strong>Variables Predictivas:</strong></p>
<ol style="list-style-type: lower-alpha">
<li>Datos del cliente del banco:</li>
</ol>
<ol style="list-style-type: decimal">
<li><code>Edad</code>: edad de los clientes (numérica).</li>
<li><code>Trabajo</code>: tipo de trabajo (categórico: ‘obrero’, ‘gerente’, ‘administrativo’, ‘autónomo’, ‘servicios’, ‘técnico’, ‘desempleado’, ‘empresario’, ‘jubilado’, ‘ama de casa’, ‘desconocido’, ‘estudiante’)</li>
<li><code>Estado civil</code>: (categórico: ‘casado’, ‘divorciado’, ‘soltero’, ‘desconocido’).</li>
<li><code>Educacion</code>: (categórico: ‘basica.9y’, ‘basica.6y’, ‘basica.4y’, ‘secundario’, ‘universitario’, ‘desconocido’, ‘curso profesional’, ‘sin estudios’).</li>
<li><code>Default</code>: indicaba si el cliente tenía crédito en default. (categórico: “si”,“no”,“desconocido”)</li>
<li><code>Prestamo vivienda</code>: indicaba si el cliente tenía una préstamo de vivienda (categórico: “si”, “no”,“desconocido”).</li>
<li><code>Prestamo personal</code>: indicaba si el cliente tenía una préstamo personal (categórico: “si”, “no”,“desconocido”).</li>
</ol>
<ol start="2" style="list-style-type: lower-alpha">
<li>Relacionado con el contacto de la última campaña:</li>
</ol>
<ol start="8" style="list-style-type: decimal">
<li><code>Contacto</code>: tipo de comunicación de contacto (categórico: “celular”, “telefono”).</li>
<li><code>Mes</code>: mes del último contacto (categórico: “ene”, “feb”, “mar”, …, “nov”, “dec”)</li>
<li><code>Dia de la semana</code>: día de la semana del último contacto (categórico: “lun”, “mar”, “mie”, “jue”, “vie”)</li>
</ol>
<ol start="3" style="list-style-type: lower-alpha">
<li>Otros atributos:</li>
</ol>
<ol start="11" style="list-style-type: decimal">
<li><code>Cantidad de contactos</code>: número de contactos realizados al cliente durante la campaña actual (numérico).</li>
<li><code>Dias</code>: número de días que pasaron desde la campaña anterior a la actual(numérico; 999 significa que el cliente no fue contactado previamente).</li>
<li><code>Anterior</code>: número de contactos realizados al cliente antes de esta campaña (numérico).</li>
<li><code>Resultado anterior</code>: resultado de la campaña de marketing anterior (categórico: ‘inexistente’, ‘fallida’, ‘exitosa’)</li>
</ol>
<ol start="4" style="list-style-type: lower-alpha">
<li>Atributos relacionados al contexto social y económico.</li>
</ol>
<ol start="15" style="list-style-type: decimal">
<li><code>emp.var.rate</code>: tasa de variación del empleo - indicador trimestral (numérico).</li>
<li><code>cons.price.idx</code>: índice de precios al consumidor - indicador mensual (numérico).</li>
<li><code>cons.conf.idx</code>: índice de confianza del consumidor - indicador mensual (numérico).</li>
<li><code>euribor3m</code>: tasa de interés interbancario a 3 meses (acrónimo de Euro Interbank Offered Rate)- indicador diario (numérico).</li>
<li><code>nr.empleados</code>: promedio trimestral del número de ciudadanos activos (numérico).</li>
</ol>
<ol start="5" style="list-style-type: lower-alpha">
<li>Variable de salida (objetivo):</li>
</ol>
<ol start="20" style="list-style-type: decimal">
<li><code>y</code>: indicaba si el cliente había comprado o no el producto (binario: “si”, “no”)</li>
</ol>
<p>Una observación importante es que todos los valores nulos fueron reemplazados por la categoría <em>desconocido</em>.</p>
<p> </p>
</div>
</div>
<div id="carga-de-librerías-y-configuraciones" class="section level1" number="2">
<h1><span class="header-section-number">2</span> Carga de Librerías y Configuraciones</h1>
<div class="sourceCode" id="cb1"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Manipulación de Datos</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co"># =====================</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy  <span class="im">as</span> np</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráficos</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co"># ========</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn           <span class="im">as</span> sns</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> squarify          <span class="im">as</span> sq</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>mypallete <span class="op">=</span> [<span class="st">&#39;orange&#39;</span>, <span class="st">&#39;green&#39;</span>]</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>sns.set_palette(mypallete)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>sns.set_style(<span class="st">&quot;white&quot;</span>)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>sns.set_context(<span class="st">&#39;notebook&#39;</span>)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Preprocesado, modelado, metricas</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="co"># ================================</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.compose         <span class="im">import</span> ColumnTransformer</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing   <span class="im">import</span> OneHotEncoder</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> GridSearchCV</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.tree            <span class="im">import</span> DecisionTreeClassifier</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics         <span class="im">import</span> plot_confusion_matrix</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics         <span class="im">import</span> confusion_matrix</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics         <span class="im">import</span> accuracy_score</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics         <span class="im">import</span> precision_score</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics         <span class="im">import</span> make_scorer</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics         <span class="im">import</span> classification_report</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.ensemble        <span class="im">import</span> RandomForestClassifier</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Configuración de warnings</span></span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a><span class="co"># =========================</span></span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> warnings</span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>warnings.filterwarnings(<span class="st">&#39;ignore&#39;</span>)</span></code></pre></div>
<p> </p>
</div>
<div id="carga-descripción-y-resumen-del-dataset" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Carga, Descripción y Resumen del Dataset</h1>
<div class="sourceCode" id="cb2"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>clientes <span class="op">=</span> pd.read_csv(<span class="st">&#39;bank.csv&#39;</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>clientes.info()</span></code></pre></div>
<pre><code>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 35010 entries, 0 to 35009
Data columns (total 20 columns):
 #   Column                 Non-Null Count  Dtype  
---  ------                 --------------  -----  
 0   Edad                   35010 non-null  int64  
 1   Trabajo                35010 non-null  object 
 2   Estado civil           35010 non-null  object 
 3   Educacion              35010 non-null  object 
 4   Default                35010 non-null  object 
 5   Prestamo vivienda      35010 non-null  object 
 6   Prestamo personal      35010 non-null  object 
 7   Contacto               35010 non-null  object 
 8   Mes                    35010 non-null  object 
 9   Dia de la semana       35010 non-null  object 
 10  Cantidad de contactos  35010 non-null  int64  
 11  Dias                   35010 non-null  int64  
 12  Anterior               35010 non-null  int64  
 13  Resultado anterior     35010 non-null  object 
 14  emp.var.rate           35010 non-null  float64
 15  cons.price.idx         35010 non-null  float64
 16  cons.conf.idx          35010 non-null  float64
 17  euribor3m              35010 non-null  float64
 18  nr.employed            35010 non-null  float64
 19  y                      35010 non-null  object 
dtypes: float64(5), int64(4), object(11)
memory usage: 5.3+ MB</code></pre>
<div class="sourceCode" id="cb4"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Valores únicos para cada atributo</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> col <span class="kw">in</span> clientes.columns:</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(col)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>()</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(clientes[col].unique())</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&#39;--------------------&#39;</span>)</span></code></pre></div>
<pre><code>Edad

[34 59 40 32 46 42 24 28 45 30 50 31 60 41 51 53 33 29 78 63 49 38 43 55
 36 52 44 27 37 58 57 25 23 74 54 48 35 39 26 56 83 61 77 62 47 76 22 20
 64 19 21 66 69 88 70 71 72 75 81 73 80 65 68 98 67 92 86 82 18 84 85 79
 91 95 17 89]
--------------------
Trabajo

[&#39;Obrero&#39; &#39;Gerente&#39; &#39;Administrativo&#39; &#39;Autonomo&#39; &#39;Servicios&#39; &#39;Tecnico&#39;
 &#39;desempleado&#39; &#39;Empresario&#39; &#39;Jubilado&#39; &#39;Ama de casa&#39; &#39;desconocido&#39;
 &#39;estudiante&#39;]
--------------------
Estado civil

[&#39;casado&#39; &#39;divorciado&#39; &#39;soltero&#39; &#39;desconocido&#39;]
--------------------
Educacion

[&#39;basica.9y&#39; &#39;basica.4y&#39; &#39;secundario&#39; &#39;universitario&#39; &#39;desconocido&#39;
 &#39;basica.6y&#39; &#39;curso profesional&#39; &#39;sin estudios&#39;]
--------------------
Default

[&#39;no&#39; &#39;desconocido&#39; &#39;si&#39;]
--------------------
Prestamo vivienda

[&#39;si&#39; &#39;desconocido&#39; &#39;no&#39;]
--------------------
Prestamo personal

[&#39;no&#39; &#39;desconocido&#39; &#39;si&#39;]
--------------------
Contacto

[&#39;celular&#39; &#39;telefono&#39;]
--------------------
Mes

[&#39;may&#39; &#39;jun&#39; &#39;ago&#39; &#39;abr&#39; &#39;mar&#39; &#39;nov&#39; &#39;jul&#39; &#39;oct&#39; &#39;dic&#39; &#39;sep&#39;]
--------------------
Dia de la semana

[&#39;lun&#39; &#39;mar&#39; &#39;mie&#39; &#39;jue&#39; &#39;vie&#39;]
--------------------
Cantidad de contactos

[ 5  6  3 17  2  1 11  8  4 10 12  7 14  9 22 21 35 15 25 23 27 13 29 16
 31 26 30 24 20 28 32 19 34 33 37 18 43 40 39 41 42]
--------------------
Dias

[999   3  11   6   9  10  13   1  12   5   4  15  14   7  22   2  27   8
  19   0  17  18  16  25  21  26  20]
--------------------
Anterior

[0 1 3 2 4 6 5 7]
--------------------
Resultado anterior

[&#39;inexistente&#39; &#39;fallida&#39; &#39;exitosa&#39;]
--------------------
emp.var.rate

[-1.8  1.1  1.4 -0.1 -3.4 -2.9 -1.1 -1.7 -3.  -0.2]
--------------------
cons.price.idx

[92.893 93.994 94.465 93.444 93.075 92.843 93.749 93.2   93.918 92.431
 93.369 92.963 94.601 94.027 92.713 92.649 94.215 92.201 94.199 93.798
 92.379 93.876 94.767 92.469 94.055 92.756]
--------------------
cons.conf.idx

[-46.2 -36.4 -41.8 -36.1 -47.1 -50.  -34.6 -42.  -42.7 -26.9 -34.8 -40.8
 -49.5 -38.3 -33.  -30.1 -40.3 -31.4 -37.5 -40.4 -29.8 -40.  -50.8 -33.6
 -39.8 -45.9]
--------------------
euribor3m

[1.299 4.857 4.961 4.964 4.962 1.405 1.266 1.531 0.645 4.191 4.076 1.334
 4.959 4.957 4.966 1.344 4.96  4.12  0.722 4.859 4.963 0.655 1.327 0.74
 1.291 4.965 1.025 4.86  0.643 1.453 0.895 4.021 4.968 0.993 1.41  4.858
 1.27  0.886 4.865 1.235 4.855 0.706 4.864 0.714 1.262 4.856 0.835 1.281
 4.153 0.905 1.4   0.883 4.955 1.423 1.26  4.967 0.879 1.811 0.987 0.741
 0.869 1.406 1.51  0.644 5.    0.715 1.479 4.97  1.392 0.768 4.866 0.762
 0.684 1.313 1.25  1.099 0.754 1.354 0.646 0.653 1.415 1.035 4.958 0.838
 1.043 0.881 0.896 1.032 0.682 0.797 1.244 1.029 0.654 0.65  1.264 0.72
 4.912 0.739 0.707 0.843 0.7   0.773 1.048 1.483 1.04  1.445 1.365 0.849
 0.683 0.825 0.702 0.652 0.87  0.635 1.466 0.685 4.947 0.959 0.904 0.899
 1.215 0.819 1.435 0.712 0.884 1.268 0.761 1.286 0.803 0.894 1.663 0.672
 1.64  0.728 1.059 1.372 0.723 0.737 1.041 0.851 1.049 0.861 1.629 4.592
 1.028 0.639 0.809 1.252 0.708 0.898 1.072 0.878 0.793 0.651 0.9   0.717
 0.64  3.563 0.788 0.719 0.668 0.942 0.743 0.854 0.882 1.498 4.286 0.699
 0.659 1.085 0.859 0.827 0.977 0.742 1.007 5.045 1.726 0.873 1.538 1.
 1.52  1.259 0.701 3.282 0.893 0.697 1.614 4.343 0.822 0.889 0.642 1.687
 0.744 0.73  0.88  0.709 1.016 0.891 0.735 0.888 1.031 0.778 0.877 0.663
 0.638 0.79  0.982 1.046 1.757 0.829 1.556 0.77  0.781 0.767 0.876 1.384
 0.724 0.649 0.846 0.903 0.71  0.81  0.782 0.821 1.224 0.914 0.834 1.703
 0.733 4.406 0.753 0.972 1.799 0.716 0.634 4.956 0.718 1.65  1.206 1.602
 0.908 0.84  0.688 0.749 1.044 0.727 1.039 0.965 1.018 0.729 4.245 0.755
 0.953 1.03  0.677 0.75  0.927 0.885 0.692 4.918 1.05  1.584 0.766 1.548
 4.794 0.704 1.037 4.827 0.89  1.56  0.636 0.695 0.721 1.778 0.813 0.979
 3.053 0.731 4.223 0.969 4.936 0.771 4.76  0.752 0.732 1.008 0.748 3.743
 4.474 4.7   3.901 0.956 3.329 0.713 0.985 4.921 0.802 0.637 4.663 0.69
 3.669 0.937 4.733 0.921 1.045 3.853 0.711 0.944 1.574 3.428 0.996 3.879
 3.488 3.816]
--------------------
nr.employed

[5099.1 5191.  5228.1 5008.7 5195.8 5017.5 5076.2 4963.6 4991.6 5023.5
 5176.3]
--------------------
y

[&#39;no&#39; &#39;si&#39;]
--------------------</code></pre>
<p>Antes de proceder al análisis gráfico renombramos algunas columnas y llevamos todos los strings a minúscula separados por guión bajo, todo esto para que los campos y las categorías tengan el mismo formato.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> normalizador(df):</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Pasamos los nombres de las columnas a minusculas</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  df.columns <span class="op">=</span> clientes.columns.<span class="bu">str</span>.lower()</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Renombramos columnas</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  df.rename(columns <span class="op">=</span> {<span class="st">&#39;estado civil&#39;</span>         : <span class="st">&#39;est_civ&#39;</span>,</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>                       <span class="st">&#39;prestamo vivienda&#39;</span>    : <span class="st">&#39;pres_viv&#39;</span>,</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>                       <span class="st">&#39;prestamo personal&#39;</span>    : <span class="st">&#39;pres_per&#39;</span>,</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>                       <span class="st">&#39;dia de la semana&#39;</span>     : <span class="st">&#39;dia_sem&#39;</span>,</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>                       <span class="st">&#39;cantidad de contactos&#39;</span>: <span class="st">&#39;contactos&#39;</span>,</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>                       <span class="st">&#39;resultado anterior&#39;</span>   : <span class="st">&#39;res_ant&#39;</span>},</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>               inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Pasamos las categorías de los atributos a minúsculas</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> col <span class="kw">in</span> df.select_dtypes(<span class="st">&quot;object&quot;</span>).columns:</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>    df[col] <span class="op">=</span> df[col].<span class="bu">str</span>.lower()</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Normalizamos el nombre de las columnas</span></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>  df.columns <span class="op">=</span> df.columns.<span class="bu">str</span>.replace(<span class="st">&#39;.&#39;</span>, <span class="st">&#39;_&#39;</span>, regex <span class="op">=</span> <span class="va">True</span>)</span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>normalizador(clientes)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>clientes.columns</span></code></pre></div>
<pre><code>Index([&#39;edad&#39;, &#39;trabajo&#39;, &#39;est_civ&#39;, &#39;educacion&#39;, &#39;default&#39;, &#39;pres_viv&#39;,
       &#39;pres_per&#39;, &#39;contacto&#39;, &#39;mes&#39;, &#39;dia_sem&#39;, &#39;contactos&#39;, &#39;dias&#39;,
       &#39;anterior&#39;, &#39;res_ant&#39;, &#39;emp_var_rate&#39;, &#39;cons_price_idx&#39;,
       &#39;cons_conf_idx&#39;, &#39;euribor3m&#39;, &#39;nr_employed&#39;, &#39;y&#39;],
      dtype=&#39;object&#39;)</code></pre>
<div class="sourceCode" id="cb9"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>clientes.describe()</span></code></pre></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<div style="overflow-x:auto;">
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th>
</th>
<th>
edad
</th>
<th>
contactos
</th>
<th>
dias
</th>
<th>
anterior
</th>
<th>
emp_var_rate
</th>
<th>
cons_price_idx
</th>
<th>
cons_conf_idx
</th>
<th>
euribor3m
</th>
<th>
nr_employed
</th>
</tr>
</thead>
<tbody>
<tr>
<th>
count
</th>
<td>
35010.00
</td>
<td>
35010.00
</td>
<td>
35010.00
</td>
<td>
35010.00
</td>
<td>
35010.00
</td>
<td>
35010.00
</td>
<td>
35010.00
</td>
<td>
35010.00
</td>
<td>
35010.00
</td>
</tr>
<tr>
<th>
mean
</th>
<td>
40.03
</td>
<td>
2.56
</td>
<td>
961.70
</td>
<td>
0.17
</td>
<td>
0.08
</td>
<td>
93.57
</td>
<td>
-40.50
</td>
<td>
3.61
</td>
<td>
5166.94
</td>
</tr>
<tr>
<th>
std
</th>
<td>
10.41
</td>
<td>
2.74
</td>
<td>
188.79
</td>
<td>
0.49
</td>
<td>
1.57
</td>
<td>
0.57
</td>
<td>
4.62
</td>
<td>
1.73
</td>
<td>
72.38
</td>
</tr>
<tr>
<th>
min
</th>
<td>
17.00
</td>
<td>
1.00
</td>
<td>
0.00
</td>
<td>
0.00
</td>
<td>
-3.40
</td>
<td>
92.20
</td>
<td>
-50.80
</td>
<td>
0.63
</td>
<td>
4963.60
</td>
</tr>
<tr>
<th>
25%
</th>
<td>
32.00
</td>
<td>
1.00
</td>
<td>
999.00
</td>
<td>
0.00
</td>
<td>
-1.80
</td>
<td>
93.07
</td>
<td>
-42.70
</td>
<td>
1.34
</td>
<td>
5099.10
</td>
</tr>
<tr>
<th>
50%
</th>
<td>
38.00
</td>
<td>
2.00
</td>
<td>
999.00
</td>
<td>
0.00
</td>
<td>
1.10
</td>
<td>
93.74
</td>
<td>
-41.80
</td>
<td>
4.85
</td>
<td>
5191.00
</td>
</tr>
<tr>
<th>
75%
</th>
<td>
47.00
</td>
<td>
3.00
</td>
<td>
999.00
</td>
<td>
0.00
</td>
<td>
1.40
</td>
<td>
93.99
</td>
<td>
-36.40
</td>
<td>
4.96
</td>
<td>
5228.10
</td>
</tr>
<tr>
<th>
max
</th>
<td>
98.00
</td>
<td>
43.00
</td>
<td>
999.00
</td>
<td>
7.00
</td>
<td>
1.40
</td>
<td>
94.76
</td>
<td>
-26.90
</td>
<td>
5.04
</td>
<td>
5228.10
</td>
</tr>
</tbody>
</table>
</div>
<p> </p>
</div>
<div id="análisis-gráfico" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Análisis Gráfico</h1>
<p>En este punto realizamos diferentes gráficos de cada una de las variables presentes en el dataset, como así también gráficos de las relaciones entre ellas y la variable objetivo, esto es importante a la hora entender qué variables son buenas para el modelo y cuales no permitiéndonos obtener buenos resultados con un modelo predictivo más simple al reducir el ruido introducido en los datos de entrada.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Funciones para gráficar </span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="co"># =====================</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Variables contínuas</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> kdeplot(feature): </span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>    plt.figure(figsize <span class="op">=</span> (<span class="dv">10</span>, <span class="dv">5</span>))</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>    plt.title(<span class="st">&quot;Gráfico de densidad para </span><span class="sc">{}</span><span class="st">&quot;</span>.<span class="bu">format</span>(feature))</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>    ax0 <span class="op">=</span> sns.kdeplot(clientes[clientes[<span class="st">&#39;y&#39;</span>] <span class="op">==</span> <span class="st">&#39;no&#39;</span>][feature],</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>                       label<span class="op">=</span> <span class="st">&#39;Compra: No&#39;</span>, shade <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>    ax1 <span class="op">=</span> sns.kdeplot(clientes[clientes[<span class="st">&#39;y&#39;</span>] <span class="op">==</span> <span class="st">&#39;si&#39;</span>][feature],</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>                       label <span class="op">=</span> <span class="st">&#39;Compra: si&#39;</span>, shade <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>    plt.xlabel(feature)</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>    sns.despine()</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>    plt.legend()</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Variables categóricas</span></span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> barplot_percentages(feature, orient <span class="op">=</span> <span class="st">&#39;v&#39;</span>, axis_name <span class="op">=</span> <span class="st">&quot;porcentaje de clientes&quot;</span>):</span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>    ratios <span class="op">=</span> pd.DataFrame()</span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>    g <span class="op">=</span> clientes.groupby(feature)[<span class="st">&quot;y&quot;</span>].value_counts().to_frame()</span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>    g <span class="op">=</span> g.rename({<span class="st">&quot;y&quot;</span>: axis_name}, axis <span class="op">=</span> <span class="dv">1</span>).reset_index()</span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>    g[axis_name] <span class="op">=</span> g[axis_name] <span class="op">/</span> <span class="bu">len</span>(clientes)</span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> orient <span class="op">==</span> <span class="st">&#39;v&#39;</span>:</span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a>        ax <span class="op">=</span> sns.barplot(x <span class="op">=</span> feature,</span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a>                         y <span class="op">=</span> axis_name,</span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a>                         hue <span class="op">=</span> <span class="st">&#39;y&#39;</span>,</span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a>                         data <span class="op">=</span> g,</span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a>                         orient <span class="op">=</span> orient,</span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a>                        alpha <span class="op">=</span> <span class="fl">0.7</span>)</span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a>        ax.set_yticklabels([<span class="st">&#39;{:,.0%}&#39;</span>.<span class="bu">format</span>(y) <span class="cf">for</span> y <span class="kw">in</span> ax.get_yticks()])</span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a>        ax <span class="op">=</span> sns.barplot(x <span class="op">=</span> axis_name,</span>
<span id="cb10-33"><a href="#cb10-33" aria-hidden="true" tabindex="-1"></a>                         y <span class="op">=</span> feature,</span>
<span id="cb10-34"><a href="#cb10-34" aria-hidden="true" tabindex="-1"></a>                         hue <span class="op">=</span> <span class="st">&#39;y&#39;</span>,</span>
<span id="cb10-35"><a href="#cb10-35" aria-hidden="true" tabindex="-1"></a>                         data <span class="op">=</span> g,</span>
<span id="cb10-36"><a href="#cb10-36" aria-hidden="true" tabindex="-1"></a>                         orient <span class="op">=</span> orient,</span>
<span id="cb10-37"><a href="#cb10-37" aria-hidden="true" tabindex="-1"></a>                         alpha <span class="op">=</span> <span class="fl">0.7</span>)</span>
<span id="cb10-38"><a href="#cb10-38" aria-hidden="true" tabindex="-1"></a>        ax.set_xticklabels([<span class="st">&#39;{:,.0%}&#39;</span>.<span class="bu">format</span>(x) <span class="cf">for</span> x <span class="kw">in</span> ax.get_xticks()])</span>
<span id="cb10-39"><a href="#cb10-39" aria-hidden="true" tabindex="-1"></a>    sns.despine()</span>
<span id="cb10-40"><a href="#cb10-40" aria-hidden="true" tabindex="-1"></a>    ax.plot()</span></code></pre></div>
<p> </p>
<div id="variable-objetivo" class="section level2" number="4.1">
<h2><span class="header-section-number">4.1</span> Variable Objetivo</h2>
<div class="sourceCode" id="cb11"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Distribución de la variable objetivo</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>total <span class="op">=</span> <span class="bu">float</span>(<span class="bu">len</span>(clientes))</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> sns.countplot(<span class="st">&quot;y&quot;</span>, data <span class="op">=</span> clientes, alpha <span class="op">=</span> <span class="fl">0.8</span>)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> p <span class="kw">in</span> ax.patches:</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>    height <span class="op">=</span> p.get_height()</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>    ax.text(p.get_x() <span class="op">+</span> p.get_width() <span class="op">/</span> <span class="dv">2</span>,</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>            p.get_height(),</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;</span><span class="sc">{:.1f}</span><span class="st">%&#39;</span>.<span class="bu">format</span>((height<span class="op">/</span>total)<span class="op">*</span><span class="dv">100</span>),</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>            ha <span class="op">=</span> <span class="st">&quot;center&quot;</span>,</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>            color <span class="op">=</span> <span class="st">&#39;black&#39;</span>,</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>            fontsize <span class="op">=</span> <span class="dv">15</span>,</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>            weight <span class="op">=</span> <span class="st">&#39;bold&#39;</span>,</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>           ) </span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>sns.despine()</span></code></pre></div>
<p>hols</p>
<p><img src="/img/tp_uba/output_20_0.png" /></p>
<p>El 88.7 % de los clientes no compraron el producto, solo el 11.3% de ellos si lo hicieron.</p>
<p> </p>
</div>
<div id="variables-numéricas" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Variables Numéricas</h2>
<p> </p>
<p><strong>Edad</strong></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Distribución de la edad</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>kdeplot(<span class="st">&#39;edad&#39;</span>)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>sns.despine()</span></code></pre></div>
<p><img src="/img/tp_uba/output_24_0.png" /></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Proporción de compradores mayores a 60</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>clientes[clientes[<span class="st">&#39;edad&#39;</span>] <span class="op">&gt;=</span> <span class="dv">60</span>][<span class="st">&#39;y&#39;</span>].value_counts(normalize <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    no    <span class="fl">0.604878</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    si    <span class="fl">0.395122</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>    Name: y, dtype: float64</span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Proporción de compradores menores de 22 años</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>clientes[clientes[<span class="st">&#39;edad&#39;</span>] <span class="op">&lt;=</span> <span class="dv">20</span>][<span class="st">&#39;y&#39;</span>].value_counts(normalize <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>    no    <span class="fl">0.595041</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>    si    <span class="fl">0.404959</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>    Name: y, dtype: float64</span></code></pre></div>
<p>Observamos que los mayores de 60 años y los menores de 21 resultaban ser buenos compradores.</p>
<p> </p>
<p><strong>Contactos</strong></p>
<div class="sourceCode" id="cb15"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Distribución de contactos</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>kdeplot(<span class="st">&#39;contactos&#39;</span>)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>sns.despine()</span></code></pre></div>
<p><img src="/img/tp_uba/output_29_0.png" /></p>
<div class="sourceCode" id="cb16"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>clientes.groupby(<span class="st">&#39;contactos&#39;</span>)[<span class="st">&#39;y&#39;</span>].value_counts(normalize <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>    contactos  y </span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span>          no    <span class="fl">0.870748</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>               si    <span class="fl">0.129252</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>    <span class="dv">2</span>          no    <span class="fl">0.884817</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>               si    <span class="fl">0.115183</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>    <span class="dv">3</span>          no    <span class="fl">0.891013</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>               si    <span class="fl">0.108987</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>    <span class="dv">4</span>          no    <span class="fl">0.904615</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>               si    <span class="fl">0.095385</span></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>    <span class="dv">5</span>          no    <span class="fl">0.925317</span></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>               si    <span class="fl">0.074683</span></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>    <span class="dv">6</span>          no    <span class="fl">0.922156</span></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>               si    <span class="fl">0.077844</span></span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>    <span class="dv">7</span>          no    <span class="fl">0.946296</span></span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>               si    <span class="fl">0.053704</span></span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>    <span class="dv">8</span>          no    <span class="fl">0.952522</span></span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>               si    <span class="fl">0.047478</span></span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>    <span class="dv">9</span>          no    <span class="fl">0.938776</span></span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a>               si    <span class="fl">0.061224</span></span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a>    <span class="dv">10</span>         no    <span class="fl">0.950000</span></span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a>               si    <span class="fl">0.050000</span></span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a>    <span class="dv">11</span>         no    <span class="fl">0.937931</span></span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a>               si    <span class="fl">0.062069</span></span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a>    <span class="dv">12</span>         no    <span class="fl">0.971963</span></span>
<span id="cb16-27"><a href="#cb16-27" aria-hidden="true" tabindex="-1"></a>               si    <span class="fl">0.028037</span></span>
<span id="cb16-28"><a href="#cb16-28" aria-hidden="true" tabindex="-1"></a>    <span class="dv">13</span>         no    <span class="fl">0.961538</span></span>
<span id="cb16-29"><a href="#cb16-29" aria-hidden="true" tabindex="-1"></a>               si    <span class="fl">0.038462</span></span>
<span id="cb16-30"><a href="#cb16-30" aria-hidden="true" tabindex="-1"></a>    <span class="dv">14</span>         no    <span class="fl">0.984375</span></span>
<span id="cb16-31"><a href="#cb16-31" aria-hidden="true" tabindex="-1"></a>               si    <span class="fl">0.015625</span></span>
<span id="cb16-32"><a href="#cb16-32" aria-hidden="true" tabindex="-1"></a>    <span class="dv">15</span>         no    <span class="fl">0.952381</span></span>
<span id="cb16-33"><a href="#cb16-33" aria-hidden="true" tabindex="-1"></a>               si    <span class="fl">0.047619</span></span>
<span id="cb16-34"><a href="#cb16-34" aria-hidden="true" tabindex="-1"></a>    <span class="dv">16</span>         no    <span class="fl">1.000000</span></span>
<span id="cb16-35"><a href="#cb16-35" aria-hidden="true" tabindex="-1"></a>    <span class="dv">17</span>         no    <span class="fl">0.941176</span></span>
<span id="cb16-36"><a href="#cb16-36" aria-hidden="true" tabindex="-1"></a>               si    <span class="fl">0.058824</span></span>
<span id="cb16-37"><a href="#cb16-37" aria-hidden="true" tabindex="-1"></a>    <span class="dv">18</span>         no    <span class="fl">1.000000</span></span>
<span id="cb16-38"><a href="#cb16-38" aria-hidden="true" tabindex="-1"></a>    <span class="dv">19</span>         no    <span class="fl">1.000000</span></span>
<span id="cb16-39"><a href="#cb16-39" aria-hidden="true" tabindex="-1"></a>    <span class="dv">20</span>         no    <span class="fl">1.000000</span></span>
<span id="cb16-40"><a href="#cb16-40" aria-hidden="true" tabindex="-1"></a>    <span class="dv">21</span>         no    <span class="fl">1.000000</span></span>
<span id="cb16-41"><a href="#cb16-41" aria-hidden="true" tabindex="-1"></a>    <span class="dv">22</span>         no    <span class="fl">1.000000</span></span>
<span id="cb16-42"><a href="#cb16-42" aria-hidden="true" tabindex="-1"></a>    <span class="dv">23</span>         no    <span class="fl">0.916667</span></span>
<span id="cb16-43"><a href="#cb16-43" aria-hidden="true" tabindex="-1"></a>               si    <span class="fl">0.083333</span></span>
<span id="cb16-44"><a href="#cb16-44" aria-hidden="true" tabindex="-1"></a>    <span class="dv">24</span>         no    <span class="fl">1.000000</span></span>
<span id="cb16-45"><a href="#cb16-45" aria-hidden="true" tabindex="-1"></a>    <span class="dv">25</span>         no    <span class="fl">1.000000</span></span>
<span id="cb16-46"><a href="#cb16-46" aria-hidden="true" tabindex="-1"></a>    <span class="dv">26</span>         no    <span class="fl">1.000000</span></span>
<span id="cb16-47"><a href="#cb16-47" aria-hidden="true" tabindex="-1"></a>    <span class="dv">27</span>         no    <span class="fl">1.000000</span></span>
<span id="cb16-48"><a href="#cb16-48" aria-hidden="true" tabindex="-1"></a>    <span class="dv">28</span>         no    <span class="fl">1.000000</span></span>
<span id="cb16-49"><a href="#cb16-49" aria-hidden="true" tabindex="-1"></a>    <span class="dv">29</span>         no    <span class="fl">1.000000</span></span>
<span id="cb16-50"><a href="#cb16-50" aria-hidden="true" tabindex="-1"></a>    <span class="dv">30</span>         no    <span class="fl">1.000000</span></span>
<span id="cb16-51"><a href="#cb16-51" aria-hidden="true" tabindex="-1"></a>    <span class="dv">31</span>         no    <span class="fl">1.000000</span></span>
<span id="cb16-52"><a href="#cb16-52" aria-hidden="true" tabindex="-1"></a>    <span class="dv">32</span>         no    <span class="fl">1.000000</span></span>
<span id="cb16-53"><a href="#cb16-53" aria-hidden="true" tabindex="-1"></a>    <span class="dv">33</span>         no    <span class="fl">1.000000</span></span>
<span id="cb16-54"><a href="#cb16-54" aria-hidden="true" tabindex="-1"></a>    <span class="dv">34</span>         no    <span class="fl">1.000000</span></span>
<span id="cb16-55"><a href="#cb16-55" aria-hidden="true" tabindex="-1"></a>    <span class="dv">35</span>         no    <span class="fl">1.000000</span></span>
<span id="cb16-56"><a href="#cb16-56" aria-hidden="true" tabindex="-1"></a>    <span class="dv">37</span>         no    <span class="fl">1.000000</span></span>
<span id="cb16-57"><a href="#cb16-57" aria-hidden="true" tabindex="-1"></a>    <span class="dv">39</span>         no    <span class="fl">1.000000</span></span>
<span id="cb16-58"><a href="#cb16-58" aria-hidden="true" tabindex="-1"></a>    <span class="dv">40</span>         no    <span class="fl">1.000000</span></span>
<span id="cb16-59"><a href="#cb16-59" aria-hidden="true" tabindex="-1"></a>    <span class="dv">41</span>         no    <span class="fl">1.000000</span></span>
<span id="cb16-60"><a href="#cb16-60" aria-hidden="true" tabindex="-1"></a>    <span class="dv">42</span>         no    <span class="fl">1.000000</span></span>
<span id="cb16-61"><a href="#cb16-61" aria-hidden="true" tabindex="-1"></a>    <span class="dv">43</span>         no    <span class="fl">1.000000</span></span>
<span id="cb16-62"><a href="#cb16-62" aria-hidden="true" tabindex="-1"></a>    Name: y, dtype: float64</span></code></pre></div>
<p>Para esta variable observamos muchas categorías con baja frecuencia, por lo que decidimos unificar algunas de ellas. Con respecto a la relación con la variable objetivo pudimos ver que el porcentaje más alto de compradores se daba para contactos = 1 con una proporción del 12.9%.</p>
<p><strong>Variables Socioeconómicas</strong></p>
<div class="sourceCode" id="cb17"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="dv">3</span>,<span class="dv">2</span>, figsize <span class="op">=</span> (<span class="dv">12</span>,<span class="dv">9</span>))</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>fig.tight_layout(pad <span class="op">=</span> <span class="dv">3</span>)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>sns.boxplot(x <span class="op">=</span> <span class="st">&#39;cons_conf_idx&#39;</span>,</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>            y <span class="op">=</span> <span class="st">&#39;y&#39;</span>,</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>            data <span class="op">=</span> clientes,</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>            boxprops<span class="op">=</span><span class="bu">dict</span>(alpha<span class="op">=</span><span class="fl">.4</span>),</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>            ax <span class="op">=</span> ax[<span class="dv">0</span>,<span class="dv">0</span>])</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>sns.boxplot(x <span class="op">=</span> <span class="st">&#39;euribor3m&#39;</span>,</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>            y <span class="op">=</span> <span class="st">&#39;y&#39;</span>,</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>            data <span class="op">=</span> clientes,</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>            boxprops<span class="op">=</span><span class="bu">dict</span>(alpha<span class="op">=</span><span class="fl">.4</span>),</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>            ax <span class="op">=</span> ax[<span class="dv">0</span>,<span class="dv">1</span>])</span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>sns.boxplot(x <span class="op">=</span> <span class="st">&#39;cons_price_idx&#39;</span>,</span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>            y <span class="op">=</span> <span class="st">&#39;y&#39;</span>,</span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>            data <span class="op">=</span> clientes,</span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>            boxprops<span class="op">=</span><span class="bu">dict</span>(alpha<span class="op">=</span><span class="fl">.4</span>),</span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>            ax <span class="op">=</span> ax[<span class="dv">1</span>,<span class="dv">0</span>])</span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a>sns.boxplot(x <span class="op">=</span> <span class="st">&#39;nr_employed&#39;</span>,</span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a>            y <span class="op">=</span> <span class="st">&#39;y&#39;</span>,</span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a>            data <span class="op">=</span> clientes,</span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a>            boxprops<span class="op">=</span><span class="bu">dict</span>(alpha<span class="op">=</span><span class="fl">.4</span>),</span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a>            ax <span class="op">=</span> ax[<span class="dv">1</span>,<span class="dv">1</span>])</span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-28"><a href="#cb17-28" aria-hidden="true" tabindex="-1"></a>sns.boxplot(x <span class="op">=</span> <span class="st">&#39;emp_var_rate&#39;</span>,</span>
<span id="cb17-29"><a href="#cb17-29" aria-hidden="true" tabindex="-1"></a>            y <span class="op">=</span> <span class="st">&#39;y&#39;</span>,</span>
<span id="cb17-30"><a href="#cb17-30" aria-hidden="true" tabindex="-1"></a>            data <span class="op">=</span> clientes,</span>
<span id="cb17-31"><a href="#cb17-31" aria-hidden="true" tabindex="-1"></a>            boxprops<span class="op">=</span><span class="bu">dict</span>(alpha<span class="op">=</span><span class="fl">.4</span>),</span>
<span id="cb17-32"><a href="#cb17-32" aria-hidden="true" tabindex="-1"></a>            ax <span class="op">=</span> ax[<span class="dv">2</span>,<span class="dv">0</span>])</span>
<span id="cb17-33"><a href="#cb17-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-34"><a href="#cb17-34" aria-hidden="true" tabindex="-1"></a>fig.delaxes(ax[<span class="dv">2</span>,<span class="dv">1</span>])</span>
<span id="cb17-35"><a href="#cb17-35" aria-hidden="true" tabindex="-1"></a>sns.despine(left <span class="op">=</span> <span class="va">True</span>)</span></code></pre></div>
<p><img src="/img/tp_uba/output_33_0.png" /></p>
<p>A partir de los gráficos de Box and Whiskers observamos que algunas variables parecen que se comportan igual, por ejemplo para valores altos de <code>euribor3m</code> y de <code>nr_employed</code> hay mayor proporción de clientes que no compran. EL análisis de correlación que se muestra a continuación deja en evidencia estas relaciones.</p>
<p><strong>Análisis de Correlación</strong></p>
<div class="sourceCode" id="cb18"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize <span class="op">=</span> (<span class="dv">10</span>, <span class="dv">5</span>))</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>corr_matrix <span class="op">=</span> clientes.corr()</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>sns.heatmap(corr_matrix, annot <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<p><img src="/img/tp_uba/output_36_0.png" /></p>
<p>Observamos que la variable <code>emp.var.rate</code> tenía una muy alta correlación con <code>euribor3m</code> y <code>nr.employed</code>, 0.97 y 0.91 respectivamente, y una correlación igualmente importante con <code>cons_price_idx</code>. Tuvimos en cuenta esta información al momento de incorporarlas al modelo.</p>
<p> </p>
</div>
<div id="variables-categóricas" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Variables Categóricas</h2>
<p> </p>
<p><strong>Estado Civil</strong></p>
<div class="sourceCode" id="cb19"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Estado civil</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize <span class="op">=</span> (<span class="dv">8</span>, <span class="dv">5</span>))</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>barplot_percentages(<span class="st">&quot;est_civ&quot;</span>,</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>                   orient <span class="op">=</span> <span class="st">&#39;h&#39;</span>)</span></code></pre></div>
<p><img src="/img/tp_uba/output_40_0.png" /></p>
<div class="sourceCode" id="cb20"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>clientes.groupby(<span class="st">&#39;est_civ&#39;</span>)[<span class="st">&#39;y&#39;</span>].value_counts(normalize <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>    est_civ      y </span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>    casado       no    <span class="fl">0.898225</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>                 si    <span class="fl">0.101775</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>    desconocido  no    <span class="fl">0.849315</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>                 si    <span class="fl">0.150685</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>    divorciado   no    <span class="fl">0.900334</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>                 si    <span class="fl">0.099666</span></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>    soltero      no    <span class="fl">0.859432</span></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>                 si    <span class="fl">0.140568</span></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>    Name: y, dtype: float64</span></code></pre></div>
<p>La mayor proporción de compradores eran los solteros y los desconocidos.</p>
<p> </p>
<p><strong>Educación</strong></p>
<div class="sourceCode" id="cb21"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Educación</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize <span class="op">=</span> (<span class="dv">8</span>, <span class="dv">5</span>))</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>barplot_percentages(<span class="st">&quot;educacion&quot;</span>, orient <span class="op">=</span> <span class="st">&#39;h&#39;</span>)</span></code></pre></div>
<p><img src="/img/tp_uba/output_44_0.png" /></p>
<div class="sourceCode" id="cb22"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>clientes.groupby(<span class="st">&#39;educacion&#39;</span>)[<span class="st">&#39;y&#39;</span>].value_counts(normalize <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>    educacion          y </span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>    basica<span class="fl">.4</span>y          no    <span class="fl">0.896137</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>                       si    <span class="fl">0.103863</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>    basica<span class="fl">.6</span>y          no    <span class="fl">0.921498</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>                       si    <span class="fl">0.078502</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>    basica<span class="fl">.9</span>y          no    <span class="fl">0.924462</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>                       si    <span class="fl">0.075538</span></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>    curso profesional  no    <span class="fl">0.884900</span></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>                       si    <span class="fl">0.115100</span></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>    desconocido        no    <span class="fl">0.851064</span></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>                       si    <span class="fl">0.148936</span></span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>    secundario         no    <span class="fl">0.892857</span></span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>                       si    <span class="fl">0.107143</span></span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>    sin estudios       no    <span class="fl">0.750000</span></span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>                       si    <span class="fl">0.250000</span></span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a>    universitario      no    <span class="fl">0.861929</span></span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a>                       si    <span class="fl">0.138071</span></span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a>    Name: y, dtype: float64</span></code></pre></div>
<p>La mayoría de los clientes pertenecían al grupo universitario y secundario. También observamos que los clientes sin estudios eran los que más compraron en proporción pero representaban un porcentaje ínfimo del total. Vamos a filtrar a este grupo de clientes.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>clientes[clientes[<span class="st">&#39;educacion&#39;</span>] <span class="op">==</span> <span class="st">&#39;sin estudios&#39;</span>]</span></code></pre></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<div style="overflow-x:auto;">
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th>
</th>
<th>
edad
</th>
<th>
trabajo
</th>
<th>
est_civ
</th>
<th>
educacion
</th>
<th>
default
</th>
<th>
pres_viv
</th>
<th>
pres_per
</th>
<th>
contacto
</th>
<th>
mes
</th>
<th>
dia_sem
</th>
<th>
contactos
</th>
<th>
dias
</th>
<th>
anterior
</th>
<th>
res_ant
</th>
<th>
emp_var_rate
</th>
<th>
cons_price_idx
</th>
<th>
cons_conf_idx
</th>
<th>
euribor3m
</th>
<th>
nr_employed
</th>
<th>
y
</th>
</tr>
</thead>
<tbody>
<tr>
<th>
69
</th>
<td>
51
</td>
<td>
empresario
</td>
<td>
casado
</td>
<td>
sin estudios
</td>
<td>
no
</td>
<td>
no
</td>
<td>
no
</td>
<td>
celular
</td>
<td>
abr
</td>
<td>
jue
</td>
<td>
2
</td>
<td>
999
</td>
<td>
0
</td>
<td>
inexistente
</td>
<td>
-1.8
</td>
<td>
93.075
</td>
<td>
-47.1
</td>
<td>
1.410
</td>
<td>
5099.1
</td>
<td>
no
</td>
</tr>
<tr>
<th>
1594
</th>
<td>
55
</td>
<td>
obrero
</td>
<td>
casado
</td>
<td>
sin estudios
</td>
<td>
no
</td>
<td>
si
</td>
<td>
no
</td>
<td>
celular
</td>
<td>
jul
</td>
<td>
mar
</td>
<td>
3
</td>
<td>
999
</td>
<td>
0
</td>
<td>
inexistente
</td>
<td>
1.4
</td>
<td>
93.918
</td>
<td>
-42.7
</td>
<td>
4.961
</td>
<td>
5228.1
</td>
<td>
no
</td>
</tr>
<tr>
<th>
2127
</th>
<td>
80
</td>
<td>
jubilado
</td>
<td>
casado
</td>
<td>
sin estudios
</td>
<td>
desconocido
</td>
<td>
si
</td>
<td>
si
</td>
<td>
celular
</td>
<td>
ago
</td>
<td>
mar
</td>
<td>
1
</td>
<td>
6
</td>
<td>
1
</td>
<td>
exitosa
</td>
<td>
-2.9
</td>
<td>
92.201
</td>
<td>
-31.4
</td>
<td>
0.883
</td>
<td>
5076.2
</td>
<td>
si
</td>
</tr>
<tr>
<th>
3537
</th>
<td>
42
</td>
<td>
jubilado
</td>
<td>
divorciado
</td>
<td>
sin estudios
</td>
<td>
no
</td>
<td>
no
</td>
<td>
no
</td>
<td>
telefono
</td>
<td>
ago
</td>
<td>
mie
</td>
<td>
3
</td>
<td>
999
</td>
<td>
0
</td>
<td>
inexistente
</td>
<td>
-2.9
</td>
<td>
92.201
</td>
<td>
-31.4
</td>
<td>
0.834
</td>
<td>
5076.2
</td>
<td>
si
</td>
</tr>
<tr>
<th>
3837
</th>
<td>
45
</td>
<td>
obrero
</td>
<td>
casado
</td>
<td>
sin estudios
</td>
<td>
desconocido
</td>
<td>
no
</td>
<td>
no
</td>
<td>
telefono
</td>
<td>
may
</td>
<td>
jue
</td>
<td>
1
</td>
<td>
999
</td>
<td>
0
</td>
<td>
inexistente
</td>
<td>
1.1
</td>
<td>
93.994
</td>
<td>
-36.4
</td>
<td>
4.860
</td>
<td>
5191.0
</td>
<td>
no
</td>
</tr>
<tr>
<th>
3859
</th>
<td>
51
</td>
<td>
empresario
</td>
<td>
casado
</td>
<td>
sin estudios
</td>
<td>
no
</td>
<td>
si
</td>
<td>
no
</td>
<td>
celular
</td>
<td>
abr
</td>
<td>
jue
</td>
<td>
3
</td>
<td>
999
</td>
<td>
0
</td>
<td>
inexistente
</td>
<td>
-1.8
</td>
<td>
93.075
</td>
<td>
-47.1
</td>
<td>
1.410
</td>
<td>
5099.1
</td>
<td>
si
</td>
</tr>
<tr>
<th>
8205
</th>
<td>
60
</td>
<td>
ama de casa
</td>
<td>
casado
</td>
<td>
sin estudios
</td>
<td>
desconocido
</td>
<td>
si
</td>
<td>
no
</td>
<td>
celular
</td>
<td>
jul
</td>
<td>
mar
</td>
<td>
7
</td>
<td>
999
</td>
<td>
0
</td>
<td>
inexistente
</td>
<td>
1.4
</td>
<td>
93.918
</td>
<td>
-42.7
</td>
<td>
4.961
</td>
<td>
5228.1
</td>
<td>
no
</td>
</tr>
<tr>
<th>
10597
</th>
<td>
51
</td>
<td>
obrero
</td>
<td>
soltero
</td>
<td>
sin estudios
</td>
<td>
desconocido
</td>
<td>
si
</td>
<td>
no
</td>
<td>
celular
</td>
<td>
may
</td>
<td>
vie
</td>
<td>
3
</td>
<td>
999
</td>
<td>
0
</td>
<td>
inexistente
</td>
<td>
-1.8
</td>
<td>
92.893
</td>
<td>
-46.2
</td>
<td>
1.250
</td>
<td>
5099.1
</td>
<td>
no
</td>
</tr>
<tr>
<th>
10954
</th>
<td>
44
</td>
<td>
obrero
</td>
<td>
casado
</td>
<td>
sin estudios
</td>
<td>
no
</td>
<td>
no
</td>
<td>
no
</td>
<td>
celular
</td>
<td>
ago
</td>
<td>
vie
</td>
<td>
1
</td>
<td>
999
</td>
<td>
0
</td>
<td>
inexistente
</td>
<td>
1.4
</td>
<td>
93.444
</td>
<td>
-36.1
</td>
<td>
4.964
</td>
<td>
5228.1
</td>
<td>
no
</td>
</tr>
<tr>
<th>
13380
</th>
<td>
34
</td>
<td>
autonomo
</td>
<td>
casado
</td>
<td>
sin estudios
</td>
<td>
no
</td>
<td>
si
</td>
<td>
no
</td>
<td>
celular
</td>
<td>
nov
</td>
<td>
jue
</td>
<td>
1
</td>
<td>
999
</td>
<td>
0
</td>
<td>
inexistente
</td>
<td>
-0.1
</td>
<td>
93.200
</td>
<td>
-42.0
</td>
<td>
4.076
</td>
<td>
5195.8
</td>
<td>
si
</td>
</tr>
<tr>
<th>
13812
</th>
<td>
45
</td>
<td>
obrero
</td>
<td>
casado
</td>
<td>
sin estudios
</td>
<td>
desconocido
</td>
<td>
no
</td>
<td>
si
</td>
<td>
telefono
</td>
<td>
may
</td>
<td>
vie
</td>
<td>
2
</td>
<td>
999
</td>
<td>
0
</td>
<td>
inexistente
</td>
<td>
1.1
</td>
<td>
93.994
</td>
<td>
-36.4
</td>
<td>
4.857
</td>
<td>
5191.0
</td>
<td>
no
</td>
</tr>
<tr>
<th>
15064
</th>
<td>
34
</td>
<td>
autonomo
</td>
<td>
casado
</td>
<td>
sin estudios
</td>
<td>
no
</td>
<td>
si
</td>
<td>
no
</td>
<td>
celular
</td>
<td>
nov
</td>
<td>
jue
</td>
<td>
1
</td>
<td>
999
</td>
<td>
0
</td>
<td>
inexistente
</td>
<td>
-0.1
</td>
<td>
93.200
</td>
<td>
-42.0
</td>
<td>
4.076
</td>
<td>
5195.8
</td>
<td>
no
</td>
</tr>
<tr>
<th>
19393
</th>
<td>
42
</td>
<td>
jubilado
</td>
<td>
divorciado
</td>
<td>
sin estudios
</td>
<td>
no
</td>
<td>
no
</td>
<td>
no
</td>
<td>
celular
</td>
<td>
ago
</td>
<td>
mie
</td>
<td>
4
</td>
<td>
999
</td>
<td>
0
</td>
<td>
inexistente
</td>
<td>
-2.9
</td>
<td>
92.201
</td>
<td>
-31.4
</td>
<td>
0.834
</td>
<td>
5076.2
</td>
<td>
no
</td>
</tr>
<tr>
<th>
24056
</th>
<td>
51
</td>
<td>
administrativo
</td>
<td>
casado
</td>
<td>
sin estudios
</td>
<td>
desconocido
</td>
<td>
no
</td>
<td>
no
</td>
<td>
celular
</td>
<td>
jul
</td>
<td>
lun
</td>
<td>
4
</td>
<td>
999
</td>
<td>
0
</td>
<td>
inexistente
</td>
<td>
1.4
</td>
<td>
93.918
</td>
<td>
-42.7
</td>
<td>
4.960
</td>
<td>
5228.1
</td>
<td>
no
</td>
</tr>
<tr>
<th>
27199
</th>
<td>
34
</td>
<td>
autonomo
</td>
<td>
casado
</td>
<td>
sin estudios
</td>
<td>
no
</td>
<td>
si
</td>
<td>
no
</td>
<td>
celular
</td>
<td>
nov
</td>
<td>
jue
</td>
<td>
1
</td>
<td>
999
</td>
<td>
1
</td>
<td>
fallida
</td>
<td>
-0.1
</td>
<td>
93.200
</td>
<td>
-42.0
</td>
<td>
4.076
</td>
<td>
5195.8
</td>
<td>
no
</td>
</tr>
<tr>
<th>
33748
</th>
<td>
54
</td>
<td>
obrero
</td>
<td>
casado
</td>
<td>
sin estudios
</td>
<td>
desconocido
</td>
<td>
si
</td>
<td>
si
</td>
<td>
celular
</td>
<td>
jul
</td>
<td>
mar
</td>
<td>
1
</td>
<td>
999
</td>
<td>
0
</td>
<td>
inexistente
</td>
<td>
1.4
</td>
<td>
93.918
</td>
<td>
-42.7
</td>
<td>
4.961
</td>
<td>
5228.1
</td>
<td>
no
</td>
</tr>
</tbody>
</table>
</div>
<p>Efectivamente eran solo 16 registros, en los cuales observamos que tenemos a personas cuyos trabajos son administrativos o empresarios, posiblemente esto sea un error ya que no tienen ni siquiera estudios primarios.</p>
<p> </p>
<p><strong>Default</strong></p>
<div class="sourceCode" id="cb24"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Default</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize <span class="op">=</span> (<span class="dv">8</span>, <span class="dv">5</span>))</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>barplot_percentages(<span class="st">&quot;default&quot;</span>)</span></code></pre></div>
<p><img src="/img/tp_uba/output_50_0.png" /></p>
<div class="sourceCode" id="cb25"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>clientes.groupby(<span class="st">&#39;default&#39;</span>)[<span class="st">&#39;y&#39;</span>].value_counts(normalize <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>    default      y </span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>    desconocido  no    <span class="fl">0.948141</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>                 si    <span class="fl">0.051859</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>    no           no    <span class="fl">0.871465</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>                 si    <span class="fl">0.128535</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>    si           no    <span class="fl">1.000000</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>    Name: y, dtype: float64</span></code></pre></div>
<p>Quienes más compraron eran los clientes que no tenían default. También observamos que prácticamente no hay registros con default = ‘si’.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>clientes[clientes[<span class="st">&#39;default&#39;</span>] <span class="op">==</span> <span class="st">&#39;si&#39;</span>]</span></code></pre></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<div style="overflow-x:auto;">
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th>
</th>
<th>
edad
</th>
<th>
trabajo
</th>
<th>
est_civ
</th>
<th>
educacion
</th>
<th>
default
</th>
<th>
pres_viv
</th>
<th>
pres_per
</th>
<th>
contacto
</th>
<th>
mes
</th>
<th>
dia_sem
</th>
<th>
contactos
</th>
<th>
dias
</th>
<th>
anterior
</th>
<th>
res_ant
</th>
<th>
emp_var_rate
</th>
<th>
cons_price_idx
</th>
<th>
cons_conf_idx
</th>
<th>
euribor3m
</th>
<th>
nr_employed
</th>
<th>
y
</th>
</tr>
</thead>
<tbody>
<tr>
<th>
355
</th>
<td>
31
</td>
<td>
desocupado
</td>
<td>
casado
</td>
<td>
secundario
</td>
<td>
si
</td>
<td>
no
</td>
<td>
no
</td>
<td>
celular
</td>
<td>
nov
</td>
<td>
mar
</td>
<td>
2
</td>
<td>
999
</td>
<td>
1
</td>
<td>
fallida
</td>
<td>
-0.1
</td>
<td>
93.2
</td>
<td>
-42.0
</td>
<td>
4.153
</td>
<td>
5195.8
</td>
<td>
no
</td>
</tr>
</tbody>
</table>
</div>
<p>Efectivamente había un solo registro.</p>
<p> </p>
<p><strong>Préstamo Vivienda / Préstamo Personal</strong></p>
<div class="sourceCode" id="cb27"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>clientes[[<span class="st">&#39;pres_per&#39;</span>,<span class="st">&#39;pres_viv&#39;</span>]].value_counts().reset_index()</span></code></pre></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: middle;
    }
</style>
<div style="overflow-x:auto;">
<table border="1" class="dataframe">
<thead>
<tr style="text-align: middle;">
<th>
</th>
<th>
pres_per
</th>
<th>
pres_viv
</th>
<th>
0
</th>
</tr>
</thead>
<tbody>
<tr>
<th>
0
</th>
<td>
no
</td>
<td>
si
</td>
<td>
15197
</td>
</tr>
<tr>
<th>
1
</th>
<td>
no
</td>
<td>
no
</td>
<td>
13672
</td>
</tr>
<tr>
<th>
2
</th>
<td>
si
</td>
<td>
si
</td>
<td>
3135
</td>
</tr>
<tr>
<th>
3
</th>
<td>
si
</td>
<td>
no
</td>
<td>
2167
</td>
</tr>
<tr>
<th>
4
</th>
<td>
desconocido
</td>
<td>
desconocido
</td>
<td>
839
</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode" id="cb28"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Préstamo vivienda</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize <span class="op">=</span> (<span class="dv">8</span>, <span class="dv">5</span>))</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>barplot_percentages(<span class="st">&quot;pres_viv&quot;</span>,</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>                   orient <span class="op">=</span> <span class="st">&#39;h&#39;</span>)</span></code></pre></div>
<p><img src="/img/tp_uba/output_57_0.png" /></p>
<div class="sourceCode" id="cb29"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Préstamo Personal</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize <span class="op">=</span> (<span class="dv">8</span>, <span class="dv">5</span>))</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>barplot_percentages(<span class="st">&quot;pres_per&quot;</span>,</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>                   orient <span class="op">=</span> <span class="st">&#39;h&#39;</span>)</span></code></pre></div>
<p><img src="/img/tp_uba/output_58_0.png" /></p>
<div class="sourceCode" id="cb30"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>clientes.groupby(<span class="st">&#39;pres_per&#39;</span>)[<span class="st">&#39;y&#39;</span>].value_counts(normalize <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>    pres_per     y </span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>    desconocido  no    <span class="fl">0.896305</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>                 si    <span class="fl">0.103695</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>    no           no    <span class="fl">0.887076</span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>                 si    <span class="fl">0.112924</span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>    si           no    <span class="fl">0.887967</span></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>                 si    <span class="fl">0.112033</span></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>    Name: y, dtype: float64</span></code></pre></div>
<p>Observamos que ambas variables se distribuían igual respecto a la variable objetivo indicando que posiblemente no sea necesario incorporar ambas variables simultáneamente.</p>
<p> </p>
<p><strong>Contacto</strong></p>
<div class="sourceCode" id="cb31"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Contacto</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize <span class="op">=</span> (<span class="dv">8</span>, <span class="dv">5</span>))</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>barplot_percentages(<span class="st">&quot;contacto&quot;</span>)</span></code></pre></div>
<p><img src="/img/tp_uba/output_62_0.png" /></p>
<div class="sourceCode" id="cb32"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>clientes.groupby(<span class="st">&#39;contacto&#39;</span>)[<span class="st">&#39;y&#39;</span>].value_counts(normalize <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>    contacto  y </span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>    celular   no    <span class="fl">0.852801</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>              si    <span class="fl">0.147199</span></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>    telefono  no    <span class="fl">0.947760</span></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>              si    <span class="fl">0.052240</span></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>    Name: y, dtype: float64</span></code></pre></div>
<p>Observamos una mayor proporción de ventas cuando el contacto se realizaba por celular.</p>
<p> </p>
<p><strong>Mes</strong></p>
<div class="sourceCode" id="cb33"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Mes</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize <span class="op">=</span> (<span class="dv">12</span>, <span class="dv">5</span>))</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>barplot_percentages(<span class="st">&quot;mes&quot;</span>,</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>                   orient <span class="op">=</span> <span class="st">&#39;h&#39;</span>)</span></code></pre></div>
<p><img src="/img/tp_uba/output_66_0.png" /></p>
<div class="sourceCode" id="cb34"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>clientes.groupby(<span class="st">&#39;mes&#39;</span>)[<span class="st">&#39;y&#39;</span>].value_counts(normalize <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>    mes  y </span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>    abr  no    <span class="fl">0.798308</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>         si    <span class="fl">0.201692</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>    ago  no    <span class="fl">0.895078</span></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>         si    <span class="fl">0.104922</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>    dic  no    <span class="fl">0.509317</span></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>         si    <span class="fl">0.490683</span></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>    jul  no    <span class="fl">0.908853</span></span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>         si    <span class="fl">0.091147</span></span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>    jun  no    <span class="fl">0.897797</span></span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>         si    <span class="fl">0.102203</span></span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>    mar  si    <span class="fl">0.514957</span></span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a>         no    <span class="fl">0.485043</span></span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a>    may  no    <span class="fl">0.935846</span></span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a>         si    <span class="fl">0.064154</span></span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a>    nov  no    <span class="fl">0.899453</span></span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a>         si    <span class="fl">0.100547</span></span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a>    <span class="bu">oct</span>  no    <span class="fl">0.547855</span></span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a>         si    <span class="fl">0.452145</span></span>
<span id="cb34-22"><a href="#cb34-22" aria-hidden="true" tabindex="-1"></a>    sep  no    <span class="fl">0.540816</span></span>
<span id="cb34-23"><a href="#cb34-23" aria-hidden="true" tabindex="-1"></a>         si    <span class="fl">0.459184</span></span>
<span id="cb34-24"><a href="#cb34-24" aria-hidden="true" tabindex="-1"></a>    Name: y, dtype: float64</span></code></pre></div>
<p>La proporción de ventas en los meses de Marzo, Octubre, Septiembre y Diciembre fue mayor al 45%.</p>
<p> </p>
<p><strong>Día Semana</strong></p>
<div class="sourceCode" id="cb35"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Día de la semana</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize <span class="op">=</span> (<span class="dv">8</span>, <span class="dv">5</span>))</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>barplot_percentages(<span class="st">&quot;dia_sem&quot;</span>,</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>                   orient <span class="op">=</span> <span class="st">&#39;h&#39;</span>)</span></code></pre></div>
<p><img src="/img/tp_uba/output_70_0.png" /></p>
<div class="sourceCode" id="cb36"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>clientes.groupby(<span class="st">&#39;dia_sem&#39;</span>)[<span class="st">&#39;y&#39;</span>].value_counts(normalize <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>    dia_sem  y </span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>    jue      no    <span class="fl">0.879712</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>             si    <span class="fl">0.120288</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>    lun      no    <span class="fl">0.898537</span></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>             si    <span class="fl">0.101463</span></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>    mar      no    <span class="fl">0.883280</span></span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>             si    <span class="fl">0.116720</span></span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>    mie      no    <span class="fl">0.883350</span></span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>             si    <span class="fl">0.116650</span></span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>    vie      no    <span class="fl">0.892375</span></span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>             si    <span class="fl">0.107625</span></span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a>    Name: y, dtype: float64</span></code></pre></div>
<p>No observamos variación importante de ventas con respecto al día de la semana.</p>
<p> </p>
<p><strong>Trabajo</strong></p>
<div class="sourceCode" id="cb37"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Trabajo</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize <span class="op">=</span> (<span class="dv">8</span>, <span class="dv">5</span>))</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>barplot_percentages(<span class="st">&quot;trabajo&quot;</span>,</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>                   orient <span class="op">=</span> <span class="st">&#39;h&#39;</span>)</span></code></pre></div>
<p><img src="/img/tp_uba/output_74_0.png" /></p>
<div class="sourceCode" id="cb38"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>clientes.groupby(<span class="st">&#39;trabajo&#39;</span>)[<span class="st">&#39;y&#39;</span>].value_counts(normalize <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>    trabajo         y </span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>    administrativo  no    <span class="fl">0.867012</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>                    si    <span class="fl">0.132988</span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>    ama de casa     no    <span class="fl">0.903575</span></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>                    si    <span class="fl">0.096425</span></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>    autonomo        no    <span class="fl">0.893212</span></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>                    si    <span class="fl">0.106788</span></span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>    desconocido     no    <span class="fl">0.880702</span></span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>                    si    <span class="fl">0.119298</span></span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>    desocupado      no    <span class="fl">0.864310</span></span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>                    si    <span class="fl">0.135690</span></span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a>    empresario      no    <span class="fl">0.916734</span></span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a>                    si    <span class="fl">0.083266</span></span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a>    estudiante      no    <span class="fl">0.684426</span></span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a>                    si    <span class="fl">0.315574</span></span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a>    gerente         no    <span class="fl">0.891093</span></span>
<span id="cb38-19"><a href="#cb38-19" aria-hidden="true" tabindex="-1"></a>                    si    <span class="fl">0.108907</span></span>
<span id="cb38-20"><a href="#cb38-20" aria-hidden="true" tabindex="-1"></a>    jubilado        no    <span class="fl">0.749829</span></span>
<span id="cb38-21"><a href="#cb38-21" aria-hidden="true" tabindex="-1"></a>                    si    <span class="fl">0.250171</span></span>
<span id="cb38-22"><a href="#cb38-22" aria-hidden="true" tabindex="-1"></a>    obrero          no    <span class="fl">0.932238</span></span>
<span id="cb38-23"><a href="#cb38-23" aria-hidden="true" tabindex="-1"></a>                    si    <span class="fl">0.067762</span></span>
<span id="cb38-24"><a href="#cb38-24" aria-hidden="true" tabindex="-1"></a>    servicios       no    <span class="fl">0.918831</span></span>
<span id="cb38-25"><a href="#cb38-25" aria-hidden="true" tabindex="-1"></a>                    si    <span class="fl">0.081169</span></span>
<span id="cb38-26"><a href="#cb38-26" aria-hidden="true" tabindex="-1"></a>    tecnico         no    <span class="fl">0.892238</span></span>
<span id="cb38-27"><a href="#cb38-27" aria-hidden="true" tabindex="-1"></a>                    si    <span class="fl">0.107762</span></span>
<span id="cb38-28"><a href="#cb38-28" aria-hidden="true" tabindex="-1"></a>    Name: y, dtype: float64</span></code></pre></div>
<p>Estudiantes y jubilados eran quienes más compraban en proporción. Algo de esto vimos también en el gráfico de la distribución de los clientes por edad.</p>
<p> </p>
<p><strong>Anterior</strong></p>
<div class="sourceCode" id="cb39"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Anterior</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize <span class="op">=</span> (<span class="dv">8</span>, <span class="dv">5</span>))</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>barplot_percentages(<span class="st">&quot;anterior&quot;</span>)</span></code></pre></div>
<p><img src="/img/tp_uba/output_78_0.png" /></p>
<div class="sourceCode" id="cb40"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>clientes.groupby(<span class="st">&#39;anterior&#39;</span>)[<span class="st">&#39;y&#39;</span>].value_counts()</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>    anterior  y </span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>    <span class="dv">0</span>         no    <span class="dv">27565</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>              si     <span class="dv">2664</span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span>         no     <span class="dv">3048</span></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>              si      <span class="dv">824</span></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>    <span class="dv">2</span>         no      <span class="dv">352</span></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>              si      <span class="dv">297</span></span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>    <span class="dv">3</span>         si      <span class="dv">109</span></span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>              no       <span class="dv">73</span></span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a>    <span class="dv">4</span>         si       <span class="dv">34</span></span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a>              no       <span class="dv">23</span></span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a>    <span class="dv">5</span>         si       <span class="dv">11</span></span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a>              no        <span class="dv">5</span></span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a>    <span class="dv">6</span>         no        <span class="dv">2</span></span>
<span id="cb40-17"><a href="#cb40-17" aria-hidden="true" tabindex="-1"></a>              si        <span class="dv">2</span></span>
<span id="cb40-18"><a href="#cb40-18" aria-hidden="true" tabindex="-1"></a>    <span class="dv">7</span>         no        <span class="dv">1</span></span>
<span id="cb40-19"><a href="#cb40-19" aria-hidden="true" tabindex="-1"></a>    Name: y, dtype: int64</span></code></pre></div>
<p>Nuevamente observamos muy baja frecuencia de algunas categorías por lo que decidimos reagrupar algunas de ellas.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>clientes.groupby(<span class="st">&#39;anterior&#39;</span>)[<span class="st">&#39;y&#39;</span>].value_counts(normalize <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>    anterior  y </span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>    <span class="dv">0</span>         no    <span class="fl">0.911873</span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>              si    <span class="fl">0.088127</span></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span>         no    <span class="fl">0.787190</span></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>              si    <span class="fl">0.212810</span></span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>    <span class="dv">2</span>         no    <span class="fl">0.542373</span></span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>              si    <span class="fl">0.457627</span></span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>    <span class="dv">3</span>         si    <span class="fl">0.598901</span></span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>              no    <span class="fl">0.401099</span></span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>    <span class="dv">4</span>         si    <span class="fl">0.596491</span></span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a>              no    <span class="fl">0.403509</span></span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a>    <span class="dv">5</span>         si    <span class="fl">0.687500</span></span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a>              no    <span class="fl">0.312500</span></span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a>    <span class="dv">6</span>         no    <span class="fl">0.500000</span></span>
<span id="cb41-17"><a href="#cb41-17" aria-hidden="true" tabindex="-1"></a>              si    <span class="fl">0.500000</span></span>
<span id="cb41-18"><a href="#cb41-18" aria-hidden="true" tabindex="-1"></a>    <span class="dv">7</span>         no    <span class="fl">1.000000</span></span>
<span id="cb41-19"><a href="#cb41-19" aria-hidden="true" tabindex="-1"></a>    Name: y, dtype: float64</span></code></pre></div>
<p> </p>
<p><strong>Resultado Anterior</strong></p>
<div class="sourceCode" id="cb42"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Resultado Anterior</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize <span class="op">=</span> (<span class="dv">8</span>, <span class="dv">5</span>))</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>barplot_percentages(<span class="st">&quot;res_ant&quot;</span>)</span></code></pre></div>
<p><img src="/img/tp_uba/output_83_0.png" /></p>
<div class="sourceCode" id="cb43"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>clientes.groupby(<span class="st">&#39;res_ant&#39;</span>)[<span class="st">&#39;y&#39;</span>].value_counts(normalize <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>    res_ant      y </span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>    exitosa      si    <span class="fl">0.644970</span></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>                 no    <span class="fl">0.355030</span></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>    fallida      no    <span class="fl">0.857143</span></span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>                 si    <span class="fl">0.142857</span></span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>    inexistente  no    <span class="fl">0.911873</span></span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>                 si    <span class="fl">0.088127</span></span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>    Name: y, dtype: float64</span></code></pre></div>
<p>El 65% de los clientes que habían comprado en campañas anteriores volvieron a adquirir el producto bancario. Esta sin dudas es una variable con gran valor predictivo.</p>
<p> </p>
<p><strong>Días</strong></p>
<div class="sourceCode" id="cb44"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Días</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize <span class="op">=</span> (<span class="dv">8</span>, <span class="dv">5</span>))</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>barplot_percentages(<span class="st">&quot;dias&quot;</span>)</span></code></pre></div>
<p><img src="/img/tp_uba/output_87_0.png" /></p>
<div class="sourceCode" id="cb45"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>clientes.groupby(<span class="st">&#39;dias&#39;</span>)[<span class="st">&#39;y&#39;</span>].value_counts(normalize <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>    dias  y </span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>    <span class="dv">0</span>     si    <span class="fl">0.615385</span></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>          no    <span class="fl">0.384615</span></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span>     no    <span class="fl">0.714286</span></span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>          si    <span class="fl">0.285714</span></span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>    <span class="dv">2</span>     si    <span class="fl">0.584906</span></span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>          no    <span class="fl">0.415094</span></span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>    <span class="dv">3</span>     si    <span class="fl">0.665775</span></span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a>          no    <span class="fl">0.334225</span></span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a>    <span class="dv">4</span>     si    <span class="fl">0.538462</span></span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a>          no    <span class="fl">0.461538</span></span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a>    <span class="dv">5</span>     si    <span class="fl">0.657895</span></span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a>          no    <span class="fl">0.342105</span></span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a>    <span class="dv">6</span>     si    <span class="fl">0.693151</span></span>
<span id="cb45-18"><a href="#cb45-18" aria-hidden="true" tabindex="-1"></a>          no    <span class="fl">0.306849</span></span>
<span id="cb45-19"><a href="#cb45-19" aria-hidden="true" tabindex="-1"></a>    <span class="dv">7</span>     si    <span class="fl">0.642857</span></span>
<span id="cb45-20"><a href="#cb45-20" aria-hidden="true" tabindex="-1"></a>          no    <span class="fl">0.357143</span></span>
<span id="cb45-21"><a href="#cb45-21" aria-hidden="true" tabindex="-1"></a>    <span class="dv">8</span>     si    <span class="fl">0.714286</span></span>
<span id="cb45-22"><a href="#cb45-22" aria-hidden="true" tabindex="-1"></a>          no    <span class="fl">0.285714</span></span>
<span id="cb45-23"><a href="#cb45-23" aria-hidden="true" tabindex="-1"></a>    <span class="dv">9</span>     si    <span class="fl">0.571429</span></span>
<span id="cb45-24"><a href="#cb45-24" aria-hidden="true" tabindex="-1"></a>          no    <span class="fl">0.428571</span></span>
<span id="cb45-25"><a href="#cb45-25" aria-hidden="true" tabindex="-1"></a>    <span class="dv">10</span>    si    <span class="fl">0.560976</span></span>
<span id="cb45-26"><a href="#cb45-26" aria-hidden="true" tabindex="-1"></a>          no    <span class="fl">0.439024</span></span>
<span id="cb45-27"><a href="#cb45-27" aria-hidden="true" tabindex="-1"></a>    <span class="dv">11</span>    si    <span class="fl">0.520000</span></span>
<span id="cb45-28"><a href="#cb45-28" aria-hidden="true" tabindex="-1"></a>          no    <span class="fl">0.480000</span></span>
<span id="cb45-29"><a href="#cb45-29" aria-hidden="true" tabindex="-1"></a>    <span class="dv">12</span>    no    <span class="fl">0.538462</span></span>
<span id="cb45-30"><a href="#cb45-30" aria-hidden="true" tabindex="-1"></a>          si    <span class="fl">0.461538</span></span>
<span id="cb45-31"><a href="#cb45-31" aria-hidden="true" tabindex="-1"></a>    <span class="dv">13</span>    si    <span class="fl">0.774194</span></span>
<span id="cb45-32"><a href="#cb45-32" aria-hidden="true" tabindex="-1"></a>          no    <span class="fl">0.225806</span></span>
<span id="cb45-33"><a href="#cb45-33" aria-hidden="true" tabindex="-1"></a>    <span class="dv">14</span>    si    <span class="fl">0.529412</span></span>
<span id="cb45-34"><a href="#cb45-34" aria-hidden="true" tabindex="-1"></a>          no    <span class="fl">0.470588</span></span>
<span id="cb45-35"><a href="#cb45-35" aria-hidden="true" tabindex="-1"></a>    <span class="dv">15</span>    si    <span class="fl">0.619048</span></span>
<span id="cb45-36"><a href="#cb45-36" aria-hidden="true" tabindex="-1"></a>          no    <span class="fl">0.380952</span></span>
<span id="cb45-37"><a href="#cb45-37" aria-hidden="true" tabindex="-1"></a>    <span class="dv">16</span>    no    <span class="fl">0.500000</span></span>
<span id="cb45-38"><a href="#cb45-38" aria-hidden="true" tabindex="-1"></a>          si    <span class="fl">0.500000</span></span>
<span id="cb45-39"><a href="#cb45-39" aria-hidden="true" tabindex="-1"></a>    <span class="dv">17</span>    no    <span class="fl">0.750000</span></span>
<span id="cb45-40"><a href="#cb45-40" aria-hidden="true" tabindex="-1"></a>          si    <span class="fl">0.250000</span></span>
<span id="cb45-41"><a href="#cb45-41" aria-hidden="true" tabindex="-1"></a>    <span class="dv">18</span>    si    <span class="fl">0.571429</span></span>
<span id="cb45-42"><a href="#cb45-42" aria-hidden="true" tabindex="-1"></a>          no    <span class="fl">0.428571</span></span>
<span id="cb45-43"><a href="#cb45-43" aria-hidden="true" tabindex="-1"></a>    <span class="dv">19</span>    no    <span class="fl">0.666667</span></span>
<span id="cb45-44"><a href="#cb45-44" aria-hidden="true" tabindex="-1"></a>          si    <span class="fl">0.333333</span></span>
<span id="cb45-45"><a href="#cb45-45" aria-hidden="true" tabindex="-1"></a>    <span class="dv">20</span>    no    <span class="fl">1.000000</span></span>
<span id="cb45-46"><a href="#cb45-46" aria-hidden="true" tabindex="-1"></a>    <span class="dv">21</span>    si    <span class="fl">1.000000</span></span>
<span id="cb45-47"><a href="#cb45-47" aria-hidden="true" tabindex="-1"></a>    <span class="dv">22</span>    si    <span class="fl">0.666667</span></span>
<span id="cb45-48"><a href="#cb45-48" aria-hidden="true" tabindex="-1"></a>          no    <span class="fl">0.333333</span></span>
<span id="cb45-49"><a href="#cb45-49" aria-hidden="true" tabindex="-1"></a>    <span class="dv">25</span>    si    <span class="fl">1.000000</span></span>
<span id="cb45-50"><a href="#cb45-50" aria-hidden="true" tabindex="-1"></a>    <span class="dv">26</span>    si    <span class="fl">1.000000</span></span>
<span id="cb45-51"><a href="#cb45-51" aria-hidden="true" tabindex="-1"></a>    <span class="dv">27</span>    si    <span class="fl">1.000000</span></span>
<span id="cb45-52"><a href="#cb45-52" aria-hidden="true" tabindex="-1"></a>    <span class="dv">999</span>   no    <span class="fl">0.907642</span></span>
<span id="cb45-53"><a href="#cb45-53" aria-hidden="true" tabindex="-1"></a>          si    <span class="fl">0.092358</span></span>
<span id="cb45-54"><a href="#cb45-54" aria-hidden="true" tabindex="-1"></a>    Name: y, dtype: float64</span></code></pre></div>
<div class="sourceCode" id="cb46"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>clientes[<span class="st">&#39;dias&#39;</span>].value_counts(normalize <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>    <span class="dv">999</span>    <span class="fl">0.962439</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>    <span class="dv">3</span>      <span class="fl">0.010683</span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>    <span class="dv">6</span>      <span class="fl">0.010426</span></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>    <span class="dv">4</span>      <span class="fl">0.002971</span></span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>    <span class="dv">9</span>      <span class="fl">0.001600</span></span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>    <span class="dv">7</span>      <span class="fl">0.001600</span></span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>    <span class="dv">2</span>      <span class="fl">0.001514</span></span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>    <span class="dv">12</span>     <span class="fl">0.001485</span></span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a>    <span class="dv">10</span>     <span class="fl">0.001171</span></span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a>    <span class="dv">5</span>      <span class="fl">0.001085</span></span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a>    <span class="dv">13</span>     <span class="fl">0.000885</span></span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a>    <span class="dv">11</span>     <span class="fl">0.000714</span></span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span>      <span class="fl">0.000600</span></span>
<span id="cb46-16"><a href="#cb46-16" aria-hidden="true" tabindex="-1"></a>    <span class="dv">15</span>     <span class="fl">0.000600</span></span>
<span id="cb46-17"><a href="#cb46-17" aria-hidden="true" tabindex="-1"></a>    <span class="dv">14</span>     <span class="fl">0.000486</span></span>
<span id="cb46-18"><a href="#cb46-18" aria-hidden="true" tabindex="-1"></a>    <span class="dv">8</span>      <span class="fl">0.000400</span></span>
<span id="cb46-19"><a href="#cb46-19" aria-hidden="true" tabindex="-1"></a>    <span class="dv">0</span>      <span class="fl">0.000371</span></span>
<span id="cb46-20"><a href="#cb46-20" aria-hidden="true" tabindex="-1"></a>    <span class="dv">16</span>     <span class="fl">0.000229</span></span>
<span id="cb46-21"><a href="#cb46-21" aria-hidden="true" tabindex="-1"></a>    <span class="dv">17</span>     <span class="fl">0.000229</span></span>
<span id="cb46-22"><a href="#cb46-22" aria-hidden="true" tabindex="-1"></a>    <span class="dv">18</span>     <span class="fl">0.000200</span></span>
<span id="cb46-23"><a href="#cb46-23" aria-hidden="true" tabindex="-1"></a>    <span class="dv">19</span>     <span class="fl">0.000086</span></span>
<span id="cb46-24"><a href="#cb46-24" aria-hidden="true" tabindex="-1"></a>    <span class="dv">22</span>     <span class="fl">0.000086</span></span>
<span id="cb46-25"><a href="#cb46-25" aria-hidden="true" tabindex="-1"></a>    <span class="dv">26</span>     <span class="fl">0.000029</span></span>
<span id="cb46-26"><a href="#cb46-26" aria-hidden="true" tabindex="-1"></a>    <span class="dv">20</span>     <span class="fl">0.000029</span></span>
<span id="cb46-27"><a href="#cb46-27" aria-hidden="true" tabindex="-1"></a>    <span class="dv">21</span>     <span class="fl">0.000029</span></span>
<span id="cb46-28"><a href="#cb46-28" aria-hidden="true" tabindex="-1"></a>    <span class="dv">25</span>     <span class="fl">0.000029</span></span>
<span id="cb46-29"><a href="#cb46-29" aria-hidden="true" tabindex="-1"></a>    <span class="dv">27</span>     <span class="fl">0.000029</span></span>
<span id="cb46-30"><a href="#cb46-30" aria-hidden="true" tabindex="-1"></a>    Name: dias, dtype: float64</span></code></pre></div>
<p>Nuevamente observamos categorías con muy baja frecuencia. El 96% de los clientes estaban etiquetados con 999 lo que significa que no han sido contactados en campañas anteriores.</p>
<p> </p>
</div>
</div>
<div id="división-train-y-test" class="section level1" number="5">
<h1><span class="header-section-number">5</span> División Train y Test</h1>
<p>A fin de poder validar nuestro modelo separamos el dataset en un set de entrenamiento y un set de validación.</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> clientes.drop([<span class="st">&#39;y&#39;</span>], axis <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> clientes[<span class="st">&#39;y&#39;</span>]</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(X,</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>                                                    y, </span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>                                                    test_size <span class="op">=</span> <span class="fl">0.20</span>, </span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>                                                    random_state <span class="op">=</span> <span class="dv">42</span>,</span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>                                                    stratify <span class="op">=</span> y)</span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(X_train.shape, X_test.shape, y_train.shape, y_test.shape)</span></code></pre></div>
<pre><code>(28008, 19) (7002, 19) (28008,) (7002,)</code></pre>
<p> </p>
</div>
<div id="data-cleaning-feature-engineering" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Data Cleaning / Feature Engineering</h1>
<p>Realizamos el data cleaning sobre el set de entrenamiento y luego aplicamos las mismas modificaciones sobre el set de prueba. Esto es necesario ya que al imputar valores desconocidos podríamos estar calculando medias o valores más frecuentes utilizando los mismos datos que servirán para testear el modelo lo que implicaría causar data leakage.</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Juntamos las variables predictivas con la objetivo.</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>train <span class="op">=</span> pd.concat([X_train,</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>                   y_train],</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>                   axis <span class="op">=</span> <span class="dv">1</span>).reset_index()</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>test <span class="op">=</span> pd.concat([X_test,</span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>                  y_test],</span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>                  axis <span class="op">=</span> <span class="dv">1</span>).reset_index()</span></code></pre></div>
<p> </p>
<div id="valores-desconocidos-ausentes" class="section level2" number="6.1">
<h2><span class="header-section-number">6.1</span> Valores Desconocidos / Ausentes</h2>
<p>En este dataset los valores nulos han sido etiquetados como valores desconocidos los cuales se encontraban dentro de los siguientes atributos.</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>train.replace(<span class="st">&#39;desconocido&#39;</span>, np.nan).isnull().<span class="bu">sum</span>()</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>    index                <span class="dv">0</span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>    edad                 <span class="dv">0</span></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>    trabajo            <span class="dv">239</span></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>    est_civ             <span class="dv">62</span></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>    educacion         <span class="dv">1148</span></span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>    default           <span class="dv">5832</span></span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>    pres_viv           <span class="dv">668</span></span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>    pres_per           <span class="dv">668</span></span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a>    contacto             <span class="dv">0</span></span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a>    mes                  <span class="dv">0</span></span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a>    dia_sem              <span class="dv">0</span></span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a>    contactos            <span class="dv">0</span></span>
<span id="cb50-15"><a href="#cb50-15" aria-hidden="true" tabindex="-1"></a>    dias                 <span class="dv">0</span></span>
<span id="cb50-16"><a href="#cb50-16" aria-hidden="true" tabindex="-1"></a>    anterior             <span class="dv">0</span></span>
<span id="cb50-17"><a href="#cb50-17" aria-hidden="true" tabindex="-1"></a>    res_ant              <span class="dv">0</span></span>
<span id="cb50-18"><a href="#cb50-18" aria-hidden="true" tabindex="-1"></a>    emp_var_rate         <span class="dv">0</span></span>
<span id="cb50-19"><a href="#cb50-19" aria-hidden="true" tabindex="-1"></a>    cons_price_idx       <span class="dv">0</span></span>
<span id="cb50-20"><a href="#cb50-20" aria-hidden="true" tabindex="-1"></a>    cons_conf_idx        <span class="dv">0</span></span>
<span id="cb50-21"><a href="#cb50-21" aria-hidden="true" tabindex="-1"></a>    euribor3m            <span class="dv">0</span></span>
<span id="cb50-22"><a href="#cb50-22" aria-hidden="true" tabindex="-1"></a>    nr_employed          <span class="dv">0</span></span>
<span id="cb50-23"><a href="#cb50-23" aria-hidden="true" tabindex="-1"></a>    y                    <span class="dv">0</span></span>
<span id="cb50-24"><a href="#cb50-24" aria-hidden="true" tabindex="-1"></a>    dtype: int64</span></code></pre></div>
<p>Observamos valores desconocidos en las variables <code>trabajo</code>, <code>est_civ</code>, <code>educacion</code>, <code>default</code>, <code>pres_viv</code> y <code>pres_per</code>.</p>
<p>Las estrategias que se suelen tomar para lidiar con valores desconocidos son principalmente tres: eliminarlos, dejarlos como están o bien intentar imputarlos. Para este último punto consideramos lo siguiente:</p>
<ul>
<li><p>Imputar los valores desconocidos en <code>trabajo</code> a partir de la eduación, es decir, observando para cada profesión cuál es el nivel educativo más frecuente. De la misma manera podemos completar los desconocidos en <code>educacion</code> observando cuál es el trabajo más frecuente.</p></li>
<li><p>Para los valores desconocidos en el estado civil utilizamos rangos de edades.</p></li>
<li><p>Para el caso de <code>default</code> decidimos no imputar valores dejando como categorías <em>no</em> y <em>desconocido</em>.</p></li>
<li><p>En <code>pres_per</code> y <code>pres_viv</code> observamos que tenían la misma cantidad de desconocidos. En el análisis gráfico también vimos que no parecían ser variables que afecten a la variable de respuesta por lo que decidimos eliminarlos.</p></li>
</ul>
<div class="sourceCode" id="cb51"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>train[(train[<span class="st">&#39;pres_per&#39;</span>] <span class="op">==</span> <span class="st">&#39;desconocido&#39;</span>) <span class="op">&amp;</span> </span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>      (train[<span class="st">&#39;pres_viv&#39;</span>] <span class="op">==</span> <span class="st">&#39;desconocido&#39;</span>)].shape</span></code></pre></div>
<pre><code>(668, 21)</code></pre>
<p>Efectivamente, observamos 668 registros con valores desconocidos en forma simultánea en <code>pres_per</code> y <code>pres_viv</code>.</p>
<p> </p>
</div>
<div id="registros-duplicados" class="section level2" number="6.2">
<h2><span class="header-section-number">6.2</span> Registros Duplicados</h2>
<p>Dentro del dataset observamos 1312 registros duplicados. Si tenemos en cuenta que queremos que nuestro modelo predictivo obtenga buenos resultados en datos nunca vistos, una buena idea es que no hayan registros duplicados entre el set de de entrenamiento y el set de prueba ya que el modelo los calificará correctamente.</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Registros duplicados</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>clientes.duplicated().<span class="bu">sum</span>()</span></code></pre></div>
<pre><code>1312</code></pre>
<p> </p>
</div>
<div id="función-cleanerimputer" class="section level2" number="6.3">
<h2><span class="header-section-number">6.3</span> Función Cleaner/Imputer</h2>
<p>Armamos una función cleaner para procesar los datos de entrenamiento según las observaciones que fuimos realizando a partir del análisis gráfico y de distribución de las variables. Luego utilizamos la misma función para procesar el set de prueba.</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> cleaner(datos):</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># MODIFICACIÓN DE ATRIBUTOS Y CATEGORÍAS</span></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ======================================</span></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Variable Objetivo:</span></span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ------------------</span></span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Pasamos la variable objetivo a ceros y unos.</span></span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a>  datos[<span class="st">&#39;y&#39;</span>] <span class="op">=</span> datos[<span class="st">&#39;y&#39;</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: <span class="dv">0</span> <span class="cf">if</span> x <span class="op">==</span> <span class="st">&#39;no&#39;</span> <span class="cf">else</span> <span class="dv">1</span>)</span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Educacion:</span></span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ----------</span></span>
<span id="cb55-14"><a href="#cb55-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Unificamos categorías</span></span>
<span id="cb55-15"><a href="#cb55-15" aria-hidden="true" tabindex="-1"></a>                                </span>
<span id="cb55-16"><a href="#cb55-16" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> <span class="va">True</span>:</span>
<span id="cb55-17"><a href="#cb55-17" aria-hidden="true" tabindex="-1"></a>    datos.replace({<span class="st">&#39;basica.4y&#39;</span>        : <span class="st">&#39;primaria&#39;</span>,</span>
<span id="cb55-18"><a href="#cb55-18" aria-hidden="true" tabindex="-1"></a>                   <span class="st">&#39;basica.6y&#39;</span>        : <span class="st">&#39;primaria&#39;</span>,</span>
<span id="cb55-19"><a href="#cb55-19" aria-hidden="true" tabindex="-1"></a>                   <span class="st">&#39;basica.9y&#39;</span>        : <span class="st">&#39;primaria&#39;</span>,</span>
<span id="cb55-20"><a href="#cb55-20" aria-hidden="true" tabindex="-1"></a>                   <span class="st">&#39;sin estudios&#39;</span>     : <span class="st">&#39;no&#39;</span>,</span>
<span id="cb55-21"><a href="#cb55-21" aria-hidden="true" tabindex="-1"></a>                   <span class="st">&#39;curso profesional&#39;</span>: <span class="st">&#39;curso&#39;</span>},</span>
<span id="cb55-22"><a href="#cb55-22" aria-hidden="true" tabindex="-1"></a>                    inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb55-23"><a href="#cb55-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-24"><a href="#cb55-24" aria-hidden="true" tabindex="-1"></a> <span class="co"># Dias</span></span>
<span id="cb55-25"><a href="#cb55-25" aria-hidden="true" tabindex="-1"></a> <span class="co"># ----</span></span>
<span id="cb55-26"><a href="#cb55-26" aria-hidden="true" tabindex="-1"></a> <span class="co"># Dado que 999 significa que el cliente no fue contactado previamente </span></span>
<span id="cb55-27"><a href="#cb55-27" aria-hidden="true" tabindex="-1"></a> <span class="co"># -- lo clasificamos con 0.</span></span>
<span id="cb55-28"><a href="#cb55-28" aria-hidden="true" tabindex="-1"></a>                                </span>
<span id="cb55-29"><a href="#cb55-29" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> <span class="va">True</span>:                          </span>
<span id="cb55-30"><a href="#cb55-30" aria-hidden="true" tabindex="-1"></a>    datos[<span class="st">&#39;dias&#39;</span>].replace({<span class="dv">999</span> : <span class="dv">0</span>},</span>
<span id="cb55-31"><a href="#cb55-31" aria-hidden="true" tabindex="-1"></a>                          inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb55-32"><a href="#cb55-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-33"><a href="#cb55-33" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Contactos</span></span>
<span id="cb55-34"><a href="#cb55-34" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ----</span></span>
<span id="cb55-35"><a href="#cb55-35" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Categoría 4 significa mayor a 4 contactos (reducimos categorías).</span></span>
<span id="cb55-36"><a href="#cb55-36" aria-hidden="true" tabindex="-1"></a>                                </span>
<span id="cb55-37"><a href="#cb55-37" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> <span class="va">True</span>:                 </span>
<span id="cb55-38"><a href="#cb55-38" aria-hidden="true" tabindex="-1"></a>    datos[<span class="st">&#39;contactos&#39;</span>] <span class="op">=</span> datos[<span class="st">&#39;contactos&#39;</span>].mask(datos[<span class="st">&#39;contactos&#39;</span>] <span class="op">&gt;=</span> <span class="dv">4</span>, <span class="dv">4</span>)</span>
<span id="cb55-39"><a href="#cb55-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-40"><a href="#cb55-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-41"><a href="#cb55-41" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Anterior</span></span>
<span id="cb55-42"><a href="#cb55-42" aria-hidden="true" tabindex="-1"></a>  <span class="co"># --------</span></span>
<span id="cb55-43"><a href="#cb55-43" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Categoría 2 significa mayor a 2 días (reducimo categorías).</span></span>
<span id="cb55-44"><a href="#cb55-44" aria-hidden="true" tabindex="-1"></a>                                </span>
<span id="cb55-45"><a href="#cb55-45" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> <span class="va">True</span>:</span>
<span id="cb55-46"><a href="#cb55-46" aria-hidden="true" tabindex="-1"></a>   datos[<span class="st">&#39;anterior&#39;</span>] <span class="op">=</span> datos[<span class="st">&#39;anterior&#39;</span>].mask(datos[<span class="st">&#39;anterior&#39;</span>] <span class="op">&gt;=</span> <span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb55-47"><a href="#cb55-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-48"><a href="#cb55-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-49"><a href="#cb55-49" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ELIMINACIÓN DE VARIABLES CORRELACIONADAS/NO PREDICTORAS </span></span>
<span id="cb55-50"><a href="#cb55-50" aria-hidden="true" tabindex="-1"></a>  <span class="co"># =======================================================</span></span>
<span id="cb55-51"><a href="#cb55-51" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Según el análisis gráfico eliminamos 3 variables socioeconómicas, las</span></span>
<span id="cb55-52"><a href="#cb55-52" aria-hidden="true" tabindex="-1"></a>  <span class="co"># -- variables pres_viv, pres_per y la variable dia_sem</span></span>
<span id="cb55-53"><a href="#cb55-53" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb55-54"><a href="#cb55-54" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> <span class="va">True</span>:</span>
<span id="cb55-55"><a href="#cb55-55" aria-hidden="true" tabindex="-1"></a>    no_pred <span class="op">=</span> [</span>
<span id="cb55-56"><a href="#cb55-56" aria-hidden="true" tabindex="-1"></a>               <span class="st">&#39;euribor3m&#39;</span>,</span>
<span id="cb55-57"><a href="#cb55-57" aria-hidden="true" tabindex="-1"></a>               <span class="st">&#39;nr_employed&#39;</span>,</span>
<span id="cb55-58"><a href="#cb55-58" aria-hidden="true" tabindex="-1"></a>               <span class="st">&#39;pres_viv&#39;</span>,</span>
<span id="cb55-59"><a href="#cb55-59" aria-hidden="true" tabindex="-1"></a>               <span class="st">&#39;pres_per&#39;</span>,</span>
<span id="cb55-60"><a href="#cb55-60" aria-hidden="true" tabindex="-1"></a>               <span class="st">&#39;dia_sem&#39;</span>]</span>
<span id="cb55-61"><a href="#cb55-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-62"><a href="#cb55-62" aria-hidden="true" tabindex="-1"></a>    datos.drop(no_pred,</span>
<span id="cb55-63"><a href="#cb55-63" aria-hidden="true" tabindex="-1"></a>               axis    <span class="op">=</span> <span class="dv">1</span>,</span>
<span id="cb55-64"><a href="#cb55-64" aria-hidden="true" tabindex="-1"></a>               inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb55-65"><a href="#cb55-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-66"><a href="#cb55-66" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ELIMINACIÓN/CORRECCIÓN DE OUTLIERS (True/False)</span></span>
<span id="cb55-67"><a href="#cb55-67" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ==================================</span></span>
<span id="cb55-68"><a href="#cb55-68" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Educación</span></span>
<span id="cb55-69"><a href="#cb55-69" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ---------</span></span>
<span id="cb55-70"><a href="#cb55-70" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Dado que observamos empresarios y administrativos sin estudios </span></span>
<span id="cb55-71"><a href="#cb55-71" aria-hidden="true" tabindex="-1"></a>  <span class="co"># -- (ni siquiere básico),</span></span>
<span id="cb55-72"><a href="#cb55-72" aria-hidden="true" tabindex="-1"></a>  <span class="co"># -- vamos a reemplazarlo por desconocidos (luego se imputarán a lo que</span></span>
<span id="cb55-73"><a href="#cb55-73" aria-hidden="true" tabindex="-1"></a>  <span class="co"># -- corresponda)</span></span>
<span id="cb55-74"><a href="#cb55-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-75"><a href="#cb55-75" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> <span class="va">True</span>:</span>
<span id="cb55-76"><a href="#cb55-76" aria-hidden="true" tabindex="-1"></a>    condition <span class="op">=</span> ((datos[<span class="st">&#39;trabajo&#39;</span>]   <span class="op">==</span> <span class="st">&#39;empresario&#39;</span>)      <span class="op">|</span> <span class="op">\</span></span>
<span id="cb55-77"><a href="#cb55-77" aria-hidden="true" tabindex="-1"></a>                 (datos[<span class="st">&#39;trabajo&#39;</span>]   <span class="op">==</span> <span class="st">&#39;administrativo&#39;</span>)) <span class="op">&amp;</span> <span class="op">\</span></span>
<span id="cb55-78"><a href="#cb55-78" aria-hidden="true" tabindex="-1"></a>                 (datos[<span class="st">&#39;educacion&#39;</span>] <span class="op">==</span> <span class="st">&#39;no&#39;</span>)</span>
<span id="cb55-79"><a href="#cb55-79" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb55-80"><a href="#cb55-80" aria-hidden="true" tabindex="-1"></a>    datos[<span class="st">&#39;educacion&#39;</span>] <span class="op">=</span> np.where(</span>
<span id="cb55-81"><a href="#cb55-81" aria-hidden="true" tabindex="-1"></a>                                 (condition),</span>
<span id="cb55-82"><a href="#cb55-82" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&#39;desconocido&#39;</span>,</span>
<span id="cb55-83"><a href="#cb55-83" aria-hidden="true" tabindex="-1"></a>                                 datos[<span class="st">&#39;educacion&#39;</span>])</span>
<span id="cb55-84"><a href="#cb55-84" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb55-85"><a href="#cb55-85" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Default</span></span>
<span id="cb55-86"><a href="#cb55-86" aria-hidden="true" tabindex="-1"></a>  <span class="co"># -------</span></span>
<span id="cb55-87"><a href="#cb55-87" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Tenemos 1 solo registro con default = si,</span></span>
<span id="cb55-88"><a href="#cb55-88" aria-hidden="true" tabindex="-1"></a>  <span class="co"># --vamos a considerarlo como desconocido.</span></span>
<span id="cb55-89"><a href="#cb55-89" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb55-90"><a href="#cb55-90" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> <span class="va">True</span>:</span>
<span id="cb55-91"><a href="#cb55-91" aria-hidden="true" tabindex="-1"></a>    condition <span class="op">=</span> (datos[<span class="st">&#39;default&#39;</span>] <span class="op">==</span> <span class="st">&#39;si&#39;</span>)</span>
<span id="cb55-92"><a href="#cb55-92" aria-hidden="true" tabindex="-1"></a>    datos[<span class="st">&#39;default&#39;</span>] <span class="op">=</span> np.where(</span>
<span id="cb55-93"><a href="#cb55-93" aria-hidden="true" tabindex="-1"></a>                                (condition),</span>
<span id="cb55-94"><a href="#cb55-94" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&#39;desconocido&#39;</span>,</span>
<span id="cb55-95"><a href="#cb55-95" aria-hidden="true" tabindex="-1"></a>                                datos[<span class="st">&#39;default&#39;</span>])</span>
<span id="cb55-96"><a href="#cb55-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-97"><a href="#cb55-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-98"><a href="#cb55-98" aria-hidden="true" tabindex="-1"></a>  <span class="co"># IMPUTACIÓN DE VALORES DESCONOCIDOS</span></span>
<span id="cb55-99"><a href="#cb55-99" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ==================================</span></span>
<span id="cb55-100"><a href="#cb55-100" aria-hidden="true" tabindex="-1"></a>  <span class="co"># TRABAJO Y EDUCACION</span></span>
<span id="cb55-101"><a href="#cb55-101" aria-hidden="true" tabindex="-1"></a>  <span class="co"># -------------------</span></span>
<span id="cb55-102"><a href="#cb55-102" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Desconocidos, amas de casa y desempleados &gt; 64 --&gt; jubilados </span></span>
<span id="cb55-103"><a href="#cb55-103" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb55-104"><a href="#cb55-104" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Antes de cada imputación verifico que el resultado según las condiciones no</span></span>
<span id="cb55-105"><a href="#cb55-105" aria-hidden="true" tabindex="-1"></a>  <span class="co"># --sea vacío.</span></span>
<span id="cb55-106"><a href="#cb55-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-107"><a href="#cb55-107" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> <span class="va">True</span>:</span>
<span id="cb55-108"><a href="#cb55-108" aria-hidden="true" tabindex="-1"></a>    condition <span class="op">=</span> ((datos[<span class="st">&#39;trabajo&#39;</span>] <span class="op">==</span> <span class="st">&#39;desconocido&#39;</span>)  <span class="op">|</span> <span class="op">\</span></span>
<span id="cb55-109"><a href="#cb55-109" aria-hidden="true" tabindex="-1"></a>                 (datos[<span class="st">&#39;trabajo&#39;</span>] <span class="op">==</span> <span class="st">&#39;ama de casa&#39;</span>)  <span class="op">|</span> <span class="op">\</span></span>
<span id="cb55-110"><a href="#cb55-110" aria-hidden="true" tabindex="-1"></a>                 (datos[<span class="st">&#39;trabajo&#39;</span>] <span class="op">==</span> <span class="st">&#39;desempleado&#39;</span>))  <span class="op">&amp;</span> <span class="op">\</span></span>
<span id="cb55-111"><a href="#cb55-111" aria-hidden="true" tabindex="-1"></a>                 (datos[<span class="st">&#39;edad&#39;</span>]     <span class="op">&gt;</span>  <span class="dv">64</span>)</span>
<span id="cb55-112"><a href="#cb55-112" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb55-113"><a href="#cb55-113" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (datos[condition]).size <span class="op">&gt;</span> <span class="dv">0</span>:  </span>
<span id="cb55-114"><a href="#cb55-114" aria-hidden="true" tabindex="-1"></a>      datos[<span class="st">&#39;trabajo&#39;</span>] <span class="op">=</span> np.where((condition),</span>
<span id="cb55-115"><a href="#cb55-115" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">&#39;jubilado&#39;</span>,</span>
<span id="cb55-116"><a href="#cb55-116" aria-hidden="true" tabindex="-1"></a>                                  datos[<span class="st">&#39;trabajo&#39;</span>])</span>
<span id="cb55-117"><a href="#cb55-117" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb55-118"><a href="#cb55-118" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Desconocidos y &lt; 18 años --&gt; estudiantes</span></span>
<span id="cb55-119"><a href="#cb55-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-120"><a href="#cb55-120" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> <span class="va">True</span>:</span>
<span id="cb55-121"><a href="#cb55-121" aria-hidden="true" tabindex="-1"></a>    condition <span class="op">=</span> (datos[<span class="st">&#39;trabajo&#39;</span>] <span class="op">==</span> <span class="st">&#39;desconocido&#39;</span>)  <span class="op">&amp;</span>  <span class="op">\</span></span>
<span id="cb55-122"><a href="#cb55-122" aria-hidden="true" tabindex="-1"></a>                (datos[<span class="st">&#39;edad&#39;</span>]    <span class="op">&lt;=</span>  <span class="dv">18</span>)</span>
<span id="cb55-123"><a href="#cb55-123" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb55-124"><a href="#cb55-124" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (datos[condition]).size <span class="op">&gt;</span> <span class="dv">0</span>:  </span>
<span id="cb55-125"><a href="#cb55-125" aria-hidden="true" tabindex="-1"></a>      datos[<span class="st">&#39;trabajo&#39;</span>] <span class="op">=</span> np.where((condition),</span>
<span id="cb55-126"><a href="#cb55-126" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">&#39;estudiante&#39;</span>,</span>
<span id="cb55-127"><a href="#cb55-127" aria-hidden="true" tabindex="-1"></a>                                  datos[<span class="st">&#39;trabajo&#39;</span>])</span>
<span id="cb55-128"><a href="#cb55-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-129"><a href="#cb55-129" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Trabajo y Educacion (ambos desconocidos) -- &gt; se eliminan ya que voy a usar</span></span>
<span id="cb55-130"><a href="#cb55-130" aria-hidden="true" tabindex="-1"></a>  <span class="co"># -- uno para imputar el otro.</span></span>
<span id="cb55-131"><a href="#cb55-131" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb55-132"><a href="#cb55-132" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> <span class="va">False</span>: <span class="co"># True para train y test set / False para validaton set</span></span>
<span id="cb55-133"><a href="#cb55-133" aria-hidden="true" tabindex="-1"></a>    indice <span class="op">=</span> datos[(datos[<span class="st">&#39;trabajo&#39;</span>]   <span class="op">==</span> <span class="st">&#39;desconocido&#39;</span>) <span class="op">&amp;</span> <span class="op">\</span></span>
<span id="cb55-134"><a href="#cb55-134" aria-hidden="true" tabindex="-1"></a>                   (datos[<span class="st">&#39;educacion&#39;</span>] <span class="op">==</span> <span class="st">&#39;desconocido&#39;</span>)].index</span>
<span id="cb55-135"><a href="#cb55-135" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb55-136"><a href="#cb55-136" aria-hidden="true" tabindex="-1"></a>    datos.drop(datos.index[indice],</span>
<span id="cb55-137"><a href="#cb55-137" aria-hidden="true" tabindex="-1"></a>               inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb55-138"><a href="#cb55-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-139"><a href="#cb55-139" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Ya no tenemos desconocidos en trabajo y educación simultáneamente.</span></span>
<span id="cb55-140"><a href="#cb55-140" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Vamos a reemplazar los desconocidos en educación infiriendo a partir </span></span>
<span id="cb55-141"><a href="#cb55-141" aria-hidden="true" tabindex="-1"></a>  <span class="co"># --del tipo de trabajo.</span></span>
<span id="cb55-142"><a href="#cb55-142" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Utilizamos la máxima frecuencia, por ejemplo para administrativo -- &gt; universitario, luego</span></span>
<span id="cb55-143"><a href="#cb55-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-144"><a href="#cb55-144" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> <span class="va">True</span>:</span>
<span id="cb55-145"><a href="#cb55-145" aria-hidden="true" tabindex="-1"></a>    jobs <span class="op">=</span> datos[<span class="st">&#39;trabajo&#39;</span>].unique()</span>
<span id="cb55-146"><a href="#cb55-146" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb55-147"><a href="#cb55-147" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> job <span class="kw">in</span> jobs:</span>
<span id="cb55-148"><a href="#cb55-148" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb55-149"><a href="#cb55-149" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Obtenemos la categoría de educación más frecuente para cada tipo de trabajo</span></span>
<span id="cb55-150"><a href="#cb55-150" aria-hidden="true" tabindex="-1"></a>      max_freq_job <span class="op">=</span> datos[datos[<span class="st">&#39;trabajo&#39;</span>] <span class="op">==</span> job][<span class="st">&#39;educacion&#39;</span>] <span class="op">\</span></span>
<span id="cb55-151"><a href="#cb55-151" aria-hidden="true" tabindex="-1"></a>                                .value_counts().index[<span class="dv">0</span>]</span>
<span id="cb55-152"><a href="#cb55-152" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb55-153"><a href="#cb55-153" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Reemplazamos la categoria desconocido de la educacion por la más frecuente</span></span>
<span id="cb55-154"><a href="#cb55-154" aria-hidden="true" tabindex="-1"></a>      condition <span class="op">=</span> (datos[<span class="st">&#39;educacion&#39;</span>] <span class="op">==</span> <span class="st">&#39;desconocido&#39;</span>) <span class="op">&amp;</span> <span class="op">\</span></span>
<span id="cb55-155"><a href="#cb55-155" aria-hidden="true" tabindex="-1"></a>                  (datos[<span class="st">&#39;trabajo&#39;</span>]   <span class="op">==</span> job)</span>
<span id="cb55-156"><a href="#cb55-156" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb55-157"><a href="#cb55-157" aria-hidden="true" tabindex="-1"></a>      datos[<span class="st">&#39;educacion&#39;</span>] <span class="op">=</span> np.where(</span>
<span id="cb55-158"><a href="#cb55-158" aria-hidden="true" tabindex="-1"></a>                                   (condition) ,</span>
<span id="cb55-159"><a href="#cb55-159" aria-hidden="true" tabindex="-1"></a>                                   max_freq_job,</span>
<span id="cb55-160"><a href="#cb55-160" aria-hidden="true" tabindex="-1"></a>                                   datos[<span class="st">&#39;educacion&#39;</span>])</span>
<span id="cb55-161"><a href="#cb55-161" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb55-162"><a href="#cb55-162" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Ahora imputamos los tipos de trabajo con el procedimiento inverso al anterior.</span></span>
<span id="cb55-163"><a href="#cb55-163" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb55-164"><a href="#cb55-164" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> <span class="va">True</span>:</span>
<span id="cb55-165"><a href="#cb55-165" aria-hidden="true" tabindex="-1"></a>    studies <span class="op">=</span> datos[<span class="st">&#39;educacion&#39;</span>].unique()</span>
<span id="cb55-166"><a href="#cb55-166" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb55-167"><a href="#cb55-167" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> std <span class="kw">in</span> studies:</span>
<span id="cb55-168"><a href="#cb55-168" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb55-169"><a href="#cb55-169" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Obtenemos la categoría de trabajo más frecuente para cada tipo de educación</span></span>
<span id="cb55-170"><a href="#cb55-170" aria-hidden="true" tabindex="-1"></a>      max_freq_std <span class="op">=</span> datos[datos[<span class="st">&#39;educacion&#39;</span>] <span class="op">==</span> std][<span class="st">&#39;trabajo&#39;</span>] <span class="op">\</span></span>
<span id="cb55-171"><a href="#cb55-171" aria-hidden="true" tabindex="-1"></a>                                .value_counts().index[<span class="dv">0</span>]</span>
<span id="cb55-172"><a href="#cb55-172" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb55-173"><a href="#cb55-173" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Reemplazamos la categoria desconocida del trabajo por la más frecuente</span></span>
<span id="cb55-174"><a href="#cb55-174" aria-hidden="true" tabindex="-1"></a>      condition <span class="op">=</span> (datos[<span class="st">&#39;trabajo&#39;</span>]   <span class="op">==</span> <span class="st">&#39;desconocido&#39;</span>) <span class="op">&amp;</span> <span class="op">\</span></span>
<span id="cb55-175"><a href="#cb55-175" aria-hidden="true" tabindex="-1"></a>                  (datos[<span class="st">&#39;educacion&#39;</span>] <span class="op">==</span>  std)</span>
<span id="cb55-176"><a href="#cb55-176" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb55-177"><a href="#cb55-177" aria-hidden="true" tabindex="-1"></a>      datos[<span class="st">&#39;trabajo&#39;</span>] <span class="op">=</span> np.where(</span>
<span id="cb55-178"><a href="#cb55-178" aria-hidden="true" tabindex="-1"></a>                                   (condition),</span>
<span id="cb55-179"><a href="#cb55-179" aria-hidden="true" tabindex="-1"></a>                                   max_freq_std,</span>
<span id="cb55-180"><a href="#cb55-180" aria-hidden="true" tabindex="-1"></a>                                   datos[<span class="st">&#39;trabajo&#39;</span>])</span>
<span id="cb55-181"><a href="#cb55-181" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb55-182"><a href="#cb55-182" aria-hidden="true" tabindex="-1"></a>   <span class="co"># Ya no quedan desconocidos en trabajo.</span></span>
<span id="cb55-183"><a href="#cb55-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-184"><a href="#cb55-184" aria-hidden="true" tabindex="-1"></a>   <span class="co"># ESTADO CIVIL</span></span>
<span id="cb55-185"><a href="#cb55-185" aria-hidden="true" tabindex="-1"></a>   <span class="co"># ------------</span></span>
<span id="cb55-186"><a href="#cb55-186" aria-hidden="true" tabindex="-1"></a>   <span class="co"># Vamos a imputar el estado civil a partir de la frecuencia por rango de edades.</span></span>
<span id="cb55-187"><a href="#cb55-187" aria-hidden="true" tabindex="-1"></a>   <span class="co"># Creamos una varibale nueva solo para obtener frecuencias por rangos de edad. Luego la elimino.</span></span>
<span id="cb55-188"><a href="#cb55-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-189"><a href="#cb55-189" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> <span class="va">True</span>:</span>
<span id="cb55-190"><a href="#cb55-190" aria-hidden="true" tabindex="-1"></a>    bins <span class="op">=</span> [<span class="dv">18</span>, <span class="dv">25</span>, <span class="dv">35</span>, <span class="dv">45</span>, <span class="dv">55</span>, <span class="dv">65</span>, <span class="dv">98</span>]</span>
<span id="cb55-191"><a href="#cb55-191" aria-hidden="true" tabindex="-1"></a>    rangos <span class="op">=</span> [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>]</span>
<span id="cb55-192"><a href="#cb55-192" aria-hidden="true" tabindex="-1"></a>    datos[<span class="st">&#39;edad_rango&#39;</span>] <span class="op">=</span> pd.cut(datos[<span class="st">&#39;edad&#39;</span>],</span>
<span id="cb55-193"><a href="#cb55-193" aria-hidden="true" tabindex="-1"></a>                                 bins   <span class="op">=</span> bins,</span>
<span id="cb55-194"><a href="#cb55-194" aria-hidden="true" tabindex="-1"></a>                                 labels <span class="op">=</span> rangos,</span>
<span id="cb55-195"><a href="#cb55-195" aria-hidden="true" tabindex="-1"></a>                                 right  <span class="op">=</span> <span class="va">False</span>)</span>
<span id="cb55-196"><a href="#cb55-196" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb55-197"><a href="#cb55-197" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> age <span class="kw">in</span> rangos:</span>
<span id="cb55-198"><a href="#cb55-198" aria-hidden="true" tabindex="-1"></a>      max_freq_age <span class="op">=</span> datos[datos[<span class="st">&#39;edad_rango&#39;</span>] <span class="op">==</span> age][<span class="st">&#39;est_civ&#39;</span>] <span class="op">\</span></span>
<span id="cb55-199"><a href="#cb55-199" aria-hidden="true" tabindex="-1"></a>                                .value_counts().index[<span class="dv">0</span>]</span>
<span id="cb55-200"><a href="#cb55-200" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb55-201"><a href="#cb55-201" aria-hidden="true" tabindex="-1"></a>      condition <span class="op">=</span> (datos[<span class="st">&#39;est_civ&#39;</span>]    <span class="op">==</span> <span class="st">&#39;desconocido&#39;</span>) <span class="op">&amp;</span> <span class="op">\</span></span>
<span id="cb55-202"><a href="#cb55-202" aria-hidden="true" tabindex="-1"></a>                  (datos[<span class="st">&#39;edad_rango&#39;</span>] <span class="op">==</span>  age)</span>
<span id="cb55-203"><a href="#cb55-203" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb55-204"><a href="#cb55-204" aria-hidden="true" tabindex="-1"></a>      datos[<span class="st">&#39;est_civ&#39;</span>] <span class="op">=</span> np.where(</span>
<span id="cb55-205"><a href="#cb55-205" aria-hidden="true" tabindex="-1"></a>                                  (condition),</span>
<span id="cb55-206"><a href="#cb55-206" aria-hidden="true" tabindex="-1"></a>                                  max_freq_age,</span>
<span id="cb55-207"><a href="#cb55-207" aria-hidden="true" tabindex="-1"></a>                                  datos[<span class="st">&#39;est_civ&#39;</span>])</span>
<span id="cb55-208"><a href="#cb55-208" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb55-209"><a href="#cb55-209" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Eliminamos la columna de rango de edades</span></span>
<span id="cb55-210"><a href="#cb55-210" aria-hidden="true" tabindex="-1"></a>    datos.drop([<span class="st">&#39;edad_rango&#39;</span>],</span>
<span id="cb55-211"><a href="#cb55-211" aria-hidden="true" tabindex="-1"></a>               axis    <span class="op">=</span> <span class="dv">1</span>,</span>
<span id="cb55-212"><a href="#cb55-212" aria-hidden="true" tabindex="-1"></a>               inplace <span class="op">=</span> <span class="va">True</span>,</span>
<span id="cb55-213"><a href="#cb55-213" aria-hidden="true" tabindex="-1"></a>               errors  <span class="op">=</span> <span class="st">&#39;ignore&#39;</span>)</span>
<span id="cb55-214"><a href="#cb55-214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-215"><a href="#cb55-215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-216"><a href="#cb55-216" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ELIMINACIÓN REGISTROS DUPLICADOS</span></span>
<span id="cb55-217"><a href="#cb55-217" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ================================</span></span>
<span id="cb55-218"><a href="#cb55-218" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb55-219"><a href="#cb55-219" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> <span class="va">False</span>: <span class="co"># True para train y test set / False para validaton set</span></span>
<span id="cb55-220"><a href="#cb55-220" aria-hidden="true" tabindex="-1"></a>    datos.drop_duplicates(inplace      <span class="op">=</span> <span class="va">True</span>,</span>
<span id="cb55-221"><a href="#cb55-221" aria-hidden="true" tabindex="-1"></a>                          ignore_index <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb55-222"><a href="#cb55-222" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb55-223"><a href="#cb55-223" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Convertimos las columnas a categóricas</span></span>
<span id="cb55-224"><a href="#cb55-224" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ======================================</span></span>
<span id="cb55-225"><a href="#cb55-225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-226"><a href="#cb55-226" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> <span class="va">True</span>:</span>
<span id="cb55-227"><a href="#cb55-227" aria-hidden="true" tabindex="-1"></a>    cols <span class="op">=</span> datos.select_dtypes(<span class="st">&#39;object&#39;</span>).columns.to_list()</span>
<span id="cb55-228"><a href="#cb55-228" aria-hidden="true" tabindex="-1"></a>    datos[cols] <span class="op">=</span> datos[cols].astype(<span class="st">&#39;category&#39;</span>)</span></code></pre></div>
<p> </p>
</div>
</div>
<div id="métrica-de-evaluación" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Métrica de Evaluación</h1>
<p>Para poder calcular el costo/beneficio de la campaña de marketing se fijaron los siguientes parámetros:</p>
<ul>
<li><p>Para el caso de las llamadas fallidas se definió un costo unitario de 440 unidades monetarias (UM). Estas llamadas son más cortas que las exitosas, debido a que la mayoría de los clientes no aceptan el producto ofrecido de inmediato y otros terminan decidiendo rechazar la propuesta en llamados subsiguientes.</p></li>
<li><p>En el caso de una llamada exitosa (se vende el producto) la mediana del tiempo de contacto con el potencial comprador es mayor, también requiere incurrir en gastos administrativos y de asesoramiento extra. A partir de datos pasados en donde se calculó la ganancia después de impuestos y gastos utilizando el monto promedio invertido se obtuvo que cada llamada exitosa le dejaba a la empresa 2900 UM.</p></li>
<li><p>Es importante mencionar que se premiaba la detección de clientes que no eran contactados por ser considerados como negativos. Esta premiación está asociada a diferentes costos de oportunidad, tanto de la contratación/tercerización de empleados/consultoría de Data Science, como también a la contratación de empresas de tele-marketing y la consecuente capacitación técnica del equipo del call center para una atención acorde a las particularidades y complejidades de la situación, incrementando así los costos contractuales con la empresa tercerizada. Por estos motivos, se le asignó una ganancia de 200 UM a la detección de clientes a los que no se debe ofrecer el producto. .</p></li>
</ul>
<p>A partir de esta información construimos una matriz de costo/beneficio con la cual es posible monetizar el resultado del modelo de clasificación.</p>
<table>
<thead>
<tr class="header">
<th></th>
<th>Llamada Exitosa (E)</th>
<th>Llamada Fallida (F)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Llamada Realizada (R)</td>
<td>2900</td>
<td>-440</td>
</tr>
<tr class="even">
<td>Llamada No Realizada (NR)</td>
<td>0</td>
<td>200</td>
</tr>
</tbody>
</table>
<p> </p>
</div>
<div id="preprocesado" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Preprocesado</h1>
<p>El primer paso fue llamar a la función cleaner/imputer para aplicar la estrategia de limpieza y transformación de datos utilizados para el train y para el test del modelo.</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>cleaner(train)</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>cleaner(test)</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(train.shape)</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(test.shape)</span></code></pre></div>
<pre><code>(27920, 16)
(6983, 16)</code></pre>
<div class="sourceCode" id="cb58"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>train.head()</span></code></pre></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<div style="overflow-x:auto;">
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th>
</th>
<th>
index
</th>
<th>
edad
</th>
<th>
trabajo
</th>
<th>
est_civ
</th>
<th>
educacion
</th>
<th>
default
</th>
<th>
contacto
</th>
<th>
mes
</th>
<th>
contactos
</th>
<th>
dias
</th>
<th>
anterior
</th>
<th>
res_ant
</th>
<th>
emp_var_rate
</th>
<th>
cons_price_idx
</th>
<th>
cons_conf_idx
</th>
<th>
y
</th>
</tr>
</thead>
<tbody>
<tr>
<th>
0
</th>
<td>
20877
</td>
<td>
30
</td>
<td>
administrativo
</td>
<td>
casado
</td>
<td>
primaria
</td>
<td>
no
</td>
<td>
celular
</td>
<td>
jul
</td>
<td>
1
</td>
<td>
0
</td>
<td>
0
</td>
<td>
inexistente
</td>
<td>
1.4
</td>
<td>
93.918
</td>
<td>
-42.7
</td>
<td>
0
</td>
</tr>
<tr>
<th>
1
</th>
<td>
12729
</td>
<td>
40
</td>
<td>
tecnico
</td>
<td>
casado
</td>
<td>
curso
</td>
<td>
no
</td>
<td>
celular
</td>
<td>
ago
</td>
<td>
2
</td>
<td>
0
</td>
<td>
0
</td>
<td>
inexistente
</td>
<td>
1.4
</td>
<td>
93.444
</td>
<td>
-36.1
</td>
<td>
0
</td>
</tr>
<tr>
<th>
2
</th>
<td>
8374
</td>
<td>
33
</td>
<td>
servicios
</td>
<td>
casado
</td>
<td>
secundario
</td>
<td>
no
</td>
<td>
celular
</td>
<td>
jul
</td>
<td>
4
</td>
<td>
0
</td>
<td>
0
</td>
<td>
inexistente
</td>
<td>
1.4
</td>
<td>
93.918
</td>
<td>
-42.7
</td>
<td>
0
</td>
</tr>
<tr>
<th>
3
</th>
<td>
16409
</td>
<td>
59
</td>
<td>
jubilado
</td>
<td>
casado
</td>
<td>
curso
</td>
<td>
no
</td>
<td>
telefono
</td>
<td>
may
</td>
<td>
3
</td>
<td>
0
</td>
<td>
0
</td>
<td>
inexistente
</td>
<td>
1.1
</td>
<td>
93.994
</td>
<td>
-36.4
</td>
<td>
0
</td>
</tr>
<tr>
<th>
4
</th>
<td>
24307
</td>
<td>
50
</td>
<td>
gerente
</td>
<td>
divorciado
</td>
<td>
universitario
</td>
<td>
no
</td>
<td>
celular
</td>
<td>
nov
</td>
<td>
4
</td>
<td>
0
</td>
<td>
0
</td>
<td>
inexistente
</td>
<td>
-0.1
</td>
<td>
93.200
</td>
<td>
-42.0
</td>
<td>
0
</td>
</tr>
</tbody>
</table>
</div>
<p>Luego volvimos a separar las variables predictivas de la variable objetivo para poder introducirlos en el modelo.</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Separamos los sets de entrenamiento y testeo</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>X_train <span class="op">=</span> train.drop([<span class="st">&#39;y&#39;</span>, <span class="st">&#39;index&#39;</span>], axis <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>y_train <span class="op">=</span> train[<span class="st">&#39;y&#39;</span>]</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>X_test <span class="op">=</span> test.drop([<span class="st">&#39;y&#39;</span>, <span class="st">&#39;index&#39;</span>], axis <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>y_test <span class="op">=</span> test[<span class="st">&#39;y&#39;</span>]</span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(X_train.shape)</span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(y_train.shape)</span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(X_test.shape)</span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(y_test.shape)</span></code></pre></div>
<pre><code>(27920, 14)
(27920,)
(6983, 14)
(6983,)</code></pre>
<p>También realizamos una estandarización de las variables numéricas y un one hot encoding a las categóricas.</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co"># One Hot Encoding y Estandarización</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a><span class="co"># =================================</span></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>numeric_cols <span class="op">=</span> X_train.select_dtypes(include <span class="op">=</span> [<span class="st">&#39;float64&#39;</span>, <span class="st">&#39;int64&#39;</span>]) <span class="op">\</span></span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>                  .columns.to_list()</span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>cat_cols <span class="op">=</span> X_train.select_dtypes(include<span class="op">=</span>[<span class="st">&#39;object&#39;</span>, <span class="st">&#39;category&#39;</span>]) <span class="op">\</span></span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>                  .columns.to_list()</span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a>preprocessor <span class="op">=</span> ColumnTransformer(</span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a>                       [</span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a>                        (<span class="st">&#39;scale&#39;</span>, StandardScaler(), numeric_cols),</span>
<span id="cb61-12"><a href="#cb61-12" aria-hidden="true" tabindex="-1"></a>                        (<span class="st">&#39;onehot&#39;</span>, OneHotEncoder(), cat_cols)],</span>
<span id="cb61-13"><a href="#cb61-13" aria-hidden="true" tabindex="-1"></a>                    remainder <span class="op">=</span> <span class="st">&#39;passthrough&#39;</span>)</span>
<span id="cb61-14"><a href="#cb61-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb61-15"><a href="#cb61-15" aria-hidden="true" tabindex="-1"></a>X_train <span class="op">=</span> preprocessor.fit_transform(X_train)</span>
<span id="cb61-16"><a href="#cb61-16" aria-hidden="true" tabindex="-1"></a>X_test  <span class="op">=</span> preprocessor.transform(X_test)</span></code></pre></div>
<p> </p>
</div>
<div id="modelado" class="section level1" number="9">
<h1><span class="header-section-number">9</span> Modelado</h1>
<p>Desarrollamos diferentes modelos de clasificación binaria utilizando algoritmos de Regresión Logística, Árboles de Decisión, Random Forest, Support Vector Machine y Ensambles. Finalmente, el modelo que arrojó los mejores resultados según la métrica fue el Random Forest Classifier.</p>
<p>Para el entrenamiento de estos modelos utilizamos la función GridSearchCv de la librería Scikit Learn con una estrategia de 5 fold cross validation definiendo una función custom scorer como regla de optimización. En esta función se introdujeron los coeficientes de ganancias y perdidas de la matriz de beneficio y se la configuró a modo de maximizar el beneficio esperado.</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Función de la matriz de costo/beneficio</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="co"># =======================================</span></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> benefitmatrix_score(y_true, y_pred):</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>    tn, fp, fn, tp <span class="op">=</span> confusion_matrix(y_true,</span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>                                      y_pred).ravel()</span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (<span class="dv">200</span> <span class="op">*</span> tn <span class="op">+</span> <span class="dv">2900</span> <span class="op">*</span> tp <span class="op">+</span> (<span class="op">-</span><span class="dv">440</span>) <span class="op">*</span> fp) <span class="op">/</span> <span class="bu">len</span>(y_true)</span></code></pre></div>
<div class="sourceCode" id="cb63"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Entrenamiento y búsqueda de los mejores hiperpaámetros</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="co"># ======================================================</span></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>n_estimators     <span class="op">=</span> [<span class="dv">150</span>, <span class="dv">300</span>, <span class="dv">400</span>]</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>max_depth        <span class="op">=</span> [<span class="dv">7</span>, <span class="dv">11</span>, <span class="dv">15</span>]</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>min_samples_leaf <span class="op">=</span> [<span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">15</span>]</span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>max_features     <span class="op">=</span> [<span class="st">&#39;sqrt&#39;</span>, <span class="st">&#39;auto&#39;</span>]</span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>bootstrap        <span class="op">=</span> [<span class="va">True</span>, <span class="va">False</span>]</span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a>hyperparametros <span class="op">=</span> <span class="bu">dict</span>(</span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a>                       n_estimators     <span class="op">=</span> n_estimators, </span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a>                       min_samples_leaf <span class="op">=</span> min_samples_leaf,</span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a>                       max_depth        <span class="op">=</span> max_depth,</span>
<span id="cb63-13"><a href="#cb63-13" aria-hidden="true" tabindex="-1"></a>                       max_features     <span class="op">=</span> max_features,</span>
<span id="cb63-14"><a href="#cb63-14" aria-hidden="true" tabindex="-1"></a>                       bootstrap        <span class="op">=</span> bootstrap</span>
<span id="cb63-15"><a href="#cb63-15" aria-hidden="true" tabindex="-1"></a>                       )</span>
<span id="cb63-16"><a href="#cb63-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-17"><a href="#cb63-17" aria-hidden="true" tabindex="-1"></a>rfc_model <span class="op">=</span> RandomForestClassifier(class_weight <span class="op">=</span> <span class="st">&#39;balanced&#39;</span>,</span>
<span id="cb63-18"><a href="#cb63-18" aria-hidden="true" tabindex="-1"></a>                                   random_state <span class="op">=</span>  <span class="dv">42</span>)</span>
<span id="cb63-19"><a href="#cb63-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-20"><a href="#cb63-20" aria-hidden="true" tabindex="-1"></a>custom_scorer <span class="op">=</span> {<span class="st">&quot;Matriz_de_beneficio&quot;</span> : </span>
<span id="cb63-21"><a href="#cb63-21" aria-hidden="true" tabindex="-1"></a>                 make_scorer(benefitmatrix_score, greater_is_better <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb63-22"><a href="#cb63-22" aria-hidden="true" tabindex="-1"></a>                 }</span>
<span id="cb63-23"><a href="#cb63-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-24"><a href="#cb63-24" aria-hidden="true" tabindex="-1"></a>clf <span class="op">=</span> GridSearchCV(rfc_model,</span>
<span id="cb63-25"><a href="#cb63-25" aria-hidden="true" tabindex="-1"></a>                   hyperparametros,</span>
<span id="cb63-26"><a href="#cb63-26" aria-hidden="true" tabindex="-1"></a>                   cv                 <span class="op">=</span> <span class="dv">5</span>,</span>
<span id="cb63-27"><a href="#cb63-27" aria-hidden="true" tabindex="-1"></a>                   verbose            <span class="op">=</span> <span class="dv">4</span>,</span>
<span id="cb63-28"><a href="#cb63-28" aria-hidden="true" tabindex="-1"></a>                   scoring            <span class="op">=</span> custom_scorer,</span>
<span id="cb63-29"><a href="#cb63-29" aria-hidden="true" tabindex="-1"></a>                   n_jobs             <span class="op">=</span> <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb63-30"><a href="#cb63-30" aria-hidden="true" tabindex="-1"></a>                   refit              <span class="op">=</span> <span class="st">&quot;Matriz_de_beneficio&quot;</span>,</span>
<span id="cb63-31"><a href="#cb63-31" aria-hidden="true" tabindex="-1"></a>                   return_train_score <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb63-32"><a href="#cb63-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-33"><a href="#cb63-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Entrenamiento</span></span>
<span id="cb63-34"><a href="#cb63-34" aria-hidden="true" tabindex="-1"></a>rfc_model <span class="op">=</span> clf.fit(X_train, y_train)</span>
<span id="cb63-35"><a href="#cb63-35" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;----------------------------------------&quot;</span>)</span>
<span id="cb63-36"><a href="#cb63-36" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Mejores hiperparámetros encontrados (cv)&quot;</span>)</span>
<span id="cb63-37"><a href="#cb63-37" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;----------------------------------------&quot;</span>)</span>
<span id="cb63-38"><a href="#cb63-38" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(rfc_model.best_params_)</span>
<span id="cb63-39"><a href="#cb63-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-40"><a href="#cb63-40" aria-hidden="true" tabindex="-1"></a><span class="co"># Predicciones</span></span>
<span id="cb63-41"><a href="#cb63-41" aria-hidden="true" tabindex="-1"></a>y_pred <span class="op">=</span> rfc_model.predict(X_test)</span>
<span id="cb63-42"><a href="#cb63-42" aria-hidden="true" tabindex="-1"></a>plot_confusion_matrix(algoritmo, X_train, y_train,normalize<span class="op">=</span><span class="st">&#39;true&#39;</span>)</span>
<span id="cb63-43"><a href="#cb63-43" aria-hidden="true" tabindex="-1"></a>plot_confusion_matrix(algoritmo,</span>
<span id="cb63-44"><a href="#cb63-44" aria-hidden="true" tabindex="-1"></a>                          X_test,</span>
<span id="cb63-45"><a href="#cb63-45" aria-hidden="true" tabindex="-1"></a>                          y_test,</span>
<span id="cb63-46"><a href="#cb63-46" aria-hidden="true" tabindex="-1"></a>                          values_format  <span class="op">=</span> <span class="st">&#39;d&#39;</span>)</span>
<span id="cb63-47"><a href="#cb63-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-48"><a href="#cb63-48" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;--------------------------------------------&#39;</span>)</span>
<span id="cb63-49"><a href="#cb63-49" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Beneficio Esperado (train): &quot;</span>, rfc_model.score(X_train, y_train))</span>
<span id="cb63-50"><a href="#cb63-50" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Beneficio Esperado (test): &quot;</span>, rfc_model.score(X_test, y_test))</span>
<span id="cb63-51"><a href="#cb63-51" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;--------------------------------------------&#39;</span>)</span>
<span id="cb63-52"><a href="#cb63-52" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(classification_report(y_test, y_pred))</span>
<span id="cb63-53"><a href="#cb63-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-54"><a href="#cb63-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-55"><a href="#cb63-55" aria-hidden="true" tabindex="-1"></a>    Fitting <span class="dv">5</span> folds <span class="cf">for</span> each of <span class="dv">108</span> candidates, totalling <span class="dv">540</span> fits</span>
<span id="cb63-56"><a href="#cb63-56" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb63-57"><a href="#cb63-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-58"><a href="#cb63-58" aria-hidden="true" tabindex="-1"></a>    [Parallel(n_jobs<span class="op">=-</span><span class="dv">1</span>)]: Using backend LokyBackend <span class="cf">with</span> <span class="dv">4</span> concurrent workers.</span>
<span id="cb63-59"><a href="#cb63-59" aria-hidden="true" tabindex="-1"></a>    [Parallel(n_jobs<span class="op">=-</span><span class="dv">1</span>)]: Done  <span class="dv">17</span> tasks      <span class="op">|</span> elapsed:  <span class="fl">1.2</span>min</span>
<span id="cb63-60"><a href="#cb63-60" aria-hidden="true" tabindex="-1"></a>    [Parallel(n_jobs<span class="op">=-</span><span class="dv">1</span>)]: Done  <span class="dv">90</span> tasks      <span class="op">|</span> elapsed:  <span class="fl">6.2</span>min</span>
<span id="cb63-61"><a href="#cb63-61" aria-hidden="true" tabindex="-1"></a>    [Parallel(n_jobs<span class="op">=-</span><span class="dv">1</span>)]: Done <span class="dv">213</span> tasks      <span class="op">|</span> elapsed: <span class="fl">16.3</span>min</span>
<span id="cb63-62"><a href="#cb63-62" aria-hidden="true" tabindex="-1"></a>    [Parallel(n_jobs<span class="op">=-</span><span class="dv">1</span>)]: Done <span class="dv">384</span> tasks      <span class="op">|</span> elapsed: <span class="fl">30.9</span>min</span>
<span id="cb63-63"><a href="#cb63-63" aria-hidden="true" tabindex="-1"></a>    [Parallel(n_jobs<span class="op">=-</span><span class="dv">1</span>)]: Done <span class="dv">540</span> out of <span class="dv">540</span> <span class="op">|</span> elapsed: <span class="fl">49.3</span>min finished</span>
<span id="cb63-64"><a href="#cb63-64" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb63-65"><a href="#cb63-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-66"><a href="#cb63-66" aria-hidden="true" tabindex="-1"></a>    <span class="op">----------------------------------------</span></span>
<span id="cb63-67"><a href="#cb63-67" aria-hidden="true" tabindex="-1"></a>    Mejores hiperparámetros encontrados (cv)</span>
<span id="cb63-68"><a href="#cb63-68" aria-hidden="true" tabindex="-1"></a>    <span class="op">----------------------------------------</span></span>
<span id="cb63-69"><a href="#cb63-69" aria-hidden="true" tabindex="-1"></a>    {<span class="st">&#39;bootstrap&#39;</span>       : <span class="va">True</span>,</span>
<span id="cb63-70"><a href="#cb63-70" aria-hidden="true" tabindex="-1"></a>     <span class="st">&#39;max_depth&#39;</span>       : <span class="dv">15</span>,</span>
<span id="cb63-71"><a href="#cb63-71" aria-hidden="true" tabindex="-1"></a>     <span class="st">&#39;max_features&#39;</span>    : <span class="st">&#39;sqrt&#39;</span>,</span>
<span id="cb63-72"><a href="#cb63-72" aria-hidden="true" tabindex="-1"></a>     <span class="st">&#39;min_samples_leaf&#39;</span>: <span class="dv">5</span>,</span>
<span id="cb63-73"><a href="#cb63-73" aria-hidden="true" tabindex="-1"></a>     <span class="st">&#39;n_estimators&#39;</span>    : <span class="dv">300</span>}</span>
<span id="cb63-74"><a href="#cb63-74" aria-hidden="true" tabindex="-1"></a>     </span>
<span id="cb63-75"><a href="#cb63-75" aria-hidden="true" tabindex="-1"></a>    <span class="op">--------------------------------------------</span></span>
<span id="cb63-76"><a href="#cb63-76" aria-hidden="true" tabindex="-1"></a>    Beneficio Esperado (train):  <span class="fl">327.8137535816619</span></span>
<span id="cb63-77"><a href="#cb63-77" aria-hidden="true" tabindex="-1"></a>    Beneficio Esperado (test):  <span class="fl">307.45238436202203</span></span>
<span id="cb63-78"><a href="#cb63-78" aria-hidden="true" tabindex="-1"></a>    <span class="op">--------------------------------------------</span></span>
<span id="cb63-79"><a href="#cb63-79" aria-hidden="true" tabindex="-1"></a>                  precision    recall  f1<span class="op">-</span>score   support</span>
<span id="cb63-80"><a href="#cb63-80" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb63-81"><a href="#cb63-81" aria-hidden="true" tabindex="-1"></a>               <span class="dv">0</span>       <span class="fl">0.95</span>      <span class="fl">0.88</span>      <span class="fl">0.91</span>      <span class="dv">6199</span></span>
<span id="cb63-82"><a href="#cb63-82" aria-hidden="true" tabindex="-1"></a>               <span class="dv">1</span>       <span class="fl">0.39</span>      <span class="fl">0.61</span>      <span class="fl">0.48</span>       <span class="dv">784</span></span>
<span id="cb63-83"><a href="#cb63-83" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb63-84"><a href="#cb63-84" aria-hidden="true" tabindex="-1"></a>        accuracy                           <span class="fl">0.85</span>      <span class="dv">6983</span></span>
<span id="cb63-85"><a href="#cb63-85" aria-hidden="true" tabindex="-1"></a>       macro avg       <span class="fl">0.67</span>      <span class="fl">0.74</span>      <span class="fl">0.69</span>      <span class="dv">6983</span></span>
<span id="cb63-86"><a href="#cb63-86" aria-hidden="true" tabindex="-1"></a>    weighted avg       <span class="fl">0.88</span>      <span class="fl">0.85</span>      <span class="fl">0.86</span>      <span class="dv">6983</span></span>
<span id="cb63-87"><a href="#cb63-87" aria-hidden="true" tabindex="-1"></a>    </span></code></pre></div>
<p><img src="/img/tp_uba/output_124_3.png" /></p>
<p><img src="/img/tp_uba/output_124_4.png" /></p>
<div class="sourceCode" id="cb64"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Guardamos en una lista los nombres de los parametros</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>masks <span class="op">=</span> []</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>masks_names <span class="op">=</span> <span class="bu">list</span>(clf.best_params_.keys())</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> p_k, p_v <span class="kw">in</span> clf.best_params_.items():</span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>  masks.append(<span class="bu">list</span>(results[<span class="st">&#39;param_&#39;</span><span class="op">+</span> p_k].data <span class="op">==</span> p_v))</span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>params <span class="op">=</span> clf.param_grid</span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Resultados del grid search</span></span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a>results     <span class="op">=</span> clf.cv_results_</span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a>means_test  <span class="op">=</span> results[<span class="st">&#39;mean_test_Matriz_de_beneficio&#39;</span>]</span>
<span id="cb64-12"><a href="#cb64-12" aria-hidden="true" tabindex="-1"></a>stds_test   <span class="op">=</span> results[<span class="st">&#39;std_test_Matriz_de_beneficio&#39;</span>]</span>
<span id="cb64-13"><a href="#cb64-13" aria-hidden="true" tabindex="-1"></a>means_train <span class="op">=</span> results[<span class="st">&#39;mean_train_Matriz_de_beneficio&#39;</span>]</span>
<span id="cb64-14"><a href="#cb64-14" aria-hidden="true" tabindex="-1"></a>stds_train  <span class="op">=</span> results[<span class="st">&#39;std_train_Matriz_de_beneficio&#39;</span>]</span>
<span id="cb64-15"><a href="#cb64-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-16"><a href="#cb64-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-17"><a href="#cb64-17" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(nrows   <span class="op">=</span> <span class="dv">3</span>,</span>
<span id="cb64-18"><a href="#cb64-18" aria-hidden="true" tabindex="-1"></a>                       ncols   <span class="op">=</span> <span class="dv">2</span>,</span>
<span id="cb64-19"><a href="#cb64-19" aria-hidden="true" tabindex="-1"></a>                       sharex  <span class="op">=</span> <span class="st">&#39;none&#39;</span>,</span>
<span id="cb64-20"><a href="#cb64-20" aria-hidden="true" tabindex="-1"></a>                       sharey  <span class="op">=</span> <span class="st">&#39;none&#39;</span>,</span>
<span id="cb64-21"><a href="#cb64-21" aria-hidden="true" tabindex="-1"></a>                       figsize <span class="op">=</span> (<span class="dv">10</span>,<span class="dv">14</span>)</span>
<span id="cb64-22"><a href="#cb64-22" aria-hidden="true" tabindex="-1"></a>                      ) </span>
<span id="cb64-23"><a href="#cb64-23" aria-hidden="true" tabindex="-1"></a>fig.tight_layout(pad <span class="op">=</span> <span class="dv">4</span>)</span>
<span id="cb64-24"><a href="#cb64-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-25"><a href="#cb64-25" aria-hidden="true" tabindex="-1"></a>fig.delaxes(ax[<span class="dv">2</span>,<span class="dv">1</span>]) </span>
<span id="cb64-26"><a href="#cb64-26" aria-hidden="true" tabindex="-1"></a>fig.text(<span class="fl">0.04</span>, <span class="fl">0.5</span>, <span class="st">&#39;MEAN SCORE&#39;</span>, va <span class="op">=</span> <span class="st">&#39;center&#39;</span>, rotation <span class="op">=</span> <span class="st">&#39;vertical&#39;</span>)</span>
<span id="cb64-27"><a href="#cb64-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-28"><a href="#cb64-28" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> ax.flatten()</span>
<span id="cb64-29"><a href="#cb64-29" aria-hidden="true" tabindex="-1"></a>pram_preformace_in_best <span class="op">=</span> {}</span>
<span id="cb64-30"><a href="#cb64-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-31"><a href="#cb64-31" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, p <span class="kw">in</span> <span class="bu">enumerate</span>(masks_names):</span>
<span id="cb64-32"><a href="#cb64-32" aria-hidden="true" tabindex="-1"></a>  m <span class="op">=</span> np.stack(masks[:i] <span class="op">+</span> masks[i <span class="op">+</span> <span class="dv">1</span>:])</span>
<span id="cb64-33"><a href="#cb64-33" aria-hidden="true" tabindex="-1"></a>  pram_preformace_in_best</span>
<span id="cb64-34"><a href="#cb64-34" aria-hidden="true" tabindex="-1"></a>  best_parms_mask <span class="op">=</span> m.<span class="bu">all</span>(axis <span class="op">=</span> <span class="dv">0</span>)</span>
<span id="cb64-35"><a href="#cb64-35" aria-hidden="true" tabindex="-1"></a>  best_index <span class="op">=</span> np.where(best_parms_mask)[<span class="dv">0</span>]</span>
<span id="cb64-36"><a href="#cb64-36" aria-hidden="true" tabindex="-1"></a>  x   <span class="op">=</span> np.array(params[p])</span>
<span id="cb64-37"><a href="#cb64-37" aria-hidden="true" tabindex="-1"></a>  y_1 <span class="op">=</span> np.array(means_test[best_index])</span>
<span id="cb64-38"><a href="#cb64-38" aria-hidden="true" tabindex="-1"></a>  e_1 <span class="op">=</span> np.array(stds_test[best_index])</span>
<span id="cb64-39"><a href="#cb64-39" aria-hidden="true" tabindex="-1"></a>  y_2 <span class="op">=</span> np.array(means_train[best_index])</span>
<span id="cb64-40"><a href="#cb64-40" aria-hidden="true" tabindex="-1"></a>  e_2 <span class="op">=</span> np.array(stds_train[best_index])</span>
<span id="cb64-41"><a href="#cb64-41" aria-hidden="true" tabindex="-1"></a>  ax[i].errorbar(x, y_1, e_1, linestyle<span class="op">=</span><span class="st">&#39;--&#39;</span>, marker<span class="op">=</span><span class="st">&#39;o&#39;</span>, label<span class="op">=</span><span class="st">&#39;test&#39;</span>)</span>
<span id="cb64-42"><a href="#cb64-42" aria-hidden="true" tabindex="-1"></a>  ax[i].errorbar(x, y_2, e_2, linestyle<span class="op">=</span><span class="st">&#39;-&#39;</span>, marker<span class="op">=</span><span class="st">&#39;^&#39;</span>,label<span class="op">=</span><span class="st">&#39;train&#39;</span> )</span>
<span id="cb64-43"><a href="#cb64-43" aria-hidden="true" tabindex="-1"></a>  ax[i].set_xlabel(p.upper())</span>
<span id="cb64-44"><a href="#cb64-44" aria-hidden="true" tabindex="-1"></a>  ax[i].legend()</span>
<span id="cb64-45"><a href="#cb64-45" aria-hidden="true" tabindex="-1"></a>fig.suptitle(<span class="st">&#39;Performance por parámetro&#39;</span>)</span>
<span id="cb64-46"><a href="#cb64-46" aria-hidden="true" tabindex="-1"></a>sns.despine()</span>
<span id="cb64-47"><a href="#cb64-47" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<p><img src="/img/tp_uba/output_125_0.png" /></p>
<p>De acuerdo al análisis de los resultados de las curvas del punto anterior, seleccionamos los hiperparámetros que maximizaron el beneficio teniendo en cuenta de buscar un equilibrio entre los resultados del train y el test set, es decir, evitar el overfitting.</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Modelo con los mejores parámetros</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="co"># =================================</span></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>best_rfc <span class="op">=</span> RandomForestClassifier(class_weight      <span class="op">=</span> <span class="st">&#39;balanced&#39;</span>,</span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>                                   random_state     <span class="op">=</span>  <span class="dv">42</span>,</span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>                                   n_estimators     <span class="op">=</span>  <span class="dv">300</span>, </span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a>                                   min_samples_leaf <span class="op">=</span>  <span class="dv">5</span>,</span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a>                                   max_depth        <span class="op">=</span>  <span class="dv">15</span>,</span>
<span id="cb65-9"><a href="#cb65-9" aria-hidden="true" tabindex="-1"></a>                                   max_features     <span class="op">=</span>  <span class="st">&#39;sqrt&#39;</span>,</span>
<span id="cb65-10"><a href="#cb65-10" aria-hidden="true" tabindex="-1"></a>                                   bootstrap        <span class="op">=</span>  <span class="va">True</span>)</span>
<span id="cb65-11"><a href="#cb65-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-12"><a href="#cb65-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Entrenamiento</span></span>
<span id="cb65-13"><a href="#cb65-13" aria-hidden="true" tabindex="-1"></a>best_rfc <span class="op">=</span> best_rfc.fit(X_train, y_train)</span>
<span id="cb65-14"><a href="#cb65-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-15"><a href="#cb65-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Predicciones</span></span>
<span id="cb65-16"><a href="#cb65-16" aria-hidden="true" tabindex="-1"></a>y_pred <span class="op">=</span> best_rfc.predict(X_test)</span>
<span id="cb65-17"><a href="#cb65-17" aria-hidden="true" tabindex="-1"></a>plot_confusion_matrix(best_rfc,</span>
<span id="cb65-18"><a href="#cb65-18" aria-hidden="true" tabindex="-1"></a>                      X_test,</span>
<span id="cb65-19"><a href="#cb65-19" aria-hidden="true" tabindex="-1"></a>                      y_test,</span>
<span id="cb65-20"><a href="#cb65-20" aria-hidden="true" tabindex="-1"></a>                      values_format  <span class="op">=</span> <span class="st">&#39;d&#39;</span>)</span>
<span id="cb65-21"><a href="#cb65-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-22"><a href="#cb65-22" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>()</span>
<span id="cb65-23"><a href="#cb65-23" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Beneficio Esperado (test): </span><span class="sc">{:.2f}</span><span class="st">&quot;</span> <span class="op">\</span> </span>
<span id="cb65-24"><a href="#cb65-24" aria-hidden="true" tabindex="-1"></a>      .<span class="bu">format</span>(benefitmatrix_score(y_test, y_pred)))</span>
<span id="cb65-25"><a href="#cb65-25" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>()</span>
<span id="cb65-26"><a href="#cb65-26" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(classification_report(y_pred, y_test))</span>
<span id="cb65-27"><a href="#cb65-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-28"><a href="#cb65-28" aria-hidden="true" tabindex="-1"></a>    Beneficio Esperado (test): <span class="fl">307.45</span></span>
<span id="cb65-29"><a href="#cb65-29" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb65-30"><a href="#cb65-30" aria-hidden="true" tabindex="-1"></a>                  precision    recall  f1<span class="op">-</span>score   support</span>
<span id="cb65-31"><a href="#cb65-31" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb65-32"><a href="#cb65-32" aria-hidden="true" tabindex="-1"></a>               <span class="dv">0</span>       <span class="fl">0.88</span>      <span class="fl">0.95</span>      <span class="fl">0.91</span>      <span class="dv">5762</span></span>
<span id="cb65-33"><a href="#cb65-33" aria-hidden="true" tabindex="-1"></a>               <span class="dv">1</span>       <span class="fl">0.61</span>      <span class="fl">0.39</span>      <span class="fl">0.48</span>      <span class="dv">1221</span></span>
<span id="cb65-34"><a href="#cb65-34" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb65-35"><a href="#cb65-35" aria-hidden="true" tabindex="-1"></a>        accuracy                           <span class="fl">0.85</span>      <span class="dv">6983</span></span>
<span id="cb65-36"><a href="#cb65-36" aria-hidden="true" tabindex="-1"></a>       macro avg       <span class="fl">0.74</span>      <span class="fl">0.67</span>      <span class="fl">0.69</span>      <span class="dv">6983</span></span>
<span id="cb65-37"><a href="#cb65-37" aria-hidden="true" tabindex="-1"></a>    weighted avg       <span class="fl">0.83</span>      <span class="fl">0.85</span>      <span class="fl">0.84</span>      <span class="dv">6983</span></span>
<span id="cb65-38"><a href="#cb65-38" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb65-39"><a href="#cb65-39" aria-hidden="true" tabindex="-1"></a> </span></code></pre></div>
<p><img src="/img/tp_uba/output_127_1.png" /></p>
<p>Concluimos que este modelo era el que mejor resultados nos daba y el de mayor poder predictivo que maximizaba el beneficio esperado. Veamos como fueron los resultados cuando se lo utilizó para predecir datos nunca vistos.</p>
<p> </p>
</div>
<div id="set-de-datos-de-evaluación-final" class="section level1" number="10">
<h1><span class="header-section-number">10</span> Set de Datos de Evaluación Final</h1>
<p>El modelo tuneado se utilizó para calcular el beneficio esperado en el set de datos de validación final, este set de datos fue provisto luego de la presentación final, es por eso que podemos replicar los resultados arrojados para definir al modelo ganador.</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>dev_test <span class="op">=</span> pd.read_csv(<span class="st">&#39;mkt_bank_test.csv&#39;</span>)</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>dev_test.head()</span></code></pre></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<div style="overflow-x:auto;">
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th>
</th>
<th>
Edad
</th>
<th>
Trabajo
</th>
<th>
Estado civil
</th>
<th>
Educacion
</th>
<th>
Default
</th>
<th>
Prestamo vivienda
</th>
<th>
Prestamo personal
</th>
<th>
Contacto
</th>
<th>
Mes
</th>
<th>
Dia de la semana
</th>
<th>
Cantidad de contactos
</th>
<th>
Dias
</th>
<th>
Anterior
</th>
<th>
Resultado anterior
</th>
<th>
emp.var.rate
</th>
<th>
cons.price.idx
</th>
<th>
cons.conf.idx
</th>
<th>
euribor3m
</th>
<th>
nr.employed
</th>
<th>
y
</th>
</tr>
</thead>
<tbody>
<tr>
<th>
0
</th>
<td>
45
</td>
<td>
Servicios
</td>
<td>
casado
</td>
<td>
secundario
</td>
<td>
no
</td>
<td>
si
</td>
<td>
no
</td>
<td>
telefono
</td>
<td>
may
</td>
<td>
mar
</td>
<td>
2
</td>
<td>
999
</td>
<td>
0
</td>
<td>
inexistente
</td>
<td>
1.1
</td>
<td>
93.994
</td>
<td>
-36.4
</td>
<td>
4.857
</td>
<td>
5191.0
</td>
<td>
no
</td>
</tr>
<tr>
<th>
1
</th>
<td>
26
</td>
<td>
Administrativo
</td>
<td>
soltero
</td>
<td>
universitario
</td>
<td>
no
</td>
<td>
si
</td>
<td>
no
</td>
<td>
celular
</td>
<td>
may
</td>
<td>
mar
</td>
<td>
5
</td>
<td>
999
</td>
<td>
0
</td>
<td>
inexistente
</td>
<td>
-1.8
</td>
<td>
92.893
</td>
<td>
-46.2
</td>
<td>
1.291
</td>
<td>
5099.1
</td>
<td>
no
</td>
</tr>
<tr>
<th>
2
</th>
<td>
51
</td>
<td>
Jubilado
</td>
<td>
casado
</td>
<td>
basica.9y
</td>
<td>
no
</td>
<td>
desconocido
</td>
<td>
desconocido
</td>
<td>
telefono
</td>
<td>
may
</td>
<td>
lun
</td>
<td>
1
</td>
<td>
999
</td>
<td>
0
</td>
<td>
inexistente
</td>
<td>
1.1
</td>
<td>
93.994
</td>
<td>
-36.4
</td>
<td>
4.857
</td>
<td>
5191.0
</td>
<td>
no
</td>
</tr>
<tr>
<th>
3
</th>
<td>
54
</td>
<td>
Obrero
</td>
<td>
casado
</td>
<td>
basica.4y
</td>
<td>
desconocido
</td>
<td>
si
</td>
<td>
si
</td>
<td>
celular
</td>
<td>
jul
</td>
<td>
jue
</td>
<td>
5
</td>
<td>
999
</td>
<td>
0
</td>
<td>
inexistente
</td>
<td>
1.4
</td>
<td>
93.918
</td>
<td>
-42.7
</td>
<td>
4.962
</td>
<td>
5228.1
</td>
<td>
no
</td>
</tr>
<tr>
<th>
4
</th>
<td>
45
</td>
<td>
Obrero
</td>
<td>
casado
</td>
<td>
basica.9y
</td>
<td>
no
</td>
<td>
si
</td>
<td>
no
</td>
<td>
celular
</td>
<td>
ago
</td>
<td>
lun
</td>
<td>
2
</td>
<td>
999
</td>
<td>
0
</td>
<td>
inexistente
</td>
<td>
1.4
</td>
<td>
93.444
</td>
<td>
-36.1
</td>
<td>
4.965
</td>
<td>
5228.1
</td>
<td>
no
</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode" id="cb67"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>dev_test.shape</span></code></pre></div>
<pre><code>(6178, 15)</code></pre>
<p>El dataset de validación tenía 6178 registros de clientes y la misma estructura que el provisto para entrenar y testear los modelos pero para poder predecir si este nuevo grupo de clientes compraba o no el producto primero fue necesario procesarlo de la misma forma que lo hicimos con los anteriores pero teniendo en cuenta de no eliminar los registros duplicados.</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Normalizamos nombres de columnas y strings</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>normalizador(dev_test)</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Aplicamos la función de limpieza/imputación de datos</span></span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>cleaner(dev_test)</span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Separamos la varibale objetivo </span></span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a>X_dev_test <span class="op">=</span> dev_test.drop(<span class="st">&#39;y&#39;</span>, axis <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a>y_dev_test <span class="op">=</span> dev_test[<span class="st">&#39;y&#39;</span>]</span>
<span id="cb69-10"><a href="#cb69-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-11"><a href="#cb69-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Estandarizamos y aplicamos OHE</span></span>
<span id="cb69-12"><a href="#cb69-12" aria-hidden="true" tabindex="-1"></a>X_dev_test  <span class="op">=</span> preprocessor.transform(dev_test)</span>
<span id="cb69-13"><a href="#cb69-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-14"><a href="#cb69-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Predecimos </span></span>
<span id="cb69-15"><a href="#cb69-15" aria-hidden="true" tabindex="-1"></a>y_new_pred <span class="op">=</span> best_rfc.predict(X_dev_test)</span>
<span id="cb69-16"><a href="#cb69-16" aria-hidden="true" tabindex="-1"></a>plot_confusion_matrix(best_rfc,</span>
<span id="cb69-17"><a href="#cb69-17" aria-hidden="true" tabindex="-1"></a>                      X_dev_test,</span>
<span id="cb69-18"><a href="#cb69-18" aria-hidden="true" tabindex="-1"></a>                      y_dev_test,</span>
<span id="cb69-19"><a href="#cb69-19" aria-hidden="true" tabindex="-1"></a>                      values_format  <span class="op">=</span> <span class="st">&#39;d&#39;</span>)</span></code></pre></div>
<p><img src="/img/tp_uba/output_134_1.png" /></p>
<table>
<thead>
<tr class="header">
<th></th>
<th>Llamada Exitosa (E)</th>
<th>Llamada Fallida (F)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Llamada Realizada (R)</td>
<td>2900</td>
<td>-440</td>
</tr>
<tr class="even">
<td>Llamada No Realizada (NR)</td>
<td>0</td>
<td>200</td>
</tr>
</tbody>
</table>
<p>A partir de la matriz de confusión y la matriz de beneficio obtuvimos el beneficio esperado por cliente para la nueva campaña de marketing.</p>
<p>El beneficio total (BT) de la campaña es:</p>
<p><span class="math display">\[BT =  Verdaderos\:Negativos * NR|F\\ 
+ Verdaderos\:Positivos * R|E\\
+ Falsos\:Positivos * R|F\]</span></p>
<p><span class="math display">\[BT=  4856 * 200 + 414 * 2900\\
+ 623 * (-440)\]</span>
<span class="math display">\[BT =  1897680\:UM \]</span></p>
<p>Dividiendo el beneficio total por la cantidad de clientes de la nueva campaña tenemos el beneficio esperado (BE) por cliente:</p>
<p><span class="math display">\[BE =  BT / 6178\]</span>
<span class="math display">\[BE =  307.17\:UM/Cliente\]</span></p>
<p> </p>
</div>
<div id="conclusiones" class="section level1" number="11">
<h1><span class="header-section-number">11</span> Conclusiones</h1>
<p>Cuando el costo de un acierto o una equivocación no es uniforme entre las clases no hay accuracy que valga y esta era nuestra situación. Este concepto está relacionado con la paradoja de accuracy el cual explica que optimizar modelos de clasificación con esta métrica no siempre resulta bueno ya que se podrían obtener resulatdos con alto accuracy per que desde el punto de vista práctico y de aplicación no son adecuados, esta situación es evidente en el campo de la medicina cuando se utilizan modelos predictivos para clasificar si un paciente tiene o no una enfermedad los cuales buscan la reducción en la detección de falsos negativos y falsos positivos.</p>
<p>Por otra parte, incorporar una matriz de costo beneficio nos permitió poder llevar el problema a un terreno más empresarial al ponerle un número o valor monetario a cada alternativa de solución que nos daban los modelos. Fue sin duda una experiencia que nos permitió poner en práctica todo lo aprendido durante el curso.</p>
<p> </p>
</div>
<div id="bibliografía" class="section level1" number="12">
<h1><span class="header-section-number">12</span> Bibliografía</h1>
<ul>
<li>Hands-On Machine Learning with Scikit-Learn, Keras, and TensorFlow, 2nd Edition by Aurélien Géron (2019).</li>
<li>Data Wrangling with Python Tips and Tools to Make Your Life Easier by Jacqueline Kazil, Katharine Jarmul (2016).</li>
<li>An Introduction to Statistical Learning: With Applications in R (2013).
</div></li>
</ul>
</div>
