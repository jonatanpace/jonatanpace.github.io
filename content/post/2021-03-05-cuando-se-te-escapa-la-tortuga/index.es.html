---
title: Cuando se te escapa la tortuga
author: Jonatan Pace
date: '2020-08-14'
slug: cuando-se-te-escapa-la-tortuga
categories: ['Python', 'Machine Learning', 'Regresión Logística']
tags: ['Python', 'Machine Learning', 'Regresión Logística']
type: ''
subtitle: 'Prediciendo qué clientes tienen más probabilidad de prescindir de nuestros servicios.'
image: 'img/portada_churn.png'
Description: 'Uno de nuestros clientes que durante 12 años ha pagado cada uno de los servicios prestados a término recibe un llamado en el cual se le notifica que ha sido beneficiado por su antigüedad en la compañía y que en una fecha específica un operario pasará por su casa a cambiarle su viejo router WiFi por uno nuevo a pesar de que este sigue funcionando correctamente. Un mes después de la fecha acordada el operario aún no ha pasado y el cliente recibe un cargo extra por no haber entregado el viejo router que estaba en consignación y, a pesar de los reclamos, no consigue que este sea anulado. Cuando finalmente contactamos al cliente para resolver el conflicto este ya se ha pasado la competencia. ¿Qué ha fallado y por qué estamos siempre un paso por detrás?'
codefolding_nobutton: false
codefolding_show: 'show'
disable_codefolding: false
output: 
  blogdown::html_page:
    toc: true
    highlight: 'pygments'
---

<script src="{{< blogdown/postref >}}index.es_files/header-attrs/header-attrs.js"></script>
<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<div id="TOC">
<ul>
<li><a href="#presentación-del-problema">1. Presentación del Problema</a></li>
<li><a href="#librerías-y-configuraciones">2. Librerías y Configuraciones</a></li>
<li><a href="#descripción-del-dataset">3. Descripción del Dataset</a>
<ul>
<li><a href="#carga-del-dataset">3.1 Carga del Dataset</a></li>
<li><a href="#resumen-estadístico">3.2. Resumen Estadístico</a></li>
<li><a href="#análisis-gráfico">3.3. Análisis Gráfico</a>
<ul>
<li><a href="#variable-de-respuesta">3.3.1. Variable de Respuesta</a></li>
<li><a href="#variables-numéricas">3.3.2. Variables Numéricas</a></li>
<li><a href="#variables-categóricas">3.3.3. Variables Categóricas</a></li>
</ul></li>
<li><a href="#análisis-de-correlación">3.4. Análisis de Correlación</a></li>
</ul></li>
<li><a href="#data-cleaning">4. Data Cleaning</a>
<ul>
<li><a href="#valores-ausentes">4.1. Valores Ausentes</a></li>
<li><a href="#atributos-innecesarios">4.2. Atributos Innecesarios</a></li>
<li><a href="#registros-duplicados">4.3. Registros Duplicados</a></li>
</ul></li>
<li><a href="#división-train-y-test">5. División Train y Test</a></li>
<li><a href="#preprocesado">6. Preprocesado</a>
<ul>
<li><a href="#label-encoder">6.1. Label Encoder</a></li>
<li><a href="#one-hot-encoder-y-estandarización-de-variables.">6.2. One Hot Encoder y Estandarización de Variables.</a></li>
</ul></li>
<li><a href="#modelado">7. Modelado</a>
<ul>
<li><a href="#regresión-logística-múltiple">7.1. Regresión Logística Múltiple</a></li>
<li><a href="#hiperparámetros">7.2. Hiperparámetros</a></li>
<li><a href="#variables-más-influyentes">7.3. Variables más Influyentes</a></li>
<li><a href="#alternativas-de-decisión">7.4. Alternativas de Decisión</a></li>
</ul></li>
<li><a href="#conclusiones">8. Conclusiones</a></li>
<li><a href="#bibliografía">9. Bibliografía</a></li>
</ul>
</div>

<div style="text-align: justify">

<div id="presentación-del-problema" class="section level1">
<h1>1. Presentación del Problema</h1>
<p>Situaciones como la presentada en la introducción conviven en el día a día de cualquier empresa pero lo cierto es que los clientes se pierden por diversos motivos, algunos se mueren, otros se mudan de ciudad, se van a la competencia porque tienen precios más bajos o porque tienen un amigo allí, pero la realidad nos muestra que la mayor pérdida es debido a una mala acción de los vendedores, telefonistas, gerentes, repartidores, operarios y quienes estén en contacto directo con el cliente y es porque se olvidan que mantenerlo contento siempre costará menos que conseguir uno nuevo.</p>
<p>Esta actividad está orientada a generar un modelo que pueda predecir qué clientes tienen más probabilidad de darse de baja de los servicios que presta la empresa y así poder actuar en consecuencia generando diferentes estrategias de marketing para reducir la tasa de cancelación enfocándose en clientes específicos.
El dataset con el que vamos a trabajar se encuentra disponible en Kaggle, es el <em>Telco Customer Churn Dataset</em> el cual es de uso público.</p>
<p> </p>
</div>
<div id="librerías-y-configuraciones" class="section level1">
<h1>2. Librerías y Configuraciones</h1>
<div class="sourceCode" id="cb1"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Manipulación de Datos</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co"># =====================</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy  <span class="im">as</span> np</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráficos</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co"># ========</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn           <span class="im">as</span> sns</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>plt.style.context(<span class="st">&#39;bmh&#39;</span>)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>sns.set_context(<span class="st">&#39;notebook&#39;</span>)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Preprocesado y modelado</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="co"># =======================</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing   <span class="im">import</span> LabelEncoder</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.compose         <span class="im">import</span> ColumnTransformer</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing   <span class="im">import</span> OneHotEncoder</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing   <span class="im">import</span> StandardScaler</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model    <span class="im">import</span> LogisticRegression</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics         <span class="im">import</span> plot_confusion_matrix</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> RepeatedStratifiedKFold</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> GridSearchCV</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.calibration     <span class="im">import</span> CalibratedClassifierCV</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Configuración de warnings</span></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a><span class="co"># =========================</span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> warnings</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>warnings.filterwarnings(<span class="st">&#39;ignore&#39;</span>)</span></code></pre></div>
<p> </p>
</div>
<div id="descripción-del-dataset" class="section level1">
<h1>3. Descripción del Dataset</h1>
<p>Este dataset contiene registros de clientes de la empresa Telco la cual presta servicios de telefonía, internet, tv por cable, servicios de streaming y demás.
Cada fila representa un cliente, y las columnas representan diferentes atributos de los mismos los cuales se detallan a continuación:</p>
<ul>
<li><code>customerID</code>: código identificador del cliente.</li>
<li><code>gender</code>: sexo del cliente.</li>
<li><code>SeniorCitizen</code>: corresponde <em>0</em> si el cliente es mayor a 65 años y <em>1</em> si no lo es.</li>
<li><code>Partner</code>: corresponde a <em>Yes</em> si el cliente tiene pareja y <em>No</em> si no tiene.</li>
<li><code>Dependents</code>: personas a cargo que tiene el cliente: <em>Yes</em> si tiene y <em>No</em> si no tiene.</li>
<li><code>tenure</code>: hace referencia a la antigüedad del contrato en meses.</li>
<li><code>PhoneService</code>: corresponde a si el cliente tiene o no contratado el servicio de telefonía: ‘Yes’ si lo tiene y <em>No</em> si no lo tiene.</li>
<li><code>MultipleLines</code>: corresponde a si el cliente tiene o no contratado múltiples servicios de telefonía: <em>Yes</em> si tiene múltiple líneas, <em>No</em> si tiene solo una y <em>No phone services</em> si no tiene ninguna.</li>
<li><code>InternetService</code>: tipo de servicio de internet contratado, puede ser: <em>DSL</em>, <em>fibra óptica</em> o <em>No</em> si no no tiene ninguno.</li>
<li><code>OnlineSecurity</code>, <code>OnlineBackup</code>, <code>DeviceProtection</code>, <code>TechSuport</code>, <code>StreamingTV</code> y <code>StreamingMovies</code> hacen referencia a si el cliente tiene o no contratado estos tipos de servicios, para todos ellos es <em>Yes</em> si lo tiene y <em>No</em> si no lo tiene.</li>
<li><code>PaperlessBilling</code>: corresponde a <em>Yes</em> si el cliente tiene recibo electrónico y a <em>No</em> para el caso de recibo en papel.</li>
<li><code>PaymentMethod</code>: método de pago de los servicios, pueden ser <em>Bank transfer (automatic)</em> (débito automático), <em>Credit Card</em>, <em>Mailed Check</em> o <em>Electronic Check</em>.</li>
<li><code>MonthlyCharges</code>: es el monto mensual que el cliente paga por los servicios contratados.</li>
<li><code>TotalCharges</code>: es el moto total pagado por el cliente a la compañía.</li>
<li><code>Churn</code>: clientes que han dejado la empresa en el último mes: <em>Yes</em> si el cliente se ha ido y <em>No</em> en caso contrario.</li>
</ul>
<p> </p>
<div id="carga-del-dataset" class="section level3">
<h3>3.1 Carga del Dataset</h3>
<div class="sourceCode" id="cb2"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Cargamos el dataset</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>customers <span class="op">=</span> pd.read_csv(<span class="st">&#39;Telco_Churn.csv&#39;</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>customers.head(<span class="dv">5</span>)</span></code></pre></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<div style="overflow-x:auto;">
<table border="1" class="dataframe">
<thead>
<tr style="overflow-x:auto;">
<th>
</th>
<th>
customerID
</th>
<th>
gender
</th>
<th>
SeniorCitizen
</th>
<th>
Partner
</th>
<th>
Dependents
</th>
<th>
tenure
</th>
<th>
PhoneService
</th>
<th>
MultipleLines
</th>
<th>
InternetService
</th>
<th>
OnlineSecurity
</th>
<th>
…
</th>
<th>
DeviceProtection
</th>
<th>
TechSupport
</th>
<th>
StreamingTV
</th>
<th>
StreamingMovies
</th>
<th>
Contract
</th>
<th>
PaperlessBilling
</th>
<th>
PaymentMethod
</th>
<th>
MonthlyCharges
</th>
<th>
TotalCharges
</th>
<th>
Churn
</th>
</tr>
</thead>
<tbody>
<tr>
<th>
0
</th>
<td>
7590-VHVEG
</td>
<td>
Female
</td>
<td>
0
</td>
<td>
Yes
</td>
<td>
No
</td>
<td>
1
</td>
<td>
No
</td>
<td>
No phone service
</td>
<td>
DSL
</td>
<td>
No
</td>
<td>
…
</td>
<td>
No
</td>
<td>
No
</td>
<td>
No
</td>
<td>
No
</td>
<td>
Month-to-month
</td>
<td>
Yes
</td>
<td>
Electronic check
</td>
<td>
29.85
</td>
<td>
29.85
</td>
<td>
No
</td>
</tr>
<tr>
<th>
1
</th>
<td>
5575-GNVDE
</td>
<td>
Male
</td>
<td>
0
</td>
<td>
No
</td>
<td>
No
</td>
<td>
34
</td>
<td>
Yes
</td>
<td>
No
</td>
<td>
DSL
</td>
<td>
Yes
</td>
<td>
…
</td>
<td>
Yes
</td>
<td>
No
</td>
<td>
No
</td>
<td>
No
</td>
<td>
One year
</td>
<td>
No
</td>
<td>
Mailed check
</td>
<td>
56.95
</td>
<td>
1889.5
</td>
<td>
No
</td>
</tr>
<tr>
<th>
2
</th>
<td>
3668-QPYBK
</td>
<td>
Male
</td>
<td>
0
</td>
<td>
No
</td>
<td>
No
</td>
<td>
2
</td>
<td>
Yes
</td>
<td>
No
</td>
<td>
DSL
</td>
<td>
Yes
</td>
<td>
…
</td>
<td>
No
</td>
<td>
No
</td>
<td>
No
</td>
<td>
No
</td>
<td>
Month-to-month
</td>
<td>
Yes
</td>
<td>
Mailed check
</td>
<td>
53.85
</td>
<td>
108.15
</td>
<td>
Yes
</td>
</tr>
<tr>
<th>
3
</th>
<td>
7795-CFOCW
</td>
<td>
Male
</td>
<td>
0
</td>
<td>
No
</td>
<td>
No
</td>
<td>
45
</td>
<td>
No
</td>
<td>
No phone service
</td>
<td>
DSL
</td>
<td>
Yes
</td>
<td>
…
</td>
<td>
Yes
</td>
<td>
Yes
</td>
<td>
No
</td>
<td>
No
</td>
<td>
One year
</td>
<td>
No
</td>
<td>
Bank transfer (automatic)
</td>
<td>
42.30
</td>
<td>
1840.75
</td>
<td>
No
</td>
</tr>
<tr>
<th>
4
</th>
<td>
9237-HQITU
</td>
<td>
Female
</td>
<td>
0
</td>
<td>
No
</td>
<td>
No
</td>
<td>
2
</td>
<td>
Yes
</td>
<td>
No
</td>
<td>
Fiber optic
</td>
<td>
No
</td>
<td>
…
</td>
<td>
No
</td>
<td>
No
</td>
<td>
No
</td>
<td>
No
</td>
<td>
Month-to-month
</td>
<td>
Yes
</td>
<td>
Electronic check
</td>
<td>
70.70
</td>
<td>
151.65
</td>
<td>
Yes
</td>
</tr>
</tbody>
</table>
<p>
5 rows × 21 columns
</p>
</div>
<p> </p>
</div>
<div id="resumen-estadístico" class="section level2">
<h2>3.2. Resumen Estadístico</h2>
<div class="sourceCode" id="cb3"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Descripción general del dataset</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>customers.info()</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">&lt;</span><span class="kw">class</span> <span class="st">&#39;pandas.core.frame.DataFrame&#39;</span><span class="op">&gt;</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>    RangeIndex: <span class="dv">7043</span> entries, <span class="dv">0</span> to <span class="dv">7042</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>    Data columns (total <span class="dv">21</span> columns):</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>     <span class="co">#   Column            Non-Null Count  Dtype  </span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>    <span class="op">---</span>  <span class="op">------</span>            <span class="op">--------------</span>  <span class="op">-----</span>  </span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>     <span class="dv">0</span>   customerID        <span class="dv">7043</span> non<span class="op">-</span>null   <span class="bu">object</span> </span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>     <span class="dv">1</span>   gender            <span class="dv">7043</span> non<span class="op">-</span>null   <span class="bu">object</span> </span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>     <span class="dv">2</span>   SeniorCitizen     <span class="dv">7043</span> non<span class="op">-</span>null   int64  </span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>     <span class="dv">3</span>   Partner           <span class="dv">7043</span> non<span class="op">-</span>null   <span class="bu">object</span> </span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>     <span class="dv">4</span>   Dependents        <span class="dv">7043</span> non<span class="op">-</span>null   <span class="bu">object</span> </span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>     <span class="dv">5</span>   tenure            <span class="dv">7043</span> non<span class="op">-</span>null   int64  </span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>     <span class="dv">6</span>   PhoneService      <span class="dv">7043</span> non<span class="op">-</span>null   <span class="bu">object</span> </span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>     <span class="dv">7</span>   MultipleLines     <span class="dv">7043</span> non<span class="op">-</span>null   <span class="bu">object</span> </span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>     <span class="dv">8</span>   InternetService   <span class="dv">7043</span> non<span class="op">-</span>null   <span class="bu">object</span> </span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>     <span class="dv">9</span>   OnlineSecurity    <span class="dv">7043</span> non<span class="op">-</span>null   <span class="bu">object</span> </span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>     <span class="dv">10</span>  OnlineBackup      <span class="dv">7043</span> non<span class="op">-</span>null   <span class="bu">object</span> </span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>     <span class="dv">11</span>  DeviceProtection  <span class="dv">7043</span> non<span class="op">-</span>null   <span class="bu">object</span> </span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>     <span class="dv">12</span>  TechSupport       <span class="dv">7043</span> non<span class="op">-</span>null   <span class="bu">object</span> </span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>     <span class="dv">13</span>  StreamingTV       <span class="dv">7043</span> non<span class="op">-</span>null   <span class="bu">object</span> </span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>     <span class="dv">14</span>  StreamingMovies   <span class="dv">7043</span> non<span class="op">-</span>null   <span class="bu">object</span> </span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>     <span class="dv">15</span>  Contract          <span class="dv">7043</span> non<span class="op">-</span>null   <span class="bu">object</span> </span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>     <span class="dv">16</span>  PaperlessBilling  <span class="dv">7043</span> non<span class="op">-</span>null   <span class="bu">object</span> </span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>     <span class="dv">17</span>  PaymentMethod     <span class="dv">7043</span> non<span class="op">-</span>null   <span class="bu">object</span> </span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>     <span class="dv">18</span>  MonthlyCharges    <span class="dv">7043</span> non<span class="op">-</span>null   float64</span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>     <span class="dv">19</span>  TotalCharges      <span class="dv">7043</span> non<span class="op">-</span>null   <span class="bu">object</span> </span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>     <span class="dv">20</span>  Churn             <span class="dv">7043</span> non<span class="op">-</span>null   <span class="bu">object</span> </span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>    dtypes: float64(<span class="dv">1</span>), int64(<span class="dv">2</span>), <span class="bu">object</span>(<span class="dv">18</span>)</span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>    memory usage: <span class="fl">1.1</span><span class="op">+</span> MB</span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Valores únicos para cada atributo</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> col <span class="kw">in</span> customers.columns:</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(col)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(customers[col].unique())</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&#39;----------&#39;</span>)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>()</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>    customerID</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>    [<span class="st">&#39;7590-VHVEG&#39;</span> <span class="st">&#39;5575-GNVDE&#39;</span> <span class="st">&#39;3668-QPYBK&#39;</span> ... <span class="st">&#39;4801-JZAZL&#39;</span> <span class="st">&#39;8361-LTMKD&#39;</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>     <span class="st">&#39;3186-AJIEK&#39;</span>]</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>    <span class="op">----------</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>    gender</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>    [<span class="st">&#39;Female&#39;</span> <span class="st">&#39;Male&#39;</span>]</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>    <span class="op">----------</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>    SeniorCitizen</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>    [<span class="dv">0</span> <span class="dv">1</span>]</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>    <span class="op">----------</span></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>    Partner</span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>    [<span class="st">&#39;Yes&#39;</span> <span class="st">&#39;No&#39;</span>]</span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>    <span class="op">----------</span></span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>    Dependents</span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>    [<span class="st">&#39;No&#39;</span> <span class="st">&#39;Yes&#39;</span>]</span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>    <span class="op">----------</span></span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a>    tenure</span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a>    [ <span class="dv">1</span> <span class="dv">34</span>  <span class="dv">2</span> <span class="dv">45</span>  <span class="dv">8</span> <span class="dv">22</span> <span class="dv">10</span> <span class="dv">28</span> <span class="dv">62</span> <span class="dv">13</span> <span class="dv">16</span> <span class="dv">58</span> <span class="dv">49</span> <span class="dv">25</span> <span class="dv">69</span> <span class="dv">52</span> <span class="dv">71</span> <span class="dv">21</span> <span class="dv">12</span> <span class="dv">30</span> <span class="dv">47</span> <span class="dv">72</span> <span class="dv">17</span> <span class="dv">27</span></span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a>      <span class="dv">5</span> <span class="dv">46</span> <span class="dv">11</span> <span class="dv">70</span> <span class="dv">63</span> <span class="dv">43</span> <span class="dv">15</span> <span class="dv">60</span> <span class="dv">18</span> <span class="dv">66</span>  <span class="dv">9</span>  <span class="dv">3</span> <span class="dv">31</span> <span class="dv">50</span> <span class="dv">64</span> <span class="dv">56</span>  <span class="dv">7</span> <span class="dv">42</span> <span class="dv">35</span> <span class="dv">48</span> <span class="dv">29</span> <span class="dv">65</span> <span class="dv">38</span> <span class="dv">68</span></span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a>     <span class="dv">32</span> <span class="dv">55</span> <span class="dv">37</span> <span class="dv">36</span> <span class="dv">41</span>  <span class="dv">6</span>  <span class="dv">4</span> <span class="dv">33</span> <span class="dv">67</span> <span class="dv">23</span> <span class="dv">57</span> <span class="dv">61</span> <span class="dv">14</span> <span class="dv">20</span> <span class="dv">53</span> <span class="dv">40</span> <span class="dv">59</span> <span class="dv">24</span> <span class="dv">44</span> <span class="dv">19</span> <span class="dv">54</span> <span class="dv">51</span> <span class="dv">26</span>  <span class="dv">0</span></span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a>     <span class="dv">39</span>]</span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true" tabindex="-1"></a>    <span class="op">----------</span></span>
<span id="cb4-35"><a href="#cb4-35" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-36"><a href="#cb4-36" aria-hidden="true" tabindex="-1"></a>    PhoneService</span>
<span id="cb4-37"><a href="#cb4-37" aria-hidden="true" tabindex="-1"></a>    [<span class="st">&#39;No&#39;</span> <span class="st">&#39;Yes&#39;</span>]</span>
<span id="cb4-38"><a href="#cb4-38" aria-hidden="true" tabindex="-1"></a>    <span class="op">----------</span></span>
<span id="cb4-39"><a href="#cb4-39" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-40"><a href="#cb4-40" aria-hidden="true" tabindex="-1"></a>    MultipleLines</span>
<span id="cb4-41"><a href="#cb4-41" aria-hidden="true" tabindex="-1"></a>    [<span class="st">&#39;No phone service&#39;</span> <span class="st">&#39;No&#39;</span> <span class="st">&#39;Yes&#39;</span>]</span>
<span id="cb4-42"><a href="#cb4-42" aria-hidden="true" tabindex="-1"></a>    <span class="op">----------</span></span>
<span id="cb4-43"><a href="#cb4-43" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-44"><a href="#cb4-44" aria-hidden="true" tabindex="-1"></a>    InternetService</span>
<span id="cb4-45"><a href="#cb4-45" aria-hidden="true" tabindex="-1"></a>    [<span class="st">&#39;DSL&#39;</span> <span class="st">&#39;Fiber optic&#39;</span> <span class="st">&#39;No&#39;</span>]</span>
<span id="cb4-46"><a href="#cb4-46" aria-hidden="true" tabindex="-1"></a>    <span class="op">----------</span></span>
<span id="cb4-47"><a href="#cb4-47" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-48"><a href="#cb4-48" aria-hidden="true" tabindex="-1"></a>    OnlineSecurity</span>
<span id="cb4-49"><a href="#cb4-49" aria-hidden="true" tabindex="-1"></a>    [<span class="st">&#39;No&#39;</span> <span class="st">&#39;Yes&#39;</span> <span class="st">&#39;No internet service&#39;</span>]</span>
<span id="cb4-50"><a href="#cb4-50" aria-hidden="true" tabindex="-1"></a>    <span class="op">----------</span></span>
<span id="cb4-51"><a href="#cb4-51" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-52"><a href="#cb4-52" aria-hidden="true" tabindex="-1"></a>    OnlineBackup</span>
<span id="cb4-53"><a href="#cb4-53" aria-hidden="true" tabindex="-1"></a>    [<span class="st">&#39;Yes&#39;</span> <span class="st">&#39;No&#39;</span> <span class="st">&#39;No internet service&#39;</span>]</span>
<span id="cb4-54"><a href="#cb4-54" aria-hidden="true" tabindex="-1"></a>    <span class="op">----------</span></span>
<span id="cb4-55"><a href="#cb4-55" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-56"><a href="#cb4-56" aria-hidden="true" tabindex="-1"></a>    DeviceProtection</span>
<span id="cb4-57"><a href="#cb4-57" aria-hidden="true" tabindex="-1"></a>    [<span class="st">&#39;No&#39;</span> <span class="st">&#39;Yes&#39;</span> <span class="st">&#39;No internet service&#39;</span>]</span>
<span id="cb4-58"><a href="#cb4-58" aria-hidden="true" tabindex="-1"></a>    <span class="op">----------</span></span>
<span id="cb4-59"><a href="#cb4-59" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-60"><a href="#cb4-60" aria-hidden="true" tabindex="-1"></a>    TechSupport</span>
<span id="cb4-61"><a href="#cb4-61" aria-hidden="true" tabindex="-1"></a>    [<span class="st">&#39;No&#39;</span> <span class="st">&#39;Yes&#39;</span> <span class="st">&#39;No internet service&#39;</span>]</span>
<span id="cb4-62"><a href="#cb4-62" aria-hidden="true" tabindex="-1"></a>    <span class="op">----------</span></span>
<span id="cb4-63"><a href="#cb4-63" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-64"><a href="#cb4-64" aria-hidden="true" tabindex="-1"></a>    StreamingTV</span>
<span id="cb4-65"><a href="#cb4-65" aria-hidden="true" tabindex="-1"></a>    [<span class="st">&#39;No&#39;</span> <span class="st">&#39;Yes&#39;</span> <span class="st">&#39;No internet service&#39;</span>]</span>
<span id="cb4-66"><a href="#cb4-66" aria-hidden="true" tabindex="-1"></a>    <span class="op">----------</span></span>
<span id="cb4-67"><a href="#cb4-67" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-68"><a href="#cb4-68" aria-hidden="true" tabindex="-1"></a>    StreamingMovies</span>
<span id="cb4-69"><a href="#cb4-69" aria-hidden="true" tabindex="-1"></a>    [<span class="st">&#39;No&#39;</span> <span class="st">&#39;Yes&#39;</span> <span class="st">&#39;No internet service&#39;</span>]</span>
<span id="cb4-70"><a href="#cb4-70" aria-hidden="true" tabindex="-1"></a>    <span class="op">----------</span></span>
<span id="cb4-71"><a href="#cb4-71" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-72"><a href="#cb4-72" aria-hidden="true" tabindex="-1"></a>    Contract</span>
<span id="cb4-73"><a href="#cb4-73" aria-hidden="true" tabindex="-1"></a>    [<span class="st">&#39;Month-to-month&#39;</span> <span class="st">&#39;One year&#39;</span> <span class="st">&#39;Two year&#39;</span>]</span>
<span id="cb4-74"><a href="#cb4-74" aria-hidden="true" tabindex="-1"></a>    <span class="op">----------</span></span>
<span id="cb4-75"><a href="#cb4-75" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-76"><a href="#cb4-76" aria-hidden="true" tabindex="-1"></a>    PaperlessBilling</span>
<span id="cb4-77"><a href="#cb4-77" aria-hidden="true" tabindex="-1"></a>    [<span class="st">&#39;Yes&#39;</span> <span class="st">&#39;No&#39;</span>]</span>
<span id="cb4-78"><a href="#cb4-78" aria-hidden="true" tabindex="-1"></a>    <span class="op">----------</span></span>
<span id="cb4-79"><a href="#cb4-79" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-80"><a href="#cb4-80" aria-hidden="true" tabindex="-1"></a>    PaymentMethod</span>
<span id="cb4-81"><a href="#cb4-81" aria-hidden="true" tabindex="-1"></a>    [<span class="st">&#39;Electronic check&#39;</span> <span class="st">&#39;Mailed check&#39;</span> <span class="st">&#39;Bank transfer (automatic)&#39;</span></span>
<span id="cb4-82"><a href="#cb4-82" aria-hidden="true" tabindex="-1"></a>     <span class="st">&#39;Credit card (automatic)&#39;</span>]</span>
<span id="cb4-83"><a href="#cb4-83" aria-hidden="true" tabindex="-1"></a>    <span class="op">----------</span></span>
<span id="cb4-84"><a href="#cb4-84" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-85"><a href="#cb4-85" aria-hidden="true" tabindex="-1"></a>    MonthlyCharges</span>
<span id="cb4-86"><a href="#cb4-86" aria-hidden="true" tabindex="-1"></a>    [<span class="fl">29.85</span> <span class="fl">56.95</span> <span class="fl">53.85</span> ... <span class="fl">63.1</span>  <span class="fl">44.2</span>  <span class="fl">78.7</span> ]</span>
<span id="cb4-87"><a href="#cb4-87" aria-hidden="true" tabindex="-1"></a>    <span class="op">----------</span></span>
<span id="cb4-88"><a href="#cb4-88" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-89"><a href="#cb4-89" aria-hidden="true" tabindex="-1"></a>    TotalCharges</span>
<span id="cb4-90"><a href="#cb4-90" aria-hidden="true" tabindex="-1"></a>    [<span class="st">&#39;29.85&#39;</span> <span class="st">&#39;1889.5&#39;</span> <span class="st">&#39;108.15&#39;</span> ... <span class="st">&#39;346.45&#39;</span> <span class="st">&#39;306.6&#39;</span> <span class="st">&#39;6844.5&#39;</span>]</span>
<span id="cb4-91"><a href="#cb4-91" aria-hidden="true" tabindex="-1"></a>    <span class="op">----------</span></span>
<span id="cb4-92"><a href="#cb4-92" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-93"><a href="#cb4-93" aria-hidden="true" tabindex="-1"></a>    Churn</span>
<span id="cb4-94"><a href="#cb4-94" aria-hidden="true" tabindex="-1"></a>    [<span class="st">&#39;No&#39;</span> <span class="st">&#39;Yes&#39;</span>]</span>
<span id="cb4-95"><a href="#cb4-95" aria-hidden="true" tabindex="-1"></a>    <span class="op">----------</span></span></code></pre></div>
<ul>
<li>Nuestro dataset contiene solo 3 atributos numéricos: <code>SeniorCitizen</code>, <code>tenure</code> y <code>MonthlyCharges</code>.</li>
<li>Es evidente que el atributo <code>TotalCharges</code> también debería ser numérico así que vamos a proceder a cambiar el tipo de dato.</li>
<li>La variable numérica <code>SeniorCitizen</code> toma actualmente dos valores: 0 si el cliente es menor de 65 años y 1 si es mayor. En casos como este, suele ser conveniente tratar a la variable como categórica.</li>
<li>También vamos a proceder a eliminar el atributo <code>customerID</code> ya que no es útil para ningún análisis.</li>
</ul>
<div class="sourceCode" id="cb5"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>customers[<span class="st">&#39;TotalCharges&#39;</span>] <span class="op">=</span> pd.to_numeric(customers[<span class="st">&#39;TotalCharges&#39;</span>], errors <span class="op">=</span> <span class="st">&#39;coerce&#39;</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>customers[<span class="st">&#39;SeniorCitizen&#39;</span>] <span class="op">=</span> customers.SeniorCitizen.astype(<span class="st">&#39;object&#39;</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>customers.drop([<span class="st">&quot;customerID&quot;</span>], axis <span class="op">=</span> <span class="dv">1</span>, inplace <span class="op">=</span> <span class="va">True</span>)</span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>customers.describe()</span></code></pre></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<div style="overflow-x:auto;">
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th>
</th>
<th>
tenure
</th>
<th>
MonthlyCharges
</th>
<th>
TotalCharges
</th>
</tr>
</thead>
<tbody>
<tr>
<th>
count
</th>
<td>
7043.00
</td>
<td>
7043.00
</td>
<td>
7032.00
</td>
</tr>
<tr>
<th>
mean
</th>
<td>
32.37
</td>
<td>
64.76
</td>
<td>
2283.30
</td>
</tr>
<tr>
<th>
std
</th>
<td>
24.55
</td>
<td>
30.09
</td>
<td>
2266.77
</td>
</tr>
<tr>
<th>
min
</th>
<td>
0.00
</td>
<td>
18.25
</td>
<td>
18.80
</td>
</tr>
<tr>
<th>
25%
</th>
<td>
9.00
</td>
<td>
35.50
</td>
<td>
401.45
</td>
</tr>
<tr>
<th>
50%
</th>
<td>
29.00
</td>
<td>
70.35
</td>
<td>
1397.47
</td>
</tr>
<tr>
<th>
75%
</th>
<td>
55.00
</td>
<td>
89.85
</td>
<td>
3794.73
</td>
</tr>
<tr>
<th>
max
</th>
<td>
72.00
</td>
<td>
118.75
</td>
<td>
8684.80
</td>
</tr>
</tbody>
</table>
</div>
<p> </p>
</div>
<div id="análisis-gráfico" class="section level2">
<h2>3.3. Análisis Gráfico</h2>
<p>Una buena técnica para comenzar a explorar nuestro dataset es observar cómo se distribuyen las diferentes variables con respecto a nuestra variable objetivo <code>Churn</code>, aquella que queremos predecir. Esto nos ayudará a comprender si tienen relación entre ellas lo que nos permitirá tener una primera aproximación para determinar cuales serán buenas variables predictoras.</p>
<p> </p>
<div id="variable-de-respuesta" class="section level3">
<h3>3.3.1. Variable de Respuesta</h3>
<p><em>Variable Churn</em></p>
<div class="sourceCode" id="cb7"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Distribución de la variable objetivo</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(customers[<span class="st">&#39;Churn&#39;</span>].value_counts(normalize <span class="op">=</span> <span class="va">True</span>).mul(<span class="dv">100</span>).<span class="bu">round</span>(<span class="dv">2</span>))</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    No     <span class="fl">73.46</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>    Yes    <span class="fl">26.54</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>    Name: Churn, dtype: float64</span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>sns.countplot(<span class="st">&quot;Churn&quot;</span>, data <span class="op">=</span> customers)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>sns.despine()</span></code></pre></div>
<p> 
<img src="/img/churn_prediction_files/output_21_1.png" />
 </p>
<p> </p>
</div>
<div id="variables-numéricas" class="section level3">
<h3>3.3.2. Variables Numéricas</h3>
<p><em>Variables Tenure, Monthly Charges y Total Charges</em></p>
<p>Tenemos tres variables numéricas, estas son <code>tenure</code>, <code>MonthlyCharges</code> y <code>TotalCharges</code>. Realizaremos gráficos de densidad para observar qué relación tienen con nuestra variable objetivo.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Función para gráficar </span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="co"># =====================</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> kdeplot(feature): </span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>    plt.figure(figsize<span class="op">=</span>(<span class="dv">9</span>, <span class="dv">4</span>))</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>    plt.title(<span class="st">&quot;Gráfico de densidad para </span><span class="sc">{}</span><span class="st">&quot;</span>.<span class="bu">format</span>(feature))</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>    ax0 <span class="op">=</span> sns.kdeplot(customers[customers[<span class="st">&#39;Churn&#39;</span>] <span class="op">==</span> <span class="st">&#39;No&#39;</span>][feature],</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>                       color <span class="op">=</span> <span class="st">&#39;navy&#39;</span>, label<span class="op">=</span> <span class="st">&#39;Churn: No&#39;</span>, shade <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>    ax1 <span class="op">=</span> sns.kdeplot(customers[customers[<span class="st">&#39;Churn&#39;</span>] <span class="op">==</span> <span class="st">&#39;Yes&#39;</span>][feature],</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>                       color <span class="op">=</span> <span class="st">&#39;orange&#39;</span>, label <span class="op">=</span> <span class="st">&#39;Churn: Yes&#39;</span>, shade <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>    plt.xlabel(feature)</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>    plt.legend()</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>    sns.despine()</span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>kdeplot(<span class="st">&#39;tenure&#39;</span>)</span></code></pre></div>
<p> 
<img src="/img/churn_prediction_files/output_26_0.png" />
 </p>
<ul>
<li>De la primer gráfica observamos como los clientes con contratos más cortos son los que más abandonaron la empresa.</li>
</ul>
<div class="sourceCode" id="cb11"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>kdeplot(<span class="st">&#39;MonthlyCharges&#39;</span>)</span></code></pre></div>
<p> 
<img src="/img/churn_prediction_files/output_28_0.png" />
 </p>
<ul>
<li>Los clientes con cargos mensuales altos fueron los que más prescindieron de los servicios de la empresa.</li>
</ul>
<div class="sourceCode" id="cb12"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>kdeplot(<span class="st">&#39;TotalCharges&#39;</span>)</span></code></pre></div>
<p> 
<img src="/img/churn_prediction_files/output_30_0.png" />
 </p>
<ul>
<li>Observamos que los clientes con bajos costos totales son los que más abandonaron la empresa y esto es porque existe una relación entre <code>TotalCharges</code>, <code>MonthylyCharges</code> y <code>tenure</code> ya que el primero se obtiene multiplicando el monto mensual por los meses de contrato. Si bien el cálculo no resulta exacto es porque probablemente los clientes con largos contratos reciban algún tipo de descuento. Esta relación la veremos más claramente en un gráfico de correlación.</li>
</ul>
<p> </p>
</div>
<div id="variables-categóricas" class="section level3">
<h3>3.3.3. Variables Categóricas</h3>
<p>Por otro lado, tenemos 15 variables categóricas las cuales vamos a graficar con respecto a <code>Churn</code>y
así observar como es su comportamiento.</p>
<p><em>Variable Senior Citizen</em></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Función para graficar porcentajes</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="co"># =================================</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> barplot_percentages(feature, orient <span class="op">=</span> <span class="st">&#39;v&#39;</span>, axis_name <span class="op">=</span> <span class="st">&quot;percentage of customers&quot;</span>):</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    ratios <span class="op">=</span> pd.DataFrame()</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    g <span class="op">=</span> customers.groupby(feature)[<span class="st">&quot;Churn&quot;</span>].value_counts()</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>    g <span class="op">=</span> g.rename({<span class="st">&quot;Churn&quot;</span>: axis_name}, axis <span class="op">=</span> <span class="dv">1</span>).reset_index()</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>    g[axis_name] <span class="op">=</span> g[axis_name] <span class="op">/</span> <span class="bu">len</span>(customers)</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> orient <span class="op">==</span> <span class="st">&#39;v&#39;</span>:</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>        ax <span class="op">=</span> sns.barplot(x<span class="op">=</span>feature, y<span class="op">=</span> axis_name, hue<span class="op">=</span><span class="st">&#39;Churn&#39;</span>, data<span class="op">=</span>g, orient<span class="op">=</span>orient)</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>        ax.set_yticklabels([<span class="st">&#39;{:,.0%}&#39;</span>.<span class="bu">format</span>(y) <span class="cf">for</span> y <span class="kw">in</span> ax.get_yticks()])</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>        ax <span class="op">=</span> sns.barplot(x <span class="op">=</span> axis_name, y <span class="op">=</span> feature, hue <span class="op">=</span> <span class="st">&#39;Churn&#39;</span>, data <span class="op">=</span> g, orient <span class="op">=</span> orient)</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>        ax.set_xticklabels([<span class="st">&#39;{:,.0%}&#39;</span>.<span class="bu">format</span>(x) <span class="cf">for</span> x <span class="kw">in</span> ax.get_xticks()])</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>    ax.plot()</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>    sns.despine()</span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>barplot_percentages(<span class="st">&quot;SeniorCitizen&quot;</span>)</span></code></pre></div>
<p> 
<img src="/img/churn_prediction_files/output_36_0.png" />
 </p>
<div class="sourceCode" id="cb15"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(customers[<span class="st">&#39;SeniorCitizen&#39;</span>].value_counts(normalize <span class="op">=</span> <span class="va">True</span>).mul(<span class="dv">100</span>).<span class="bu">round</span>(<span class="dv">2</span>))</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>       SeniorCitizen </span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>    <span class="dv">0</span>          <span class="fl">83.79</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span>          <span class="fl">16.21</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>    </span></code></pre></div>
<div class="sourceCode" id="cb16"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(customers.groupby(<span class="st">&#39;SeniorCitizen&#39;</span>)[<span class="st">&#39;Churn&#39;</span>].value_counts(normalize <span class="op">=</span> <span class="va">True</span>).mul(<span class="dv">100</span>).<span class="bu">round</span>(<span class="dv">2</span>))</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>                         Churn</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>    SeniorCitizen Churn       </span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>    <span class="dv">0</span>             No     <span class="fl">76.39</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>                  Yes    <span class="fl">23.61</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span>             No     <span class="fl">58.32</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>                  Yes    <span class="fl">41.68</span></span></code></pre></div>
<p>Observando este atributo podemos determinar que los clientes clasificados como <code>SeniorCitizen</code> representan el 16%, sin embargo son quienes más abandonaron la empresa, alrededor del 42% mientras que en el otro grupo representó un 24%.</p>
<p><em>Variables Partner y Dependents</em></p>
<div class="sourceCode" id="cb17"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>fig, axis <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">12</span>,<span class="dv">4</span>))</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>axis[<span class="dv">0</span>].set_title(<span class="st">&quot;Has partner&quot;</span>)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>axis[<span class="dv">1</span>].set_title(<span class="st">&quot;Has dependents&quot;</span>)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>axis_y <span class="op">=</span> <span class="st">&quot;percentage of customers&quot;</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráfico para variable Partner</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="co"># =============================</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>gp_partner <span class="op">=</span> customers.groupby(<span class="st">&#39;Partner&#39;</span>)[<span class="st">&quot;Churn&quot;</span>].value_counts() <span class="op">/</span> <span class="bu">len</span>(customers)</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>gp_partner <span class="op">=</span> gp_partner.rename({<span class="st">&quot;Churn&quot;</span>: axis_y}, axis <span class="op">=</span> <span class="dv">1</span>).reset_index()</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> sns.barplot(x <span class="op">=</span> <span class="st">&#39;Partner&#39;</span>, y <span class="op">=</span> axis_y, hue<span class="op">=</span><span class="st">&#39;Churn&#39;</span>, data <span class="op">=</span> gp_partner, ax <span class="op">=</span> axis[<span class="dv">0</span>])</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>sns.despine()</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráfico para variable Dependents</span></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a><span class="co"># ================================</span></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>gp_dep <span class="op">=</span> customers.groupby(<span class="st">&#39;Dependents&#39;</span>)[<span class="st">&quot;Churn&quot;</span>].value_counts() <span class="op">/</span> <span class="bu">len</span>(customers)</span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>gp_dep <span class="op">=</span> gp_dep.rename({<span class="st">&quot;Churn&quot;</span>: axis_y}, axis<span class="op">=</span><span class="dv">1</span>).reset_index()</span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> sns.barplot(x <span class="op">=</span> <span class="st">&#39;Dependents&#39;</span>, y <span class="op">=</span> axis_y, hue <span class="op">=</span> <span class="st">&#39;Churn&#39;</span>, data <span class="op">=</span> gp_dep, ax <span class="op">=</span> axis[<span class="dv">1</span>])</span></code></pre></div>
<p> 
<img src="/img/churn_prediction_files/output_41_0.png" />
 </p>
<p>Algunas observaciones de las gráficas anteriores son:
- Clientes solteros abandonaron la empresa en mayor proporción que clientes con pareja.
- Clientes sin personas a cargo abandonaron la empresa en mayor proporción que aquellos que no tienen dependientes.</p>
<p><em>Variable gender</em></p>
<div class="sourceCode" id="cb18"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>barplot_percentages(<span class="st">&quot;gender&quot;</span>)</span></code></pre></div>
<p> 
<img src="/img/churn_prediction_files/output_44_0.png" />
 </p>
<ul>
<li>Clientes de ambos sexos abandonan la empresa en iguales proporciones por lo que no será una buena variable predictora.</li>
</ul>
<p><em>Variable Phone Services y Multiple Lines</em></p>
<p>El análisis de estas variables las podemos resumir graficando <code>MultipleLines</code> ya que aquí dentro encontramos los clientes que tienen o no servicio de telefonía. Esto implica que el atributo <code>PhoneServices</code> es redundante para el modelo.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize <span class="op">=</span> (<span class="dv">9</span>,<span class="dv">4</span>))</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>barplot_percentages(<span class="st">&quot;MultipleLines&quot;</span>, orient <span class="op">=</span> <span class="st">&#39;h&#39;</span>)</span></code></pre></div>
<p> 
<img src="/img/churn_prediction_files/output_48_0.png" />
 </p>
<ul>
<li>Existe una mínima diferencia en términos de proporción a favor de más abandonos para quienes tenían múltiples servicios de telefonía.</li>
</ul>
<div class="sourceCode" id="cb20"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(customers.groupby(<span class="st">&#39;MultipleLines&#39;</span>)[<span class="st">&#39;Churn&#39;</span>].value_counts(normalize <span class="op">=</span> <span class="va">True</span>).mul(<span class="dv">100</span>).<span class="bu">round</span>(<span class="dv">2</span>))</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>    MultipleLines     Churn</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>    No                No       <span class="fl">74.96</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>                      Yes      <span class="fl">25.04</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>    No phone service  No       <span class="fl">75.07</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>                      Yes      <span class="fl">24.93</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>    Yes               No       <span class="fl">71.39</span></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>                      Yes      <span class="fl">28.61</span></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>    Name: Churn, dtype: float64</span></code></pre></div>
<p><em>Variables de Servicios Adicionales</em></p>
<div class="sourceCode" id="cb21"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>cols <span class="op">=</span> [<span class="st">&quot;OnlineSecurity&quot;</span>, <span class="st">&quot;OnlineBackup&quot;</span>, <span class="st">&quot;DeviceProtection&quot;</span>,</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;TechSupport&quot;</span>, <span class="st">&quot;StreamingTV&quot;</span>, <span class="st">&quot;StreamingMovies&quot;</span>]</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>df1 <span class="op">=</span> pd.melt(customers[customers[<span class="st">&quot;InternetService&quot;</span>] <span class="op">!=</span> <span class="st">&quot;No&quot;</span>][cols]).rename({<span class="st">&#39;value&#39;</span>: <span class="st">&#39;Has service&#39;</span>}, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize <span class="op">=</span> (<span class="dv">10</span>, <span class="fl">4.5</span>))</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> sns.countplot(data <span class="op">=</span> df1, x <span class="op">=</span> <span class="st">&#39;variable&#39;</span>, hue <span class="op">=</span> <span class="st">&#39;Has service&#39;</span>, orient <span class="op">=</span> <span class="st">&#39;h&#39;</span>)</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>ax.<span class="bu">set</span>(xlabel <span class="op">=</span> <span class="st">&#39;Additional service&#39;</span>, ylabel <span class="op">=</span> <span class="st">&#39;Num of customers&#39;</span>)</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Número de clientes por tipo de servicio&#39;</span>)</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>sns.despine()</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<p> 
<img src="/img/churn_prediction_files/output_52_0.png" />
 </p>
<div class="sourceCode" id="cb22"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="fl">4.5</span>))</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>df1 <span class="op">=</span> customers[(customers.InternetService <span class="op">!=</span> <span class="st">&quot;No&quot;</span>) <span class="op">&amp;</span> (customers.Churn <span class="op">==</span> <span class="st">&quot;Yes&quot;</span>)]</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>df1 <span class="op">=</span> pd.melt(df1[cols]).rename({<span class="st">&#39;value&#39;</span>: <span class="st">&#39;Has service&#39;</span>}, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> sns.countplot(data<span class="op">=</span>df1, x<span class="op">=</span><span class="st">&#39;variable&#39;</span>, hue<span class="op">=</span><span class="st">&#39;Has service&#39;</span>, hue_order<span class="op">=</span>[<span class="st">&#39;No&#39;</span>, <span class="st">&#39;Yes&#39;</span>])</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>ax.<span class="bu">set</span>(xlabel<span class="op">=</span><span class="st">&#39;Additional service&#39;</span>, ylabel<span class="op">=</span><span class="st">&#39;Num of churns&#39;</span>)</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Número de abandonos por tipo de servicio&#39;</span>)</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>sns.despine()</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<p> 
<img src="/img/churn_prediction_files/output_53_0.png" />
 </p>
<ul>
<li>De las gráficas anteriores podemos observar como los clientes con servicios de Streaming TV y Streaming Movies abandonaron la empresa en igual proporción, en otras palabras no se observa una relación entre clientes que se van y poseen este servicio. En cambio, sí se observa que los clientes que poseían los otros servicios son menos propensos a abandonar la empresa, probablemente sienten que sus necesidades son mejor atendidas.</li>
</ul>
<p><em>Variable Payment Method</em></p>
<div class="sourceCode" id="cb23"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize <span class="op">=</span> (<span class="dv">9</span>,<span class="dv">4</span>))</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Método de pago&#39;</span>)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>barplot_percentages(<span class="st">&quot;PaymentMethod&quot;</span>, orient <span class="op">=</span> <span class="st">&#39;h&#39;</span>)</span></code></pre></div>
<p> 
<img src="/img/churn_prediction_files/output_56_0.png" />
 </p>
<div class="sourceCode" id="cb24"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(customers[<span class="st">&#39;PaymentMethod&#39;</span>].value_counts(normalize <span class="op">=</span> <span class="va">True</span>).mul(<span class="dv">100</span>).<span class="bu">round</span>(<span class="dv">2</span>))</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>    Electronic check             <span class="fl">33.58</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>    Mailed check                 <span class="fl">22.89</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>    Bank transfer (automatic)    <span class="fl">21.92</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>    Credit card (automatic)      <span class="fl">21.61</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>    Name: PaymentMethod, dtype: float64</span></code></pre></div>
<ul>
<li>Claramente se observa una mayor proporción de abandonos para clientes que pagaban con cheque electrónico. Para el resto de los métodos de pago los abandonos se han repartido proporcionalmente.</li>
<li>El pago por cheque electrónico es también el método preferido por los clientes.</li>
</ul>
<p><em>Variable Contract</em></p>
<div class="sourceCode" id="cb25"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize <span class="op">=</span> (<span class="dv">9</span>,<span class="dv">4</span>))</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Tipo de Contrato&#39;</span>)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>barplot_percentages(<span class="st">&quot;Contract&quot;</span>, orient <span class="op">=</span> <span class="st">&#39;h&#39;</span>)</span></code></pre></div>
<p> 
<img src="/img/churn_prediction_files/output_60_0.png" />
 </p>
<div class="sourceCode" id="cb26"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(customers[<span class="st">&#39;Contract&#39;</span>].value_counts(normalize <span class="op">=</span> <span class="va">True</span>).mul(<span class="dv">100</span>).<span class="bu">round</span>(<span class="dv">2</span>))</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>    Month<span class="op">-</span>to<span class="op">-</span>month    <span class="fl">55.02</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>    Two year          <span class="fl">24.07</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>    One year          <span class="fl">20.91</span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>    Name: Contract, dtype: float64</span></code></pre></div>
<div class="sourceCode" id="cb27"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(customers.groupby(<span class="st">&#39;Contract&#39;</span>)[<span class="st">&#39;Churn&#39;</span>].value_counts(normalize <span class="op">=</span> <span class="va">True</span>).mul(<span class="dv">100</span>).<span class="bu">round</span>(<span class="dv">2</span>))</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>    Contract        Churn</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>    Month<span class="op">-</span>to<span class="op">-</span>month  No       <span class="fl">57.29</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>                    Yes      <span class="fl">42.71</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>    One year        No       <span class="fl">88.73</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>                    Yes      <span class="fl">11.27</span></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>    Two year        No       <span class="fl">97.17</span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>                    Yes       <span class="fl">2.83</span></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>    Name: Churn, dtype: float64</span></code></pre></div>
<ul>
<li>Los clientes con con contrato mensual representan el 55% de los clientes. Dentro de este grupo encontramos la mayor proporción de abandonos la cuál alcanza un 42%.</li>
<li>Para los otros tipos de contrato observamos una tasa de abandono del 11.2% y de 2.8% para contratos de uno y dos años respectivamente.</li>
<li>Debía de esperarse este tipo de comportamiento ya que generalmente los clientes que prefieren contratos mensuales son aquellos que no están muy convencidos con el servicio o no quieren sentirse comprometidos generando una relación a largo término que involucra el riesgo de pagar todo el contrato sin saber si realmente estarán satisfechos.</li>
</ul>
<p><em>Variable Internet Service</em></p>
<div class="sourceCode" id="cb28"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize <span class="op">=</span> (<span class="dv">9</span>,<span class="dv">4</span>))</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Servicio de Internet&#39;</span>)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>barplot_percentages(<span class="st">&quot;InternetService&quot;</span>, orient <span class="op">=</span> <span class="st">&#39;h&#39;</span>)</span></code></pre></div>
<p> 
<img src="/img/churn_prediction_files/output_65_0.png" />
 </p>
<div class="sourceCode" id="cb29"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(customers.groupby(<span class="st">&#39;InternetService&#39;</span>)[<span class="st">&#39;Churn&#39;</span>].value_counts(normalize <span class="op">=</span> <span class="va">True</span>).mul(<span class="dv">100</span>).<span class="bu">round</span>(<span class="dv">2</span>))</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>    InternetService  Churn</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>    DSL              No       <span class="fl">81.04</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>                     Yes      <span class="fl">18.96</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>    Fiber optic      No       <span class="fl">58.11</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>                     Yes      <span class="fl">41.89</span></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>    No               No       <span class="fl">92.60</span></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>                     Yes       <span class="fl">7.40</span></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>    Name: Churn, dtype: float64</span></code></pre></div>
<ul>
<li>La mayor proporción de abandonos se observa en los clientes que tienen contratado el servicio de fibra óptica. En contraste, los abandonos han sido muy bajos en clientes sin servicio de internet.</li>
</ul>
<p><em>Variable Paperless Billing</em></p>
<div class="sourceCode" id="cb30"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize <span class="op">=</span> (<span class="dv">9</span>,<span class="dv">4</span>))</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Tipo de recibo&#39;</span>)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>barplot_percentages(<span class="st">&quot;PaperlessBilling&quot;</span>, orient <span class="op">=</span> <span class="st">&#39;h&#39;</span>)</span></code></pre></div>
<p> 
<img src="/img/churn_prediction_files/output_69_0.png" />
 </p>
<div class="sourceCode" id="cb31"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(customers[<span class="st">&#39;PaperlessBilling&#39;</span>].value_counts(normalize <span class="op">=</span> <span class="va">True</span>).mul(<span class="dv">100</span>).<span class="bu">round</span>(<span class="dv">2</span>))</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>    Yes    <span class="fl">59.22</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>    No     <span class="fl">40.78</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>    Name: PaperlessBilling, dtype: float64</span></code></pre></div>
<ul>
<li>El 59% de los clientes optaron por recibo electrónico y son también quienes más abandonaron la empresa.</li>
</ul>
<p> </p>
</div>
</div>
<div id="análisis-de-correlación" class="section level2">
<h2>3.4. Análisis de Correlación</h2>
<p>Algunos modelos se ven perjudicados si incorporan predictores altamente correlacionados.
Por esta razón, es conveniente estudiar el grado de correlación entre las variables disponibles.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>corr_matrix <span class="op">=</span> customers.corr()</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>sns.heatmap(corr_matrix, annot <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<p> 
<img src="/img/churn_prediction_files/output_74_0.png" />
 </p>
<ul>
<li>Las variables <code>tenure</code> y <code>TotalCharges</code> están altamente correlacionadas. Esto es lo que ya se podía observar en los gráficos de densidad mostrados anteriormente. Vamos a eliminar la variable <code>TotalCharges</code>ya que no aporta información extra al modelo.</li>
</ul>
<p> </p>
</div>
</div>
<div id="data-cleaning" class="section level1">
<h1>4. Data Cleaning</h1>
<p> </p>
<div id="valores-ausentes" class="section level2">
<h2>4.1. Valores Ausentes</h2>
<p>La gran mayoría de algoritmos no aceptan observaciones incompletas, por lo que, cuando el set de datos contiene valores ausentes, se puede:</p>
<ul>
<li>Eliminar aquellas observaciones que estén incompletas.</li>
<li>Eliminar aquellas variables que contengan valores ausentes.</li>
<li>Tratar de estimar los valores ausentes empleando el resto de información disponible (imputación).</li>
</ul>
<div class="sourceCode" id="cb33"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>customers.isnull().<span class="bu">sum</span>()</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>    gender               <span class="dv">0</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>    SeniorCitizen        <span class="dv">0</span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>    Partner              <span class="dv">0</span></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>    Dependents           <span class="dv">0</span></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>    tenure               <span class="dv">0</span></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>    PhoneService         <span class="dv">0</span></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>    MultipleLines        <span class="dv">0</span></span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>    InternetService      <span class="dv">0</span></span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>    OnlineSecurity       <span class="dv">0</span></span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>    OnlineBackup         <span class="dv">0</span></span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>    DeviceProtection     <span class="dv">0</span></span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a>    TechSupport          <span class="dv">0</span></span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a>    StreamingTV          <span class="dv">0</span></span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a>    StreamingMovies      <span class="dv">0</span></span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a>    Contract             <span class="dv">0</span></span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a>    PaperlessBilling     <span class="dv">0</span></span>
<span id="cb33-20"><a href="#cb33-20" aria-hidden="true" tabindex="-1"></a>    PaymentMethod        <span class="dv">0</span></span>
<span id="cb33-21"><a href="#cb33-21" aria-hidden="true" tabindex="-1"></a>    MonthlyCharges       <span class="dv">0</span></span>
<span id="cb33-22"><a href="#cb33-22" aria-hidden="true" tabindex="-1"></a>    TotalCharges        <span class="dv">11</span></span>
<span id="cb33-23"><a href="#cb33-23" aria-hidden="true" tabindex="-1"></a>    Churn                <span class="dv">0</span></span>
<span id="cb33-24"><a href="#cb33-24" aria-hidden="true" tabindex="-1"></a>    dtype: int64</span></code></pre></div>
<p>Observamos que tenemos 11 valores nulos en la variable <code>TotalCharges</code>. Ya que esta variable es poco informativa vamos a pasar eliminarla por completo.</p>
<p> </p>
</div>
<div id="atributos-innecesarios" class="section level2">
<h2>4.2. Atributos Innecesarios</h2>
<p>Al comienzo del análisis hemos eliminado el atributo <code>CustomerID</code> y ahora pasaremos a eliminar el resto de variables que son redundantes y no aportan información predictora.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>atributos_drop <span class="op">=</span> [<span class="st">&#39;TotalCharges&#39;</span>,</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>                  <span class="st">&#39;gender&#39;</span>,</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>                  <span class="st">&#39;StreamingTV&#39;</span>,</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>                  <span class="st">&#39;StreamingMovies&#39;</span>,</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>                  <span class="st">&#39;PhoneService&#39;</span>] </span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>customers_prep <span class="op">=</span> customers.drop(atributos_drop, axis <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(customers.shape)</span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(customers_prep.shape)</span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>    (<span class="dv">7043</span>, <span class="dv">20</span>)</span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>    (<span class="dv">7043</span>, <span class="dv">15</span>)</span></code></pre></div>
<p> </p>
</div>
<div id="registros-duplicados" class="section level2">
<h2>4.3. Registros Duplicados</h2>
<p>Los registros duplicados pueden causar problemas al momento de separar los datos en datos de entrenamiento y de prueba ya que podría ocurrir que aleatoriamente estos registros queden en una sola partición generando que el modelo no ajuste correctamente.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Contamos cuántos registros duplicados tenemos en el dataset</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="co"># ==========================================================</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>dup <span class="op">=</span> customers_prep.duplicated().<span class="bu">sum</span>()</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;Registros duplicados: </span><span class="sc">{}</span><span class="st">&#39;</span>.<span class="bu">format</span>(dup))</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Eliminamos registros duplicados</span></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a><span class="co"># ===============================</span></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>customers_prep.drop_duplicates(inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(customers_prep.shape)</span></code></pre></div>
<pre><code>Registros duplicados: 60
(6983, 15)</code></pre>
<p> </p>
</div>
</div>
<div id="división-train-y-test" class="section level1">
<h1>5. División Train y Test</h1>
<p>Vamos a necesitar separar nuestros datos en un conjunto para entrenar al modelo y otro para probarlo, esto nos va a servir para poder verificar la performance de nuestro modelo con datos que no conoce.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> customers_prep.drop(<span class="st">&#39;Churn&#39;</span>, axis <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> customers_prep[<span class="st">&#39;Churn&#39;</span>]</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(X,</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>                                                    y, </span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>                                                    test_size <span class="op">=</span> <span class="fl">0.20</span>, </span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>                                                    random_state <span class="op">=</span> <span class="dv">15</span>,</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>                                                    stratify <span class="op">=</span> y)</span></code></pre></div>
<p> </p>
</div>
<div id="preprocesado" class="section level1">
<h1>6. Preprocesado</h1>
<p>Todo preprocesado de datos debe aprenderse con las observaciones de entrenamiento y luego aplicarse al conjunto de entrenamiento y al de test. Esto es muy importante para no violar la condición de que ninguna información procedente de las observaciones de test participe o influya en el ajuste del modelo.</p>
<p> </p>
<div id="label-encoder" class="section level2">
<h2>6.1. Label Encoder</h2>
<p>Los modelos predictivos tienen una mejor performance cuando reciben variables numéricas como datos de entrada. Lo que vamos a hacer en este punto en transformar las categorías <em>Yes</em> y <em>No</em> de la variable <code>Churn</code> en <em>unos</em> y <em>ceros</em> respectivamente.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Label encoder de la variable objetivo</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>le <span class="op">=</span> LabelEncoder()</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>le.fit(y_train)</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>y_train_prep <span class="op">=</span> le.transform(y_train)</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>y_test_prep  <span class="op">=</span> le.transform(y_test)</span></code></pre></div>
<p> </p>
</div>
<div id="one-hot-encoder-y-estandarización-de-variables." class="section level2">
<h2>6.2. One Hot Encoder y Estandarización de Variables.</h2>
<p>La binarización (one-hot-encoding) consiste en crear nuevas variables dummy con cada uno de los niveles de las variables cualitativas. Esto es similar al paso anterior pero como tenemos más de dos categorías en cada atributo es preferible utilizar esta técnica. Si etiquetaríamos a la variable <code>InternetServices</code> con 1 para <em>DSL</em>, 2 para <em>Fiber Optic</em> y 3 para <em>No</em> el modelo malinterpretaría esto dándoles un cierto orden del tipo <em>DSL</em> &lt; <em>No</em>. Esto no ocurre si solo se trata de dos categorías.</p>
<p>Otra de las transformaciones que vamos a realizar es la estandarización de las variables numéricas <code>tenure</code> y <code>MonthlyCharges</code> ya que la escala en la que se miden, así como la magnitud de sus varianzas pueden influir en los resultados del modelo ya que aquellos con mayor magnitud tendrán un mayor peso predictor a pesar de tener menos relación con la variable objetivo.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># OHE y estandarización</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>numeric_cols <span class="op">=</span> X_train.select_dtypes(include<span class="op">=</span>[<span class="st">&#39;float64&#39;</span>, <span class="st">&#39;int64&#39;</span>]) <span class="op">\</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>               .columns.to_list()</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>cat_cols <span class="op">=</span> X_train.select_dtypes(include<span class="op">=</span>[<span class="st">&#39;object&#39;</span>, <span class="st">&#39;category&#39;</span>]) <span class="op">\</span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>               .columns.to_list()</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>preprocessor <span class="op">=</span> ColumnTransformer(</span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>                   [(<span class="st">&#39;scale&#39;</span>, StandardScaler(), numeric_cols),</span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>                    (<span class="st">&#39;onehot&#39;</span>, OneHotEncoder(), cat_cols)],</span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>    remainder<span class="op">=</span><span class="st">&#39;passthrough&#39;</span>)</span></code></pre></div>
<p>Una vez que se ha definido el objeto ColumnTransformer, con el método fit() se aprenden las transformaciones con los datos de entrenamiento y se aplican a los dos conjuntos con transform().</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>X_train_prep <span class="op">=</span> preprocessor.fit_transform(X_train)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>X_test_prep  <span class="op">=</span> preprocessor.transform(X_test)</span></code></pre></div>
<p>El resultado devuelto por ColumnTransformer es un numpy array, por lo que se pierden los nombres de las columnas. Suele ser interesante poder inspeccionar cómo queda el set de datos tras el preprocesado en formato dataframe.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convertimos el output en dataframe y añadimos el nombre de las columnas</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>encoded_cat <span class="op">=</span> preprocessor.named_transformers_[<span class="st">&#39;onehot&#39;</span>].get_feature_names(cat_cols)</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>labels <span class="op">=</span> np.concatenate([numeric_cols, encoded_cat])</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>datos_train_prep <span class="op">=</span> preprocessor.transform(X_train)</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>datos_train_prep <span class="op">=</span> pd.DataFrame(datos_train_prep, columns<span class="op">=</span>labels)</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>datos_train_prep.info()</span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>    <span class="op">&lt;</span><span class="kw">class</span> <span class="st">&#39;pandas.core.frame.DataFrame&#39;</span><span class="op">&gt;</span></span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>    RangeIndex: <span class="dv">5586</span> entries, <span class="dv">0</span> to <span class="dv">5585</span></span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a>    Data columns (total <span class="dv">35</span> columns):</span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a>     <span class="co">#   Column                                   Non-Null Count  Dtype  </span></span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a>    <span class="op">---</span>  <span class="op">------</span>                                   <span class="op">--------------</span>  <span class="op">-----</span>  </span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a>     <span class="dv">0</span>   tenure                                   <span class="dv">5586</span> non<span class="op">-</span>null   float64</span>
<span id="cb41-17"><a href="#cb41-17" aria-hidden="true" tabindex="-1"></a>     <span class="dv">1</span>   MonthlyCharges                           <span class="dv">5586</span> non<span class="op">-</span>null   float64</span>
<span id="cb41-18"><a href="#cb41-18" aria-hidden="true" tabindex="-1"></a>     <span class="dv">2</span>   SeniorCitizen_0                          <span class="dv">5586</span> non<span class="op">-</span>null   float64</span>
<span id="cb41-19"><a href="#cb41-19" aria-hidden="true" tabindex="-1"></a>     <span class="dv">3</span>   SeniorCitizen_1                          <span class="dv">5586</span> non<span class="op">-</span>null   float64</span>
<span id="cb41-20"><a href="#cb41-20" aria-hidden="true" tabindex="-1"></a>     <span class="dv">4</span>   Partner_No                               <span class="dv">5586</span> non<span class="op">-</span>null   float64</span>
<span id="cb41-21"><a href="#cb41-21" aria-hidden="true" tabindex="-1"></a>     <span class="dv">5</span>   Partner_Yes                              <span class="dv">5586</span> non<span class="op">-</span>null   float64</span>
<span id="cb41-22"><a href="#cb41-22" aria-hidden="true" tabindex="-1"></a>     <span class="dv">6</span>   Dependents_No                            <span class="dv">5586</span> non<span class="op">-</span>null   float64</span>
<span id="cb41-23"><a href="#cb41-23" aria-hidden="true" tabindex="-1"></a>     <span class="dv">7</span>   Dependents_Yes                           <span class="dv">5586</span> non<span class="op">-</span>null   float64</span>
<span id="cb41-24"><a href="#cb41-24" aria-hidden="true" tabindex="-1"></a>     <span class="dv">8</span>   MultipleLines_No                         <span class="dv">5586</span> non<span class="op">-</span>null   float64</span>
<span id="cb41-25"><a href="#cb41-25" aria-hidden="true" tabindex="-1"></a>     <span class="dv">9</span>   MultipleLines_No phone service           <span class="dv">5586</span> non<span class="op">-</span>null   float64</span>
<span id="cb41-26"><a href="#cb41-26" aria-hidden="true" tabindex="-1"></a>     <span class="dv">10</span>  MultipleLines_Yes                        <span class="dv">5586</span> non<span class="op">-</span>null   float64</span>
<span id="cb41-27"><a href="#cb41-27" aria-hidden="true" tabindex="-1"></a>     <span class="dv">11</span>  InternetService_DSL                      <span class="dv">5586</span> non<span class="op">-</span>null   float64</span>
<span id="cb41-28"><a href="#cb41-28" aria-hidden="true" tabindex="-1"></a>     <span class="dv">12</span>  InternetService_Fiber optic              <span class="dv">5586</span> non<span class="op">-</span>null   float64</span>
<span id="cb41-29"><a href="#cb41-29" aria-hidden="true" tabindex="-1"></a>     <span class="dv">13</span>  InternetService_No                       <span class="dv">5586</span> non<span class="op">-</span>null   float64</span>
<span id="cb41-30"><a href="#cb41-30" aria-hidden="true" tabindex="-1"></a>     <span class="dv">14</span>  OnlineSecurity_No                        <span class="dv">5586</span> non<span class="op">-</span>null   float64</span>
<span id="cb41-31"><a href="#cb41-31" aria-hidden="true" tabindex="-1"></a>     <span class="dv">15</span>  OnlineSecurity_No internet service       <span class="dv">5586</span> non<span class="op">-</span>null   float64</span>
<span id="cb41-32"><a href="#cb41-32" aria-hidden="true" tabindex="-1"></a>     <span class="dv">16</span>  OnlineSecurity_Yes                       <span class="dv">5586</span> non<span class="op">-</span>null   float64</span>
<span id="cb41-33"><a href="#cb41-33" aria-hidden="true" tabindex="-1"></a>     <span class="dv">17</span>  OnlineBackup_No                          <span class="dv">5586</span> non<span class="op">-</span>null   float64</span>
<span id="cb41-34"><a href="#cb41-34" aria-hidden="true" tabindex="-1"></a>     <span class="dv">18</span>  OnlineBackup_No internet service         <span class="dv">5586</span> non<span class="op">-</span>null   float64</span>
<span id="cb41-35"><a href="#cb41-35" aria-hidden="true" tabindex="-1"></a>     <span class="dv">19</span>  OnlineBackup_Yes                         <span class="dv">5586</span> non<span class="op">-</span>null   float64</span>
<span id="cb41-36"><a href="#cb41-36" aria-hidden="true" tabindex="-1"></a>     <span class="dv">20</span>  DeviceProtection_No                      <span class="dv">5586</span> non<span class="op">-</span>null   float64</span>
<span id="cb41-37"><a href="#cb41-37" aria-hidden="true" tabindex="-1"></a>     <span class="dv">21</span>  DeviceProtection_No internet service     <span class="dv">5586</span> non<span class="op">-</span>null   float64</span>
<span id="cb41-38"><a href="#cb41-38" aria-hidden="true" tabindex="-1"></a>     <span class="dv">22</span>  DeviceProtection_Yes                     <span class="dv">5586</span> non<span class="op">-</span>null   float64</span>
<span id="cb41-39"><a href="#cb41-39" aria-hidden="true" tabindex="-1"></a>     <span class="dv">23</span>  TechSupport_No                           <span class="dv">5586</span> non<span class="op">-</span>null   float64</span>
<span id="cb41-40"><a href="#cb41-40" aria-hidden="true" tabindex="-1"></a>     <span class="dv">24</span>  TechSupport_No internet service          <span class="dv">5586</span> non<span class="op">-</span>null   float64</span>
<span id="cb41-41"><a href="#cb41-41" aria-hidden="true" tabindex="-1"></a>     <span class="dv">25</span>  TechSupport_Yes                          <span class="dv">5586</span> non<span class="op">-</span>null   float64</span>
<span id="cb41-42"><a href="#cb41-42" aria-hidden="true" tabindex="-1"></a>     <span class="dv">26</span>  Contract_Month<span class="op">-</span>to<span class="op">-</span>month                  <span class="dv">5586</span> non<span class="op">-</span>null   float64</span>
<span id="cb41-43"><a href="#cb41-43" aria-hidden="true" tabindex="-1"></a>     <span class="dv">27</span>  Contract_One year                        <span class="dv">5586</span> non<span class="op">-</span>null   float64</span>
<span id="cb41-44"><a href="#cb41-44" aria-hidden="true" tabindex="-1"></a>     <span class="dv">28</span>  Contract_Two year                        <span class="dv">5586</span> non<span class="op">-</span>null   float64</span>
<span id="cb41-45"><a href="#cb41-45" aria-hidden="true" tabindex="-1"></a>     <span class="dv">29</span>  PaperlessBilling_No                      <span class="dv">5586</span> non<span class="op">-</span>null   float64</span>
<span id="cb41-46"><a href="#cb41-46" aria-hidden="true" tabindex="-1"></a>     <span class="dv">30</span>  PaperlessBilling_Yes                     <span class="dv">5586</span> non<span class="op">-</span>null   float64</span>
<span id="cb41-47"><a href="#cb41-47" aria-hidden="true" tabindex="-1"></a>     <span class="dv">31</span>  PaymentMethod_Bank transfer (automatic)  <span class="dv">5586</span> non<span class="op">-</span>null   float64</span>
<span id="cb41-48"><a href="#cb41-48" aria-hidden="true" tabindex="-1"></a>     <span class="dv">32</span>  PaymentMethod_Credit card (automatic)    <span class="dv">5586</span> non<span class="op">-</span>null   float64</span>
<span id="cb41-49"><a href="#cb41-49" aria-hidden="true" tabindex="-1"></a>     <span class="dv">33</span>  PaymentMethod_Electronic check           <span class="dv">5586</span> non<span class="op">-</span>null   float64</span>
<span id="cb41-50"><a href="#cb41-50" aria-hidden="true" tabindex="-1"></a>     <span class="dv">34</span>  PaymentMethod_Mailed check               <span class="dv">5586</span> non<span class="op">-</span>null   float64</span>
<span id="cb41-51"><a href="#cb41-51" aria-hidden="true" tabindex="-1"></a>    dtypes: float64(<span class="dv">35</span>)</span>
<span id="cb41-52"><a href="#cb41-52" aria-hidden="true" tabindex="-1"></a>    memory usage: <span class="fl">1.5</span> MB</span></code></pre></div>
<div class="sourceCode" id="cb42"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>datos_train_prep.head(<span class="dv">3</span>)</span></code></pre></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<div style="overflow-x:auto;">
<table border="1" class="dataframe">
<thead>
<tr style="text-align: left;">
<th>
</th>
<th>
tenure
</th>
<th>
MonthlyCharges
</th>
<th>
SeniorCitizen_0
</th>
<th>
SeniorCitizen_1
</th>
<th>
Partner_No
</th>
<th>
Partner_Yes
</th>
<th>
Dependents_No
</th>
<th>
Dependents_Yes
</th>
<th>
MultipleLines_No
</th>
<th>
MultipleLines_No phone service
</th>
<th>
…
</th>
<th>
TechSupport_Yes
</th>
<th>
Contract_Month-to-month
</th>
<th>
Contract_One year
</th>
<th>
Contract_Two year
</th>
<th>
PaperlessBilling_No
</th>
<th>
PaperlessBilling_Yes
</th>
<th>
PaymentMethod_Bank transfer (automatic)
</th>
<th>
PaymentMethod_Credit card (automatic)
</th>
<th>
PaymentMethod_Electronic check
</th>
<th>
PaymentMethod_Mailed check
</th>
</tr>
</thead>
<tbody>
<tr>
<th>
0
</th>
<td>
-0.440119
</td>
<td>
0.827555
</td>
<td>
1.0
</td>
<td>
0.0
</td>
<td>
1.0
</td>
<td>
0.0
</td>
<td>
1.0
</td>
<td>
0.0
</td>
<td>
0.0
</td>
<td>
0.0
</td>
<td>
…
</td>
<td>
1.0
</td>
<td>
1.0
</td>
<td>
0.0
</td>
<td>
0.0
</td>
<td>
0.0
</td>
<td>
1.0
</td>
<td>
0.0
</td>
<td>
0.0
</td>
<td>
1.0
</td>
<td>
0.0
</td>
</tr>
<tr>
<th>
1
</th>
<td>
-1.011807
</td>
<td>
-0.343458
</td>
<td>
1.0
</td>
<td>
0.0
</td>
<td>
1.0
</td>
<td>
0.0
</td>
<td>
1.0
</td>
<td>
0.0
</td>
<td>
1.0
</td>
<td>
0.0
</td>
<td>
…
</td>
<td>
0.0
</td>
<td>
1.0
</td>
<td>
0.0
</td>
<td>
0.0
</td>
<td>
0.0
</td>
<td>
1.0
</td>
<td>
0.0
</td>
<td>
1.0
</td>
<td>
0.0
</td>
<td>
0.0
</td>
</tr>
<tr>
<th>
2
</th>
<td>
-0.889303
</td>
<td>
-0.180679
</td>
<td>
1.0
</td>
<td>
0.0
</td>
<td>
0.0
</td>
<td>
1.0
</td>
<td>
0.0
</td>
<td>
1.0
</td>
<td>
1.0
</td>
<td>
0.0
</td>
<td>
…
</td>
<td>
0.0
</td>
<td>
1.0
</td>
<td>
0.0
</td>
<td>
0.0
</td>
<td>
0.0
</td>
<td>
1.0
</td>
<td>
1.0
</td>
<td>
0.0
</td>
<td>
0.0
</td>
<td>
0.0
</td>
</tr>
</tbody>
</table>
<p>
3 rows × 35 columns
</p>
</div>
<p> </p>
</div>
</div>
<div id="modelado" class="section level1">
<h1>7. Modelado</h1>
<p>El siguiente paso tras definir los datos de entrenamiento, es seleccionar el algoritmo que se va a emplear. En este caso vamos a realizar este ejercicio con un modelo de regresión logística.</p>
<p> </p>
<div id="regresión-logística-múltiple" class="section level2">
<h2>7.1. Regresión Logística Múltiple</h2>
<p>La Regresión Logística Múltiple es un método de regresión que permite estimar la probabilidad de una variable cualitativa binaria en función de un conjunto de predictores que pueden ser tanto continuos como categóricos. Una de las principales aplicaciones de la regresión logística es la de clasificación binaria, en el que las observaciones se clasifican en un grupo u otro dependiendo del valor que tomen las variables empleadas como predictoras.</p>
<p>Es importante tener en cuenta que, aunque la regresión logística permite clasificar, se trata de un modelo de regresión que modela el logaritmo de la probabilidad de pertenecer a cada grupo. La asignación final se hace en función de las probabilidades predichas.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Modelado</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>lr <span class="op">=</span> LogisticRegression()</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>lr.fit(X_train_prep, y_train_prep)</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>y_pred <span class="op">=</span> lr.predict(X_test_prep) </span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;Los resultados son: </span><span class="ch">\n</span><span class="st">&#39;</span>)</span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;Train Accuracy: </span><span class="sc">{:.3f}</span><span class="st">&#39;</span>.<span class="bu">format</span>(lr.score(X_train_prep, y_train_prep)))</span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;Test Accuracy: </span><span class="sc">{:.3f}</span><span class="st">&#39;</span>.<span class="bu">format</span>(lr.score(X_test_prep, y_test_prep)))</span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>    Los resultados son: </span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a>    Train Accuracy: <span class="fl">0.808</span></span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a>    Test Accuracy: <span class="fl">0.792</span></span></code></pre></div>
<div class="sourceCode" id="cb44"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Matriz de confusión</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>plot_confusion_matrix(lr,</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>                     X_test_prep,</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>                     y_test_prep,                     </span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>                     values_format <span class="op">=</span> <span class="st">&#39;d&#39;</span>,</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>                     display_labels <span class="op">=</span> [<span class="st">&#39;No se fueron&#39;</span>, <span class="st">&#39;Se fueron&#39;</span>])</span></code></pre></div>
<p> 
<img src="/img/churn_prediction_files/output_111_1.png" />
 </p>
<p>Los resultados del modelo se interpretan de la siguiente manera:</p>
<ul>
<li>908 clientes que hemos predicho que no se iban, efectivamente no se fueron (Verdadero Negativo).</li>
<li>198 clientes que hemos predicho que se iban, efectivamente se han ido (Verdadero Positivo).</li>
<li>120 clientes que hemos predicho que no se iban finalmente se fueron (Falso Positivo).</li>
<li>171 clientes que hemos predicho que se iban finalmente NO se fueron (Falso Negativo).</li>
</ul>
<p> </p>
</div>
<div id="hiperparámetros" class="section level2">
<h2>7.2. Hiperparámetros</h2>
<p>Vamos a intentar mejorar la precisión del modelo a partir del ajuste de sus hiperparámetros.
La forma más común de encontrar los valores óptimos es probando diferentes posibilidades.</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Parámtros del modelo</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>solvers <span class="op">=</span> [<span class="st">&#39;newton-cg&#39;</span>, <span class="st">&#39;lbfgs&#39;</span>, <span class="st">&#39;liblinear&#39;</span>]</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>penalty <span class="op">=</span> [<span class="st">&#39;l2&#39;</span>]</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>c_values <span class="op">=</span> [<span class="dv">100</span>, <span class="dv">10</span>, <span class="fl">1.0</span>, <span class="fl">0.1</span>, <span class="fl">0.01</span>]</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Grid search</span></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>grid <span class="op">=</span> <span class="bu">dict</span>(solver  <span class="op">=</span> solvers,</span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>            penalty <span class="op">=</span> penalty,</span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>            C       <span class="op">=</span> c_values)</span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>cv <span class="op">=</span> RepeatedStratifiedKFold(n_splits     <span class="op">=</span> <span class="dv">10</span>,</span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a>                             n_repeats    <span class="op">=</span> <span class="dv">3</span>,</span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a>                             random_state <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a>grid_search <span class="op">=</span> GridSearchCV(estimator   <span class="op">=</span> lr,</span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a>                           param_grid  <span class="op">=</span> grid,</span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a>                           n_jobs      <span class="op">=</span> <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb45-18"><a href="#cb45-18" aria-hidden="true" tabindex="-1"></a>                           cv          <span class="op">=</span> cv,</span>
<span id="cb45-19"><a href="#cb45-19" aria-hidden="true" tabindex="-1"></a>                           scoring     <span class="op">=</span> <span class="st">&#39;accuracy&#39;</span>,</span>
<span id="cb45-20"><a href="#cb45-20" aria-hidden="true" tabindex="-1"></a>                           error_score <span class="op">=</span> <span class="dv">0</span>)</span>
<span id="cb45-21"><a href="#cb45-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-22"><a href="#cb45-22" aria-hidden="true" tabindex="-1"></a>grid_result <span class="op">=</span> grid_search.fit(X_train_prep,</span>
<span id="cb45-23"><a href="#cb45-23" aria-hidden="true" tabindex="-1"></a>                              y_train_prep)</span>
<span id="cb45-24"><a href="#cb45-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-25"><a href="#cb45-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Resultados</span></span>
<span id="cb45-26"><a href="#cb45-26" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;Los resultados son: </span><span class="ch">\n</span><span class="st">&#39;</span>)</span>
<span id="cb45-27"><a href="#cb45-27" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;Accuracy obtenido: </span><span class="sc">{:.3f}</span><span class="st">&#39;</span>.<span class="bu">format</span>(grid_result.best_score_))</span>
<span id="cb45-28"><a href="#cb45-28" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;Mejores hiperparámetros encontrados: </span><span class="sc">{}</span><span class="st">&#39;</span>.<span class="bu">format</span>(grid_result.best_params_))</span>
<span id="cb45-29"><a href="#cb45-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-30"><a href="#cb45-30" aria-hidden="true" tabindex="-1"></a>    Los resultados son: </span>
<span id="cb45-31"><a href="#cb45-31" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb45-32"><a href="#cb45-32" aria-hidden="true" tabindex="-1"></a>    Accuracy obtenida: <span class="fl">0.807</span></span>
<span id="cb45-33"><a href="#cb45-33" aria-hidden="true" tabindex="-1"></a>    Mejores hiperparámetros encontrados: {<span class="st">&#39;C&#39;</span>: <span class="fl">0.01</span>, <span class="st">&#39;penalty&#39;</span>: <span class="st">&#39;l2&#39;</span>, <span class="st">&#39;solver&#39;</span>: <span class="st">&#39;liblinear&#39;</span>}</span>
<span id="cb45-34"><a href="#cb45-34" aria-hidden="true" tabindex="-1"></a>    </span></code></pre></div>
<div class="sourceCode" id="cb46"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>lr <span class="op">=</span> LogisticRegression(C       <span class="op">=</span> <span class="fl">0.01</span>,</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>                        penalty <span class="op">=</span> <span class="st">&#39;l2&#39;</span>,</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>                        solver  <span class="op">=</span> <span class="st">&#39;liblinear&#39;</span>)</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>lr.fit(X_train_prep, y_train_prep)</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>y_pred <span class="op">=</span> lr.predict(X_test_prep) </span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;Los resultados son: </span><span class="ch">\n</span><span class="st">&#39;</span>)</span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;Train Accuracy: </span><span class="sc">{:.3f}</span><span class="st">&#39;</span>.<span class="bu">format</span>(lr.score(X_train_prep, y_train_prep)))</span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;Test Accuracy: </span><span class="sc">{:.3f}</span><span class="st">&#39;</span>.<span class="bu">format</span>(lr.score(X_test_prep, y_test_prep)))</span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a>    Los resultados son: </span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a>    Train Accuracy: <span class="fl">0.806</span></span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a>    Test Accuracy: <span class="fl">0.793</span></span></code></pre></div>
<div class="sourceCode" id="cb47"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Matriz de confusión</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>plot_confusion_matrix(lr,</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>                     X_test_prep,</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>                     y_test_prep,</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>                     values_format <span class="op">=</span> <span class="st">&#39;d&#39;</span>,</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>                     display_labels <span class="op">=</span> [<span class="st">&#39;No se fueron&#39;</span>, <span class="st">&#39;Se fueron&#39;</span>])</span></code></pre></div>
<p> 
<img src="/img/churn_prediction_files/output_117_1.png" />
 </p>
<p>El modelo tuneado ha apenas logrado mejorar su capacidad predictora pasando de un accuracy de 0.792 a 0.793.</p>
</div>
<div id="variables-más-influyentes" class="section level2">
<h2>7.3. Variables más Influyentes</h2>
<div class="sourceCode" id="cb48"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>weights <span class="op">=</span> pd.Series(lr.coef_[<span class="dv">0</span>], index <span class="op">=</span> datos_train_prep.columns.values)</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>weights.sort_values(ascending <span class="op">=</span> <span class="va">False</span>)</span></code></pre></div>
<p> </p>
<table>
<thead>
<tr class="header">
<th>Variable</th>
<th align="center">Coef.</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>MonthlyCharges</td>
<td align="center">0.361533</td>
</tr>
<tr class="even">
<td>Contract_Month-to-month</td>
<td align="center">0.302785</td>
</tr>
<tr class="odd">
<td>PaymentMethod_Electronic check</td>
<td align="center">0.166827</td>
</tr>
<tr class="even">
<td>InternetService_Fiber optic</td>
<td align="center">0.159739</td>
</tr>
<tr class="odd">
<td>OnlineSecurity_No</td>
<td align="center">0.144816</td>
</tr>
<tr class="even">
<td>MultipleLines_No phone service</td>
<td align="center">0.108258</td>
</tr>
<tr class="odd">
<td>TechSupport_No</td>
<td align="center">0.106084</td>
</tr>
<tr class="even">
<td>OnlineBackup_No</td>
<td align="center">0.027953</td>
</tr>
<tr class="odd">
<td>SeniorCitizen_1</td>
<td align="center">0.008567</td>
</tr>
<tr class="even">
<td>PaperlessBilling_Yes</td>
<td align="center">-0.004416</td>
</tr>
<tr class="odd">
<td>DeviceProtection_No</td>
<td align="center">-0.017646</td>
</tr>
<tr class="even">
<td>PaymentMethod_Mailed check</td>
<td align="center">-0.086178</td>
</tr>
<tr class="odd">
<td>Dependents_No</td>
<td align="center">-0.093623</td>
</tr>
<tr class="even">
<td>MultipleLines_Yes</td>
<td align="center">-0.106192</td>
</tr>
<tr class="odd">
<td>DeviceProtection_Yes</td>
<td align="center">-0.109238</td>
</tr>
<tr class="even">
<td>Partner_No</td>
<td align="center">-0.115621</td>
</tr>
<tr class="odd">
<td>OnlineBackup_Yes</td>
<td align="center">-0.154837</td>
</tr>
<tr class="even">
<td>OnlineSecurity_No internet service</td>
<td align="center">-0.161387</td>
</tr>
<tr class="odd">
<td>DeviceProtection_No internet service</td>
<td align="center">-0.161387</td>
</tr>
<tr class="even">
<td>InternetService_No</td>
<td align="center">-0.161387</td>
</tr>
<tr class="odd">
<td>OnlineBackup_No internet service</td>
<td align="center">-0.161387</td>
</tr>
<tr class="even">
<td>TechSupport_No internet service</td>
<td align="center">-0.161387</td>
</tr>
<tr class="odd">
<td>PaymentMethod_Bank transfer (automatic)</td>
<td align="center">-0.169800</td>
</tr>
<tr class="even">
<td>Partner_Yes</td>
<td align="center">-0.172651</td>
</tr>
<tr class="odd">
<td>Contract_One year</td>
<td align="center">-0.192226</td>
</tr>
<tr class="even">
<td>Dependents_Yes</td>
<td align="center">-0.194649</td>
</tr>
<tr class="odd">
<td>PaymentMethod_Credit card (automatic)</td>
<td align="center">-0.199120</td>
</tr>
<tr class="even">
<td>TechSupport_Yes</td>
<td align="center">-0.232968</td>
</tr>
<tr class="odd">
<td>OnlineSecurity_Yes</td>
<td align="center">-0.271700</td>
</tr>
<tr class="even">
<td>PaperlessBilling_No</td>
<td align="center">-0.283855</td>
</tr>
<tr class="odd">
<td>InternetService_DSL</td>
<td align="center">-0.286623</td>
</tr>
<tr class="even">
<td>MultipleLines_No</td>
<td align="center">-0.290337</td>
</tr>
<tr class="odd">
<td>SeniorCitizen_0</td>
<td align="center">-0.296838</td>
</tr>
<tr class="even">
<td>Contract_Two year</td>
<td align="center">-0.398831</td>
</tr>
<tr class="odd">
<td>tenure</td>
<td align="center">-0.688769</td>
</tr>
</tbody>
</table>
<p> </p>
<p>Podemos observar que algunas variables tienen una relación positiva y otras negativa con respecto a nuestra variable objetivo. Los clientes que tiene valores negativos son los menos probables a abandonar la empresa mientras que los clientes con valores positivos son los que más probable lo harán.</p>
<p> </p>
</div>
<div id="alternativas-de-decisión" class="section level2">
<h2>7.4. Alternativas de Decisión</h2>
<p>Por defecto el modelo considera que si la probabilidad de que un cliente se vaya es mayor que el 50% entonces se le asigna que se irá, caso contrario considerará que se queda. Ahora bien, podríamos pensar que una probabilidad del 49% de que un cliente se vaya sigue siendo muy alta como para no tomar ninguna medida ya que el modelo nos dirá que este cliente no se irá con una probabilidad del 51%. Es aquí donde tenemos que decidir qué tan conservadores seremos dependiendo de la estrategia de marketing, costos y objetivos del negocio. La cuestión es que podemos utilizar un umbral de probabilidades para decidir cuando considerar que un cliente abandonará la empresa.</p>
<p>Primero debemos hacer un calibrado de las probabilidades que arroja el modelo esto es para mejorar la confianza de que la clasificación predicha es correcta.</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Creación del modelo calibrado</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>lr_calib <span class="op">=</span> CalibratedClassifierCV(lr,</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>                                  cv     <span class="op">=</span> <span class="dv">3</span>,</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>                                  method <span class="op">=</span> <span class="st">&#39;isotonic&#39;</span>)</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Entrenamiento del modelo calibrado</span></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>lr_calib.fit(X_train_prep, y_train_prep)</span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Predicción con probabilidades calibradas</span></span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>y_pred  <span class="op">=</span> lr_calib.predict_proba(X_test_prep)</span></code></pre></div>
<p>Ahora imaginemos que establecemos lanzar una campaña de marketing a todos los clientes que tienen una probabilidad mayor del 40% de irse. Vamos a obtener así la lista de clientes a los que debemos llamar para retener.</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Umbral del 40%</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>y_pred_40 <span class="op">=</span> lr_calib.predict_proba(X_test_prep)[:, <span class="dv">1</span>] <span class="op">&gt;=</span> <span class="fl">.4</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>X_test[<span class="st">&#39;Target&#39;</span>] <span class="op">=</span> y_pred_40</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>X_test.head()</span></code></pre></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<div style="overflow-x:auto;">
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th>
</th>
<th>
SeniorCitizen
</th>
<th>
Partner
</th>
<th>
Dependents
</th>
<th>
tenure
</th>
<th>
MultipleLines
</th>
<th>
InternetService
</th>
<th>
OnlineSecurity
</th>
<th>
OnlineBackup
</th>
<th>
DeviceProtection
</th>
<th>
TechSupport
</th>
<th>
Contract
</th>
<th>
PaperlessBilling
</th>
<th>
PaymentMethod
</th>
<th>
MonthlyCharges
</th>
<th>
Target
</th>
</tr>
</thead>
<tbody>
<tr>
<th>
3035
</th>
<td>
1
</td>
<td>
Yes
</td>
<td>
No
</td>
<td>
25
</td>
<td>
No
</td>
<td>
Fiber optic
</td>
<td>
No
</td>
<td>
No
</td>
<td>
No
</td>
<td>
No
</td>
<td>
Month-to-month
</td>
<td>
Yes
</td>
<td>
Electronic check
</td>
<td>
69.30
</td>
<td>
True
</td>
</tr>
<tr>
<th>
5869
</th>
<td>
0
</td>
<td>
Yes
</td>
<td>
Yes
</td>
<td>
44
</td>
<td>
Yes
</td>
<td>
Fiber optic
</td>
<td>
No
</td>
<td>
Yes
</td>
<td>
Yes
</td>
<td>
No
</td>
<td>
One year
</td>
<td>
No
</td>
<td>
Electronic check
</td>
<td>
94.40
</td>
<td>
False
</td>
</tr>
<tr>
<th>
6586
</th>
<td>
0
</td>
<td>
Yes
</td>
<td>
Yes
</td>
<td>
45
</td>
<td>
Yes
</td>
<td>
No
</td>
<td>
No internet service
</td>
<td>
No internet service
</td>
<td>
No internet service
</td>
<td>
No internet service
</td>
<td>
Two year
</td>
<td>
Yes
</td>
<td>
Credit card (automatic)
</td>
<td>
24.65
</td>
<td>
False
</td>
</tr>
<tr>
<th>
1125
</th>
<td>
1
</td>
<td>
Yes
</td>
<td>
No
</td>
<td>
39
</td>
<td>
Yes
</td>
<td>
Fiber optic
</td>
<td>
No
</td>
<td>
Yes
</td>
<td>
Yes
</td>
<td>
No
</td>
<td>
Month-to-month
</td>
<td>
Yes
</td>
<td>
Electronic check
</td>
<td>
105.65
</td>
<td>
True
</td>
</tr>
<tr>
<th>
2988
</th>
<td>
0
</td>
<td>
Yes
</td>
<td>
No
</td>
<td>
72
</td>
<td>
Yes
</td>
<td>
Fiber optic
</td>
<td>
Yes
</td>
<td>
Yes
</td>
<td>
Yes
</td>
<td>
No
</td>
<td>
Two year
</td>
<td>
Yes
</td>
<td>
Electronic check
</td>
<td>
109.65
</td>
<td>
False
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="conclusiones" class="section level1">
<h1>8. Conclusiones</h1>
<p>Hemos desarrollado un modelo de predicción para conocer qué clientes abandonarán la empresa a partir de todos los datos que teníamos hasta el mes pasado. Ahora bien, es momento de poner en funcionamiento la maquinaria de marketing. Nos pasan una lista de nuevos clientes y nos piden que les digamos a quién llamar para ofrecerle mejores servicios ya que si no lo hacemos con anticipación éstos se irán. Incorporamos esta nueva lista a nuestro modelo el cual nos dirá qué clientes tienen una probabilidad mayor del 40% de irse y en consecuencia hay que llamarlos. Está claro que dentro de este grupo habrá clientes que en realidad no se van a ir y están conformes y también ocurrirá que hay clientes que se van a ir y nunca llamaremos por lo que hay que considerar una solución de compromiso entre costo y beneficio.</p>
<p>El modelo también nos ayudó a entender cuáles son las variables más relacionadas con la pérdida de clientes. Esto es de vital importancia para conocer en qué áreas estamos fallando. Por ejemplo deberíamos comenzar llamando a los clientes que pagan sus servicios en forma mensual y tratar de que se pasen a un abono anual a cambio de un descuento o también podríamos invertir en mejorar nuestro servicio de fibra óptica ya que el 40% de los clientes que tienen este servicio se han ido el mes pasado.</p>
<p>Pero es una realidad que también hay muchos factores que hacen que el cliente se vaya y que no conocemos. En este caso no hay alarma que suene y que nos avise que esto ocurrirá y es probablemente porque los clientes se pierden y nadie les pregunta porqué o aún peor, se le pregunta el porqué pero no se registra la razón.</p>
<p>El ejemplo que dimos en la introducción y que inspiró este análisis es un caso real en el que el cliente decidió irse porque no le resolvieron el problema ya sea por cuestiones burocráticas, malos entendidos o falta de predisposición de alguien en la cadena de responsabilidad. Lo cierto es que fue el mismo gerente del área que lo llamó un sábado por la mañana para que le explique qué había sucedido y para intentar de convencerlo de que no se vaya y que le anularían el cargo, a esta altura el cliente ya estaba desconforme con la empresa y no hubo vuelta atrás.</p>
<p>Pero todavía estamos a tiempo de sacar algo bueno de esta situación: datos que nos dan información. Porque lo siguiente que tenemos que hacer, como gerente del área, es empezar a registrar cuantos días pasaron desde que un operario debía retirar un equipo. Cada día que pasa sin que el operario lo retire aumenta la probabilidad de que el cliente se vaya y si hubiésemos conocido esta información de antemano el modelo hubiera seleccionado a este cliente para que lo llamen sin importar que lleva 12 años en la compañía o que paga su servicio en forma anual para que le retiren el equipo de inmediato porque es altamente probable de que se vaya. Poder decidir en tiempo real permite realizar acciones para satisfacer las necesidades del cliente al instante y esto es un factor clave que brinda una ventaja competitiva frente al resto de las empresas.</p>
<p> </p>
</div>
<div id="bibliografía" class="section level1">
<h1>9. Bibliografía</h1>
<ul>
<li>Data Wrangling with Python, Jacqueline Kazil &amp; Katharine Jarmul (2016)</li>
<li>www.cienciadedatos.net
</div></li>
</ul>
</div>
